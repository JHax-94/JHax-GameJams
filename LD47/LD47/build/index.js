!function s(n,a,l){function p(e,t){if(!a[e]){if(!n[e]){var i="function"==typeof require&&require;if(!t&&i)return i(e,!0);if(h)return h(e,!0);var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}var o=a[e]={exports:{}};n[e][0].call(o.exports,function(t){return p(n[e][1][t]||t)},o,o.exports,s,n,a,l)}return a[e].exports}for(var h="function"==typeof require&&require,t=0;t<l.length;t++)p(l[t]);return p}({1:[function(t,e,i){"use strict";function r(t){this.id=t,this.volume=1,this.muted=!0,this.loopSound=null,this.loopId=null,this.loopVol=0,this.nextLoop=null}(e.exports=r).prototype.setVolume=function(t,e){var i=this.muted;this.muted=0===t||e||!1,null!=t?this.volume=t:t=this.volume,this.loopId&&(this.loopSound&&this.muted?this.loopSound.stop():this.loopSound&&this.loopSound.id===this.loopId?(this.loopSound.setVolume(Math.max(0,Math.min(1,t*this.loopVol))),i&&this.loopSound.play()):this.muted||this.audioManager.playLoopSound(this.id,this.loopId,this.loopVol))},r.prototype.setMute=function(t){this.setVolume(null,t)},r.prototype.playLoopSound=function(t,i,r,o,s,n){var a=this.audioManager,l=a.settings.defaultFade,e=a.settings.crossFading,p=this.loopSound,h=p&&p.id;if(i=Math.max(0,Math.min(1,i||1)),this.loopId=t,this.loopVol=i,!a.muted&&!this.muted){if(t===h&&p)return p.play(i*this.volume,r,o),void(this.nextLoop&&(this.nextLoop.cancelOnLoadCallbacks(),this.nextLoop=null));if(p=null,!this.nextLoop||this.nextLoop.id!==t){var c=this;e?(this.nextLoop&&this.nextLoop.cancelOnLoadCallbacks(),this.nextLoop=a.createSound(t,this.id),this.nextLoop.load(function(t){if(t)return c.nextLoop.unload(),void(c.nextLoop=null);u(c.loopSound),d()})):(this.nextLoop=a.createSound(t,this.id),u(this.loopSound,d))}}function u(t,e){if(!t)return e&&e();t.stopping||t.stop(function(){return a.freeSound(t),t=null,e&&e()})}function f(){var e=c.loopSound=c.nextLoop;c.nextLoop=null,e&&(e.setLoop(!0,s,n),e.fade=l,e.load(function(t){if(t)return e.unload(),void(c.loopSound=null);e.play(i*c.volume,r,o)}))}function d(){c.loopSound=null,window.setTimeout(f,0)}}},{}],2:[function(t,e,i){"use strict";var r=window.AudioContext||window.webkitAudioContext,o=t("./OrderedList"),s=t("./SoundBuffered.js"),n=t("./SoundGroup.js"),a=t("./AudioChannel.js"),l=t("./ISound.js");function p(t){this.soundsById={},this.soundGroupsById={},this.permanentSounds={},this.freeSoundPool=[],this.soundArchive=new o(function(){return 1}),this.soundGroupArchive=new o(function(){return 1}),this.soundArchiveById={},this.soundGroupArchiveById={},this.usedMemory=0,this.channels={},this.audioContext=null,this.muted=!1,this.settings={audioPath:"",maxSoundGroup:500,maxUsedMemory:300,defaultFade:2,maxPlayLatency:1e3,crossFading:!1,getFileUri:function(t,e){return t+e+".mp3"},getSoundConstructor:function(){return null}};for(var e=0;e<t.length;e++){var i=t[e];this.channels[i]=new a(i)}l.prototype.audioManager=this,n.prototype.audioManager=this,a.prototype.audioManager=this}r||(console.warn("Web Audio API is not supported on this platform. Fallback to regular HTML5 <Audio>"),s=t("./Sound.js"),window.Audio||(console.warn("HTML5 <Audio> is not supported on this platform. Sound features are unavailable."),s=l)),e.exports=p,e.exports.ISound=l,p.prototype.init=function(){if(!this.audioContext&&r)for(var t in this.audioContext=new r,s.prototype.audioContext=this.audioContext,this.soundsById)this.soundsById[t].init()},p.prototype.getEmptySound=function(t,e){var i,r=this.settings.getSoundConstructor(t,e);return r?i=new r:(0<this.freeSoundPool.length?(i=this.freeSoundPool.pop()).init():i=new s,i)},p.prototype.setup=function(t){for(var e in t){var i=t[e];this.setVolume(e,i.volume,i.muted)}},p.prototype.addChannel=function(t){this.channels[t]||(this.channels[t]=new a(t))},p.prototype.setVolume=function(t,e,i){var r=this.channels[t];r&&r.setVolume(e,i)},p.prototype.setMute=function(t){for(var e in void 0===t&&(t=!this.muted),this.muted=!!t,this.channels){var i=this.channels[e];if(i.loopSound)if(t)i.loopSound.stop();else{var r=i.muted;i.muted=!0,i.setVolume(null,r)}}},p.prototype.loadSound=function(t,e){var i=this.createSound(t);return i.load(e),i},p.prototype.createSound=function(t,e){var i=this.getSound(t);return i||((i=this.soundsById[t]=this.getEmptySound(e,t)).setId(t),i)},p.prototype.createSoundPermanent=function(t,e){var i=this.getSound(t);if(i)return i;var r=this.settings.getSoundConstructor(e,t)||s;return(i=this.permanentSounds[t]=new r).setId(t),i},p.prototype.getSound=function(t){var e=this.permanentSounds[t];return e||((e=this.soundsById[t])?e:(e=this.soundArchiveById[t])?(this.soundArchive.removeByRef(e.poolRef),e.poolRef=null,delete this.soundArchiveById[t],this.soundsById[t]=e):null)},p.prototype.getSoundGroup=function(t){var e=this.soundGroupsById[t];return e||((e=this.soundGroupArchiveById[t])?(this.soundGroupArchive.removeByRef(e.poolRef),e.poolRef=null,delete this.soundGroupArchiveById[t],e.verifySounds(),this.soundGroupsById[t]=e):null)},p.prototype.freeSound=function(t){var e=t.id;this.soundsById[e]&&delete this.soundsById[e],this.soundArchiveById[e]&&(this.soundArchive.removeByRef(t.poolRef),t.poolRef=null,delete this.soundArchiveById[e]),t.unload(),t instanceof s&&this.freeSoundPool.push(t)},p.prototype.playLoopSound=function(t,e,i,r,o,s,n){var a=this.channels[t];if(!a)return console.warn('Channel id "'+t+'" does not exist.');a.playLoopSound(e,i,r,o,s,n)},p.prototype.stopLoopSound=function(t){var e=this,i=this.channels[t];if(!i)return console.warn('Channel id "'+t+'" does not exist.');var r=i.loopSound;i.loopId=null,r&&r.stop(function(){e.freeSound(r),i.loopSound=null})},p.prototype.stopAllLoopSounds=function(){for(var t in this.channels)this.stopLoopSound(t)},p.prototype.release=function(){var t,e,i,r=this.settings.maxSoundGroup,o=this.settings.maxUsedMemory,s={};for(t in this.channels){var n=this.channels[t];n.loopSound&&(s[n.loopSound.id]=!0)}for(t in this.soundGroupsById)(e=this.soundGroupsById[t]).poolRef=this.soundGroupArchive.add(e),this.soundGroupArchiveById[t]=e,delete this.soundGroupsById[t];for(t in this.soundsById)s[t]||((i=this.soundsById[t]).poolRef=this.soundArchive.add(i),this.soundArchiveById[t]=i,delete this.soundsById[t]);for(var a=this.soundGroupArchive.getCount();r<a&&(e=this.soundGroupArchive.popFirst());)e.poolRef=null,delete this.soundGroupArchiveById[e.id],--a;for(;this.usedMemory>o&&(i=this.soundArchive.popFirst());)i.poolRef=null,delete this.soundArchiveById[i.id],this.freeSound(i)},p.prototype.playSound=function(t,e,i,r,o){if(!this.muted){var s=this.channels[t];if(!s.muted){var n=this.getSound(e);i=i||1,(n=n||this.createSound(e,t)).play(s.volume*i,r,o)}}},p.prototype.playSoundGroup=function(t,e,i,r,o){if(!this.muted){var s=this.channels[t];if(s&&!s.muted){var n=this.getSoundGroup(e);if(!n)return console.warn('SoundGroup "'+e+'" does not exist.');i=i||1,n.play(i*s.volume,r,o)}}},p.prototype.createSoundGroup=function(t,e,i){if(!this.getSoundGroup(t)){var r=new n(t,e.id,e.vol,e.pitch,i);this.soundGroupsById[t]=r}},p.prototype.createSoundGroups=function(t,e){var i=void 0!==e&&this.channels[e].muted;for(var r in t)this.createSoundGroup(r,t[r],i)}},{"./AudioChannel.js":1,"./ISound.js":3,"./OrderedList":4,"./Sound.js":5,"./SoundBuffered.js":6,"./SoundGroup.js":7}],3:[function(t,e,i){"use strict";function r(){this.playing=!1,this.stopping=!1,this.fade=0,this.usedMemory=0,this.poolRef=null,this.id=null,this.volume=1,this.pan=0,this.loop=!1,this.pitch=0,this._loaded=!1,this._loading=!1,this._unloading=!1,this._playTriggered=0,this._onLoadQueuedCallback=[]}(e.exports=r).prototype.setId=function(t){this.id=t,this._loaded=!1},r.prototype.load=function(t){return this.id?this._loaded?t&&t(null,this):(t&&this._onLoadQueuedCallback.push(t),this._loading?void 0:(this._loading=!0,this._load())):t&&t("noId")},r.prototype._finalizeLoad=function(t){var e=this.audioManager.settings.maxPlayLatency;this._loaded=!t,this._loading=!1;for(var i=0;i<this._onLoadQueuedCallback.length;i++)this._onLoadQueuedCallback[i](t,this);if(this._onLoadQueuedCallback=[],this._unloading)return this._unloading=!1,void this.unload();this._loaded&&this._playTriggered&&((this.loop||Date.now()-this._playTriggered<e)&&this._play(),this._playTriggered=0)},r.prototype.cancelOnLoadCallbacks=function(){this._onLoadQueuedCallback=[]},r.prototype.play=function(t,e,i){if(null!=t&&this.setVolume(t),null!=e&&this.setPan(e),!this._loaded)return this._playTriggered=Date.now(),void this.load();this.loop&&this.playing?this._updatePlayPitch(i):this._play(i)},r.prototype.init=function(){},r.prototype.setVolume=function(t){this.volume=t},r.prototype.setPan=function(t){this.pan=t},r.prototype.setLoop=function(t){this.loop=t},r.prototype.setPitch=function(t){this.pitch=t},r.prototype._updatePlayPitch=function(t){},r.prototype._play=function(t){this.playing=!0,console.log('ISound play call: "'+this.id+'"')},r.prototype.stop=function(t){return this.playing=!1,t&&t()},r.prototype._load=function(){return console.log("ISound load call: "+this.id),this._finalizeLoad(null)},r.prototype.unload=function(){return this._playTriggered=0,this.setLoop(!1),this.fade=0,this.pitch=0,this.stop(),this._loading?!(this._unloading=!0):(this.audioManager.usedMemory-=this.usedMemory,this.setVolume(1),this.setPan(0),this.id=null,this._loaded=!1,!(this.usedMemory=0))}},{}],4:[function(t,e,i){"use strict";function s(t,e,i,r){this.object=t,this.previous=e,this.next=i,this.container=r}function r(t){this.count=0,this.first=null,this.last=null,this.cmpFunc=t}r.prototype.add=function(t){var e=new s(t,null,null,this);if(this.count+=1,null===this.first)return this.first=e,this.last=e;var i=this.cmpFunc(t,this.first.object);if(i<0)return e.next=this.first,this.first.previous=e,this.first=e;var r,o=this.cmpFunc(t,this.last.object);if(0<=o)return e.previous=this.last,this.last.next=e,this.last=e;if(i+o<0){for(r=this.first.next;0<=this.cmpFunc(t,r.object);)r=r.next;e.next=r,e.previous=r.previous,e.previous.next=e,r.previous=e}else{for(r=this.last.previous;this.cmpFunc(t,r.object)<0;)r=r.previous;e.previous=r,e.next=r.next,e.next.previous=e,r.next=e}return e},r.prototype.removeByRef=function(t){return!(!t||t.container!==this)&&(--this.count,null===t.previous?this.first=t.next:t.previous.next=t.next,null===t.next?this.last=t.previous:t.next.previous=t.previous,t.previous=null,t.next=null,!(t.container=null))},r.prototype.moveToTheBeginning=function(t){return!(!t||t.container!==this)&&(null===t.previous||(t.previous.next=t.next,this.last===t?this.last=t.previous:t.next.previous=t.previous,t.previous=null,t.next=this.first,t.next.previous=t,this.first=t),!0)},r.prototype.moveToTheEnd=function(t){return!(!t||t.container!==this)&&(null===t.next||(t.next.previous=t.previous,this.first===t?this.first=t.next:t.previous.next=t.next,t.next=null,t.previous=this.last,t.previous.next=t,this.last=t),!0)},r.prototype.possess=function(t){return t&&t.container===this},r.prototype.popFirst=function(){var t=this.first;if(!t)return null;--this.count;var e=t.object;return this.first=t.next,null!==this.first&&(this.first.previous=null),t.next=null,t.container=null,e},r.prototype.popLast=function(){var t=this.last;if(!t)return null;--this.count;var e=t.object;return this.last=t.previous,null!==this.last&&(this.last.next=null),t.previous=null,t.container=null,e},r.prototype.getFirst=function(){return this.first&&this.first.object},r.prototype.getLast=function(){return this.last&&this.last.object},r.prototype.clear=function(){for(var t=this.first;t;t=t.next)t.container=null;this.count=0,this.first=null,this.last=null},r.prototype.getCount=function(){return this.count},r.prototype.forEach=function(t,e){for(var i=this.first;i;i=i.next)t(i.object,e)},r.prototype.forEachReverse=function(t,e){for(var i=this.last;i;i=i.previous)t(i.object,e)},r.prototype.reposition=function(t){if(t.container!==this)return this.add(t.object);var e=t.previous,i=t.next,r=t.object;for(null===i?this.last=e:i.previous=e,null===e?this.first=i:e.next=i;null!==e&&this.cmpFunc(r,e.object)<0;)e=(i=e).previous;for(;null!==i&&0<=this.cmpFunc(r,i.object);)i=(e=i).next;return null===(t.next=i)?this.last=t:i.previous=t,null===(t.previous=e)?this.first=t:e.next=t,t},e.exports=r},{}],5:[function(t,e,i){"use strict";var r=t("util").inherits,o=t("./ISound.js"),s={playAudioWhenScreenIsLocked:!1};function n(){o.call(this);var t=new Audio;t.loop=!1,t.type="audio/mpeg",this._audio=t,this.audioContext&&(this.source=this.audioContext.createMediaElementSource(t),this.source.connect(this.audioContext.destination))}r(n,o),(e.exports=n).prototype.setVolume=function(t){this.volume=this._audio.volume=t},n.prototype.setLoop=function(t){this.loop=this._audio.loop=t},n.prototype._load=function(){var e=this;function i(t){e._finalizeLoad(t)}function r(){this.removeEventListener("canplaythrough",r),this.removeEventListener("error",o),e.usedMemory=this.duration,e.audioManager.usedMemory+=this.duration,e._finalizeLoad(null)}function o(t){this.removeEventListener("canplaythrough",r),this.removeEventListener("error",o),i(t)}function s(t){e._loading=!0,e._audio.addEventListener("canplaythrough",r),e._audio.addEventListener("error",o),e._audio.src=t,e._audio.load()}var t=this.audioManager.settings.getFileUri,n=this.audioManager.settings.audioPath;if(2<t.length)t(n,this.id,function(t,e){if(t)return i(t);s(e)});else try{var a=t(n,this.id);if(!a)return i("emptyUri");s(a)}catch(t){i(t)}},n.prototype.unload=function(){o.prototype.unload.call(this)&&(this._audio.volume=1,this._audio.src="",this._audio.load())},n.prototype._play=function(t){this._audio.volume=this.volume,this._audio.pause(),this._audio.currentTime=0,this._audio.play(s),this.playing=!0},n.prototype.stop=function(t){return this._audio.pause(),this._audio.currentTime=0,this._playTriggered=0,this.playing=!1,t&&t()}},{"./ISound.js":3,util:110}],6:[function(t,e,i){"use strict";var r=t("util").inherits,o=t("./ISound.js"),s=1e-6;function n(){o.call(this),this.buffer=null,this.source=null,this.sourceConnector=null,this.gain=null,this.panNode=null,this.rawAudioData=null,this._playPitch=0,this._fadeTimeout=null,this._onStopCallback=null,this._audioNodeReady=!1,this._loopStart=0,this._loopEnd=0,this.init()}r(n,o),(e.exports=n).prototype._createAudioNodes=function(){if(!this._audioNodeReady&&this.audioContext){var t,e=this.audioContext,i=e.createGain();t=e.createStereoPanner?e.createStereoPanner():e.createPanner(),i.connect(t),t.connect(e.destination),i.gain.value=0,this.sourceConnector=i,this.gain=i.gain,this.panNode=t,this._audioNodeReady=!0}},n.prototype._destroyAudioNodes=function(){if(this._audioNodeReady){var t=this.audioContext,e=this.panNode,i=this.sourceConnector;i.disconnect(e),e.disconnect(t.destination),this.source&&(this.source.disconnect(i),this.source.onended=null,this.source=null),this.sourceConnector=null,this.gain=null,this.panNode=null,this.rawAudioData=null,this._audioNodeReady=!1}},n.prototype.init=function(){if(this._createAudioNodes(),this.rawAudioData){var e=this,i=this.audioManager.settings.maxPlayLatency;this.audioContext.decodeAudioData(this.rawAudioData,function(t){e.buffer=t,e.usedMemory=t.duration,e.audioManager.usedMemory+=t.duration,e.rawAudioData=null,e._loaded&&e._playTriggered&&((e.loop||Date.now()-e._playTriggered<i)&&e._play(),e._playTriggered=0)},function(){console.error("decode audio failed for sound ",e.id)})}},n.prototype.setVolume=function(t){if(this.volume=t,this.playing)if(this.fade){t<=0&&(t=s);var e=this.audioContext.currentTime;this.gain.cancelScheduledValues(e),this.gain.setValueAtTime(this.gain.value||s,e),this.gain.linearRampToValueAtTime(t,e+this.fade)}else this.gain.value=t},n.prototype.setPan=function(t){this.pan=t,this.panNode&&(this.panNode.pan?this.panNode.pan.value=t:this.panNode.setPosition(t,0,.2))},n.prototype.setLoop=function(t,e,i){this.loop=!!t,this._loopStart=e||0,this._loopEnd=i||0,this.source&&this.buffer&&(this.source.loop=t,this._setLoopPoints())},n.prototype._setLoopPoints=function(){this.source.loopStart=this._loopStart||0;var t=this._loopEnd;t<0&&(t=this.buffer.duration+t),t<0&&(t=0),this.source.loopEnd=t||this.buffer.duration},n.prototype.setPitch=function(t,e){this.pitch=t,this._setPlaybackRate(e)},n.prototype._updatePlayPitch=function(t){!t&&0!==t||t===this._playPitch||(this._playPitch=t,this._setPlaybackRate(0))},n.prototype._setPlaybackRate=function(t){if(this.source){var e=Math.pow(2,(this._playPitch+this.pitch)/12);if(t){var i=this.audioContext.currentTime;this.source.playbackRate.cancelScheduledValues(i),this.source.playbackRate.setValueAtTime(this.source.playbackRate.value||s,i),this.source.playbackRate.linearRampToValueAtTime(e,i+t)}else this.source.playbackRate.value=e}},n.prototype._load=function(){var i=this;function r(t){i._finalizeLoad(t)}function o(t){i.buffer=t,i.usedMemory=t.duration,i.audioManager.usedMemory+=t.duration,i._finalizeLoad(null)}function s(t){var e=new XMLHttpRequest;e.responseType="arraybuffer",e.onreadystatechange=function(){if(4==~~e.readyState)return 200!=~~e.status&&0!=~~e.status?r("xhrError:"+e.status):void(i.audioContext?i.audioContext.decodeAudioData(e.response,o,r):(i.rawAudioData=e.response,i._finalizeLoad(null)))},e.open("GET",t,!0),e.send()}this._createAudioNodes();var t=this.audioManager.settings.getFileUri,e=this.audioManager.settings.audioPath;if(2<t.length)t(e,this.id,function(t,e){if(t)return r(t);s(e)});else try{var n=t(e,this.id);if(!n)return r("emptyUri");s(n)}catch(t){r(t)}},n.prototype.unload=function(){o.prototype.unload.call(this)&&(this._fadeTimeout&&(this._onStopCallback=null,this._stopAndClear()),this.buffer=null,this.source&&(this.source.onended=null,this.source.stop(0),this.source=null),this._destroyAudioNodes())},n.prototype._play=function(t){if(this.buffer){this.playing=!0;var e=this.audioContext.currentTime;if(this.gain.cancelScheduledValues(e),this.fade?(this.gain.setValueAtTime(this.gain.value||s,e),this.gain.linearRampToValueAtTime(this.volume||s,e+this.fade)):this.gain.value=this.volume,this._fadeTimeout)return this._onStopCallback=null,this.source.onended=null,this.stopping=!1,window.clearTimeout(this._fadeTimeout),void(this._fadeTimeout=null);this.source&&(this.source.disconnect(this.sourceConnector),this.source.onended=null);var i=this.source=this.audioContext.createBufferSource();i.connect(this.sourceConnector);var r=this;i.onended=function(){r.playing=!1,i.onended=null,r.source=null},this._playPitch=t||0,(t||this.pitch)&&this._setPlaybackRate(0),i.loop=this.loop,i.buffer=this.buffer,this._setLoopPoints(),i.start(0)}else this._playTriggered=Date.now()},n.prototype._stopAndClear=function(){this.stopping=!1,this.source.onended=null,this.source.stop(0),this.source=null,this._fadeTimeout&&(window.clearTimeout(this._fadeTimeout),this._fadeTimeout=null),this._onStopCallback&&(this._onStopCallback(),this._onStopCallback=null)},n.prototype.stop=function(t){if(!this.playing&&!this.stopping)return t&&t();if(this._playTriggered=0,this.stopping=!0,this.playing=!1,!this.source)return t&&t();if(this._onStopCallback=t,!this._fadeTimeout){if(this.fade){var e=this,i=this.audioContext.currentTime;return this.gain.cancelScheduledValues(i),this.gain.setValueAtTime(this.gain.value||s,i),this.gain.linearRampToValueAtTime(s,i+this.fade),void(this._fadeTimeout=window.setTimeout(function(){e._fadeTimeout=null,e._stopAndClear()},1e3*this.fade))}this._stopAndClear()}}},{"./ISound.js":3,util:110}],7:[function(t,e,i){"use strict";function r(t,e,i,r,o){this.id=t,this.soundIds=e,this.volumes=i||[],this.pitches=r||[],this.soundIndex=0,this.volIndex=0,this.pitchIndex=0,this.poolRef=null,this._ready=!1,0===this.volumes.length&&this.volumes.push(1),0===this.pitches.length&&this.pitches.push(0),o||this._createSounds()}(e.exports=r).prototype._createSounds=function(){for(var t=this.soundIds,e=0;e<t.length;e++)this.audioManager.loadSound(t[e]);this._ready=!0},r.prototype.play=function(t,e,i){if(0!==this.soundIds.length){this._ready||this._createSounds();var r=this.soundIds[this.soundIndex++],o=this.audioManager.getSound(r);if(!o)return console.warn("[Sound Group: "+this.id+"] sound id "+r+"  cannot be played.");t=t||1,i=i||0,t*=this.volumes[this.volIndex++],i+=this.pitches[this.pitchIndex++],o.play(t,e,i),this.soundIndex>=this.soundIds.length&&(this.soundIndex=0),this.volIndex>=this.volumes.length&&(this.volIndex=0),this.pitchIndex>=this.pitches.length&&(this.pitchIndex=0)}},r.prototype.verifySounds=function(){for(var t=0;t<this.soundIds.length;t++){var e=this.soundIds[t];this.audioManager.createSound(e)}}},{}],8:[function(t,e,i){e.exports={_args:[["p2@0.7.1","C:\\Dev\\JHax-GameJams\\LD47\\LD47"]],_from:"p2@0.7.1",_id:"p2@0.7.1",_inBundle:!1,_integrity:"sha1-JfJHTZvDptMUCh2iamfJ4RislUM=",_location:"/p2",_phantomChildren:{},_requested:{type:"version",registry:!0,raw:"p2@0.7.1",name:"p2",escapedName:"p2",rawSpec:"0.7.1",saveSpec:null,fetchSpec:"0.7.1"},_requiredBy:["/"],_resolved:"https://registry.npmjs.org/p2/-/p2-0.7.1.tgz",_spec:"0.7.1",_where:"C:\\Dev\\JHax-GameJams\\LD47\\LD47",author:{name:"Stefan Hedman",email:"schteppe@gmail.com",url:"http://steffe.se"},bugs:{url:"https://github.com/schteppe/p2.js/issues"},dependencies:{"poly-decomp":"0.1.1"},description:"A JavaScript 2D physics engine.",devDependencies:{grunt:"^0.4.5","grunt-browserify":"~2.0.1","grunt-contrib-concat":"^0.4.0","grunt-contrib-jshint":"^0.11.2","grunt-contrib-nodeunit":"^0.4.1","grunt-contrib-uglify":"~0.4.0","grunt-contrib-watch":"~0.5.0"},engines:{node:"*"},homepage:"https://github.com/schteppe/p2.js#readme",keywords:["p2.js","p2","physics","engine","2d"],licenses:[{type:"MIT"}],main:"./src/p2.js",name:"p2",repository:{type:"git",url:"git+https://github.com/schteppe/p2.js.git"},version:"0.7.1"}},{}],9:[function(t,e,i){"use strict";var f=t("../math/vec2");t("../utils/Utils");function r(t){this.lowerBound=f.create(),t&&t.lowerBound&&f.copy(this.lowerBound,t.lowerBound),this.upperBound=f.create(),t&&t.upperBound&&f.copy(this.upperBound,t.upperBound)}e.exports=r;var d=f.create();r.prototype.setFromPoints=function(t,e,i,r){var o=this.lowerBound,s=this.upperBound;"number"!=typeof i&&(i=0),0!==i?f.rotate(o,t[0],i):f.copy(o,t[0]),f.copy(s,o);for(var n=Math.cos(i),a=Math.sin(i),l=1;l<t.length;l++){var p=t[l];if(0!==i){var h=p[0],c=p[1];d[0]=n*h-a*c,d[1]=a*h+n*c,p=d}for(var u=0;u<2;u++)p[u]>s[u]&&(s[u]=p[u]),p[u]<o[u]&&(o[u]=p[u])}e&&(f.add(this.lowerBound,this.lowerBound,e),f.add(this.upperBound,this.upperBound,e)),r&&(this.lowerBound[0]-=r,this.lowerBound[1]-=r,this.upperBound[0]+=r,this.upperBound[1]+=r)},r.prototype.copy=function(t){f.copy(this.lowerBound,t.lowerBound),f.copy(this.upperBound,t.upperBound)},r.prototype.extend=function(t){for(var e=2;e--;){var i=t.lowerBound[e];this.lowerBound[e]>i&&(this.lowerBound[e]=i);var r=t.upperBound[e];this.upperBound[e]<r&&(this.upperBound[e]=r)}},r.prototype.overlaps=function(t){var e=this.lowerBound,i=this.upperBound,r=t.lowerBound,o=t.upperBound;return(r[0]<=i[0]&&i[0]<=o[0]||e[0]<=o[0]&&o[0]<=i[0])&&(r[1]<=i[1]&&i[1]<=o[1]||e[1]<=o[1]&&o[1]<=i[1])},r.prototype.containsPoint=function(t){var e=this.lowerBound,i=this.upperBound;return e[0]<=t[0]&&t[0]<=i[0]&&e[1]<=t[1]&&t[1]<=i[1]},r.prototype.overlapsRay=function(t){var e=1/t.direction[0],i=1/t.direction[1],r=(this.lowerBound[0]-t.from[0])*e,o=(this.upperBound[0]-t.from[0])*e,s=(this.lowerBound[1]-t.from[1])*i,n=(this.upperBound[1]-t.from[1])*i,a=Math.max(Math.max(Math.min(r,o),Math.min(s,n))),l=Math.min(Math.min(Math.max(r,o),Math.max(s,n)));return l<0||l<a?-1:a}},{"../math/vec2":32,"../utils/Utils":59}],10:[function(t,e,i){"use strict";var o=t("../math/vec2"),s=t("../objects/Body");function r(t){this.type=t,this.result=[],this.world=null,this.boundingVolumeType=r.AABB}(e.exports=r).AABB=1,r.BOUNDING_CIRCLE=2,r.prototype.setWorld=function(t){this.world=t},r.prototype.getCollisionPairs=function(t){};var n=o.create();r.boundingRadiusCheck=function(t,e){o.sub(n,t.position,e.position);var i=o.squaredLength(n),r=t.boundingRadius+e.boundingRadius;return i<=r*r},r.aabbCheck=function(t,e){return t.getAABB().overlaps(e.getAABB())},r.prototype.boundingVolumeCheck=function(t,e){var i;switch(this.boundingVolumeType){case r.BOUNDING_CIRCLE:i=r.boundingRadiusCheck(t,e);break;case r.AABB:i=r.aabbCheck(t,e);break;default:throw new Error("Bounding volume type not recognized: "+this.boundingVolumeType)}return i},r.canCollide=function(t,e){var i=s.KINEMATIC,r=s.STATIC;return(t.type!==r||e.type!==r)&&(!(t.type===i&&e.type===r||t.type===r&&e.type===i)&&((t.type!==i||e.type!==i)&&((t.sleepState!==s.SLEEPING||e.sleepState!==s.SLEEPING)&&!(t.sleepState===s.SLEEPING&&e.type===r||e.sleepState===s.SLEEPING&&t.type===r))))},r.NAIVE=1,r.SAP=2},{"../math/vec2":32,"../objects/Body":33}],11:[function(t,e,i){"use strict";t("../shapes/Circle"),t("../shapes/Plane"),t("../shapes/Shape"),t("../shapes/Particle");var l=t("../collision/Broadphase");t("../math/vec2");function r(){l.call(this,l.NAIVE)}(((e.exports=r).prototype=new l).constructor=r).prototype.getCollisionPairs=function(t){for(var e=t.bodies,i=this.result,r=i.length=0,o=e.length;r!==o;r++)for(var s=e[r],n=0;n<r;n++){var a=e[n];l.canCollide(s,a)&&this.boundingVolumeCheck(s,a)&&i.push(s,a)}return i},r.prototype.aabbQuery=function(t,e,i){i=i||[];for(var r=t.bodies,o=0;o<r.length;o++){var s=r[o];s.aabbNeedsUpdate&&s.updateAABB(),s.aabb.overlaps(e)&&i.push(s)}return i}},{"../collision/Broadphase":10,"../math/vec2":32,"../shapes/Circle":41,"../shapes/Particle":45,"../shapes/Plane":46,"../shapes/Shape":47}],12:[function(t,e,i){"use strict";var k=t("../math/vec2"),M=k.sub,F=k.add,N=k.dot,r=(t("../utils/Utils"),t("../utils/ContactEquationPool")),o=t("../utils/FrictionEquationPool"),s=t("../utils/TupleDictionary"),n=t("../equations/Equation"),a=(t("../equations/ContactEquation"),t("../equations/FrictionEquation"),t("../shapes/Circle")),l=t("../shapes/Convex"),p=t("../shapes/Shape"),A=(t("../objects/Body"),t("../shapes/Box"));e.exports=J;var D=k.fromValues(0,1),U=k.fromValues(0,0),j=k.fromValues(0,0),G=k.fromValues(0,0),W=k.fromValues(0,0),z=k.fromValues(0,0),I=k.fromValues(0,0),Q=k.fromValues(0,0),Z=k.fromValues(0,0),K=k.fromValues(0,0),X=k.fromValues(0,0),V=k.fromValues(0,0),O=k.fromValues(0,0),Y=k.fromValues(0,0),H=k.fromValues(0,0),L=k.fromValues(0,0),T=k.fromValues(0,0),E=k.fromValues(0,0),C=k.fromValues(0,0),q=[];function J(){this.contactEquations=[],this.frictionEquations=[],this.enableFriction=!0,this.enabledEquations=!0,this.slipForce=10,this.frictionCoefficient=.3,this.surfaceVelocity=0,this.contactEquationPool=new r({size:32}),this.frictionEquationPool=new o({size:64}),this.restitution=0,this.stiffness=n.DEFAULT_STIFFNESS,this.relaxation=n.DEFAULT_RELAXATION,this.frictionStiffness=n.DEFAULT_STIFFNESS,this.frictionRelaxation=n.DEFAULT_RELAXATION,this.enableFrictionReduction=!0,this.collidingBodiesLastStep=new s,this.contactSkinSize=.01}var h=k.create(),c=k.create();function b(t,e){k.set(t.vertices[0],.5*-e.length,-e.radius),k.set(t.vertices[1],.5*e.length,-e.radius),k.set(t.vertices[2],.5*e.length,e.radius),k.set(t.vertices[3],.5*-e.length,e.radius)}J.prototype.bodiesOverlap=function(t,e){for(var i=h,r=c,o=0,s=t.shapes.length;o!==s;o++){var n=t.shapes[o];t.toWorldFrame(i,n.position);for(var a=0,l=e.shapes.length;a!==l;a++){var p=e.shapes[a];if(e.toWorldFrame(r,p.position),this[n.type|p.type](t,n,i,n.angle+t.angle,e,p,r,p.angle+e.angle,!0))return!0}}return!1},J.prototype.collidedLastStep=function(t,e){var i=0|t.id,r=0|e.id;return!!this.collidingBodiesLastStep.get(i,r)},J.prototype.reset=function(){this.collidingBodiesLastStep.reset();for(var t=this.contactEquations,e=t.length;e--;){var i=t[e],r=i.bodyA.id,o=i.bodyB.id;this.collidingBodiesLastStep.set(r,o,!0)}for(var s=this.contactEquations,n=this.frictionEquations,a=0;a<s.length;a++)this.contactEquationPool.release(s[a]);for(a=0;a<n.length;a++)this.frictionEquationPool.release(n[a]);this.contactEquations.length=this.frictionEquations.length=0},J.prototype.createContactEquation=function(t,e,i,r){var o=this.contactEquationPool.get();return o.bodyA=t,o.bodyB=e,o.shapeA=i,o.shapeB=r,o.restitution=this.restitution,o.firstImpact=!this.collidedLastStep(t,e),o.stiffness=this.stiffness,o.relaxation=this.relaxation,o.needsUpdate=!0,o.enabled=this.enabledEquations,o.offset=this.contactSkinSize,o},J.prototype.createFrictionEquation=function(t,e,i,r){var o=this.frictionEquationPool.get();return o.bodyA=t,o.bodyB=e,o.shapeA=i,o.shapeB=r,o.setSlipForce(this.slipForce),o.frictionCoefficient=this.frictionCoefficient,o.relativeVelocity=this.surfaceVelocity,o.enabled=this.enabledEquations,o.needsUpdate=!0,o.stiffness=this.frictionStiffness,o.relaxation=this.frictionRelaxation,o.contactEquations.length=0,o},J.prototype.createFrictionFromContact=function(t){var e=this.createFrictionEquation(t.bodyA,t.bodyB,t.shapeA,t.shapeB);return k.copy(e.contactPointA,t.contactPointA),k.copy(e.contactPointB,t.contactPointB),k.rotate90cw(e.t,t.normalA),e.contactEquations.push(t),e},J.prototype.createFrictionFromAverage=function(t){var e=this.contactEquations[this.contactEquations.length-1],i=this.createFrictionEquation(e.bodyA,e.bodyB,e.shapeA,e.shapeB),r=e.bodyA;e.bodyB;k.set(i.contactPointA,0,0),k.set(i.contactPointB,0,0),k.set(i.t,0,0);for(var o=0;o!==t;o++)(e=this.contactEquations[this.contactEquations.length-1-o]).bodyA===r?(k.add(i.t,i.t,e.normalA),k.add(i.contactPointA,i.contactPointA,e.contactPointA),k.add(i.contactPointB,i.contactPointB,e.contactPointB)):(k.sub(i.t,i.t,e.normalA),k.add(i.contactPointA,i.contactPointA,e.contactPointB),k.add(i.contactPointB,i.contactPointB,e.contactPointA)),i.contactEquations.push(e);var s=1/t;return k.scale(i.contactPointA,i.contactPointA,s),k.scale(i.contactPointB,i.contactPointB,s),k.normalize(i.t,i.t),k.rotate90cw(i.t,i.t),i},J.prototype[p.LINE|p.CONVEX]=J.prototype.convexLine=function(t,e,i,r,o,s,n,a,l){return!l&&0},J.prototype[p.LINE|p.BOX]=J.prototype.lineBox=function(t,e,i,r,o,s,n,a,l){return!l&&0};var f=new A({width:1,height:1}),d=k.create();J.prototype[p.CAPSULE|p.CONVEX]=J.prototype[p.CAPSULE|p.BOX]=J.prototype.convexCapsule=function(t,e,i,r,o,s,n,a,l){var p=d;k.set(p,s.length/2,0),k.rotate(p,p,a),k.add(p,p,n);var h=this.circleConvex(o,s,p,a,t,e,i,r,l,s.radius);k.set(p,-s.length/2,0),k.rotate(p,p,a),k.add(p,p,n);var c=this.circleConvex(o,s,p,a,t,e,i,r,l,s.radius);if(l&&(h||c))return!0;var u=f;return b(u,s),this.convexConvex(t,e,i,r,o,u,n,a,l)+h+c},J.prototype[p.CAPSULE|p.LINE]=J.prototype.lineCapsule=function(t,e,i,r,o,s,n,a,l){return!l&&0};var S=k.create(),x=k.create(),R=new A({width:1,height:1});J.prototype[p.CAPSULE|p.CAPSULE]=J.prototype.capsuleCapsule=function(t,e,i,r,o,s,n,a,l){for(var p=S,h=x,c=0,u=0;u<2;u++){k.set(p,(0===u?-1:1)*e.length/2,0),k.rotate(p,p,r),k.add(p,p,i);for(var f=0;f<2;f++){k.set(h,(0===f?-1:1)*s.length/2,0),k.rotate(h,h,a),k.add(h,h,n),this.enableFrictionReduction&&(v=this.enableFriction,this.enableFriction=!1);var d=this.circleCircle(t,e,p,r,o,s,h,a,l,e.radius,s.radius);if(this.enableFrictionReduction&&(this.enableFriction=v),l&&d)return!0;c+=d}}this.enableFrictionReduction&&(v=this.enableFriction,this.enableFriction=!1);var y=R;b(y,e);var g=this.convexCapsule(t,y,i,r,o,s,n,a,l);if(this.enableFrictionReduction&&(this.enableFriction=v),l&&g)return!0;if(c+=g,this.enableFrictionReduction){var v=this.enableFriction;this.enableFriction=!1}b(y,s);var m=this.convexCapsule(o,y,n,a,t,e,i,r,l);return this.enableFrictionReduction&&(this.enableFriction=v),!(!l||!m)||(c+=m,this.enableFrictionReduction&&c&&this.enableFriction&&this.frictionEquations.push(this.createFrictionFromAverage(c)),c)},J.prototype[p.LINE|p.LINE]=J.prototype.lineLine=function(t,e,i,r,o,s,n,a,l){return!l&&0},J.prototype[p.PLANE|p.LINE]=J.prototype.planeLine=function(t,e,i,r,o,s,n,a,l){var p=U,h=j,c=G,u=W,f=z,d=I,y=Q,g=Z,v=K,m=q,b=0;k.set(p,-s.length/2,0),k.set(h,s.length/2,0),k.rotate(c,p,a),k.rotate(u,h,a),F(c,c,n),F(u,u,n),k.copy(p,c),k.copy(h,u),M(f,h,p),k.normalize(d,f),k.rotate90cw(v,d),k.rotate(g,D,r),m[0]=p,m[1]=h;for(var S=0;S<m.length;S++){var x=m[S];M(y,x,i);var R=N(y,g);if(R<0){if(l)return!0;var A=this.createContactEquation(t,o,e,s);b++,k.copy(A.normalA,g),k.normalize(A.normalA,A.normalA),k.scale(y,g,R),M(A.contactPointA,x,y),M(A.contactPointA,A.contactPointA,t.position),M(A.contactPointB,x,n),F(A.contactPointB,A.contactPointB,n),M(A.contactPointB,A.contactPointB,o.position),this.contactEquations.push(A),this.enableFrictionReduction||this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(A))}}return!l&&(this.enableFrictionReduction||b&&this.enableFriction&&this.frictionEquations.push(this.createFrictionFromAverage(b)),b)},J.prototype[p.PARTICLE|p.CAPSULE]=J.prototype.particleCapsule=function(t,e,i,r,o,s,n,a,l){return this.circleLine(t,e,i,r,o,s,n,a,l,s.radius,0)},J.prototype[p.CIRCLE|p.LINE]=J.prototype.circleLine=function(t,e,i,r,o,s,n,a,l,p,h){p=p||0,h=void 0!==h?h:e.radius;var c=U,u=j,f=G,d=W,y=z,g=I,v=Q,m=Z,b=K,S=X,x=V,R=O,A=Y,D=H,B=q;k.set(m,-s.length/2,0),k.set(b,s.length/2,0),k.rotate(S,m,a),k.rotate(x,b,a),F(S,S,n),F(x,x,n),k.copy(m,S),k.copy(b,x),M(g,b,m),k.normalize(v,g),k.rotate90cw(y,v),M(R,i,m);var $=N(R,y);M(d,m,n),M(A,i,n);var w=h+p;if(Math.abs($)<w){k.scale(c,y,$),M(f,i,c),k.scale(u,y,N(y,A)),k.normalize(u,u),k.scale(u,u,p),F(f,f,u);var E=N(v,f),C=N(v,m),L=N(v,b);if(C<E&&E<L){if(l)return!0;var T=this.createContactEquation(t,o,e,s);return k.scale(T.normalA,c,-1),k.normalize(T.normalA,T.normalA),k.scale(T.contactPointA,T.normalA,h),F(T.contactPointA,T.contactPointA,i),M(T.contactPointA,T.contactPointA,t.position),M(T.contactPointB,f,n),F(T.contactPointB,T.contactPointB,n),M(T.contactPointB,T.contactPointB,o.position),this.contactEquations.push(T),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(T)),1}}B[0]=m,B[1]=b;for(var P=0;P<B.length;P++){var _=B[P];if(M(R,_,i),k.squaredLength(R)<Math.pow(w,2)){if(l)return!0;T=this.createContactEquation(t,o,e,s);return k.copy(T.normalA,R),k.normalize(T.normalA,T.normalA),k.scale(T.contactPointA,T.normalA,h),F(T.contactPointA,T.contactPointA,i),M(T.contactPointA,T.contactPointA,t.position),M(T.contactPointB,_,n),k.scale(D,T.normalA,-p),F(T.contactPointB,T.contactPointB,D),F(T.contactPointB,T.contactPointB,n),M(T.contactPointB,T.contactPointB,o.position),this.contactEquations.push(T),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(T)),1}}return 0},J.prototype[p.CIRCLE|p.CAPSULE]=J.prototype.circleCapsule=function(t,e,i,r,o,s,n,a,l){return this.circleLine(t,e,i,r,o,s,n,a,l,s.radius)},J.prototype[p.CIRCLE|p.CONVEX]=J.prototype[p.CIRCLE|p.BOX]=J.prototype.circleConvex=function(t,e,i,r,o,s,n,a,l,p){p="number"==typeof p?p:e.radius;for(var h=U,c=j,u=G,f=W,d=z,y=X,g=V,v=Y,m=H,b=L,S=T,x=!1,R=Number.MAX_VALUE,A=s.vertices,D=0;D!==A.length+1;D++){var B=A[D%A.length],$=A[(D+1)%A.length];if(k.rotate(h,B,a),k.rotate(c,$,a),F(h,h,n),F(c,c,n),M(u,c,h),k.normalize(f,u),k.rotate90cw(d,f),k.scale(m,d,-e.radius),F(m,m,i),P(m,s,n,a)){k.sub(b,h,m);var w=Math.abs(k.dot(b,d));w<R&&(k.copy(S,m),R=w,k.scale(v,d,w),k.add(v,v,m),x=!0)}}if(x){if(l)return!0;var E=this.createContactEquation(t,o,e,s);return k.sub(E.normalA,S,i),k.normalize(E.normalA,E.normalA),k.scale(E.contactPointA,E.normalA,p),F(E.contactPointA,E.contactPointA,i),M(E.contactPointA,E.contactPointA,t.position),M(E.contactPointB,v,n),F(E.contactPointB,E.contactPointB,n),M(E.contactPointB,E.contactPointB,o.position),this.contactEquations.push(E),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(E)),1}if(0<p)for(D=0;D<A.length;D++){var C=A[D];if(k.rotate(g,C,a),F(g,g,n),M(y,g,i),k.squaredLength(y)<Math.pow(p,2)){if(l)return!0;E=this.createContactEquation(t,o,e,s);return k.copy(E.normalA,y),k.normalize(E.normalA,E.normalA),k.scale(E.contactPointA,E.normalA,p),F(E.contactPointA,E.contactPointA,i),M(E.contactPointA,E.contactPointA,t.position),M(E.contactPointB,g,n),F(E.contactPointB,E.contactPointB,n),M(E.contactPointB,E.contactPointB,o.position),this.contactEquations.push(E),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(E)),1}}return 0};var y=k.create(),g=k.create(),v=k.create(),m=k.create();function P(t,e,i,r){for(var o=y,s=g,n=v,a=m,l=t,p=e.vertices,h=null,c=0;c!==p.length+1;c++){var u=p[c%p.length],f=p[(c+1)%p.length];k.rotate(o,u,r),k.rotate(s,f,r),F(o,o,i),F(s,s,i),M(n,o,l),M(a,s,l);var d=k.crossLength(n,a);if(null===h&&(h=d),d*h<=0)return;h=d}return 1}J.prototype[p.PARTICLE|p.CONVEX]=J.prototype[p.PARTICLE|p.BOX]=J.prototype.particleConvex=function(t,e,i,r,o,s,n,a,l){var p=U,h=j,c=G,u=W,f=z,d=I,y=Q,g=X,v=Y,m=E,b=C,S=Number.MAX_VALUE,x=!1,R=s.vertices;if(!P(i,s,n,a))return 0;if(l)return!0;for(var A=0;A!==R.length+1;A++){var D=R[A%R.length],B=R[(A+1)%R.length];k.rotate(p,D,a),k.rotate(h,B,a),F(p,p,n),F(h,h,n),M(c,h,p),k.normalize(u,c),k.rotate90cw(f,u),M(g,i,p);N(g,f);M(d,p,n),M(y,i,n),k.sub(m,p,i);var $=Math.abs(k.dot(m,f));$<S&&(S=$,k.scale(v,f,$),k.add(v,v,i),k.copy(b,f),x=!0)}if(x){var w=this.createContactEquation(t,o,e,s);return k.scale(w.normalA,b,-1),k.normalize(w.normalA,w.normalA),k.set(w.contactPointA,0,0),F(w.contactPointA,w.contactPointA,i),M(w.contactPointA,w.contactPointA,t.position),M(w.contactPointB,v,n),F(w.contactPointB,w.contactPointB,n),M(w.contactPointB,w.contactPointB,o.position),this.contactEquations.push(w),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(w)),1}return 0},J.prototype[p.CIRCLE]=J.prototype.circleCircle=function(t,e,i,r,o,s,n,a,l,p,h){var c=U;p=p||e.radius,h=h||s.radius;M(c,i,n);var u=p+h;if(k.squaredLength(c)>Math.pow(u,2))return 0;if(l)return!0;var f=this.createContactEquation(t,o,e,s);return M(f.normalA,n,i),k.normalize(f.normalA,f.normalA),k.scale(f.contactPointA,f.normalA,p),k.scale(f.contactPointB,f.normalA,-h),F(f.contactPointA,f.contactPointA,i),M(f.contactPointA,f.contactPointA,t.position),F(f.contactPointB,f.contactPointB,n),M(f.contactPointB,f.contactPointB,o.position),this.contactEquations.push(f),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(f)),1},J.prototype[p.PLANE|p.CONVEX]=J.prototype[p.PLANE|p.BOX]=J.prototype.planeConvex=function(t,e,i,r,o,s,n,a,l){var p=U,h=j,c=G,u=0;k.rotate(h,D,r);for(var f=0;f!==s.vertices.length;f++){var d=s.vertices[f];if(k.rotate(p,d,a),F(p,p,n),M(c,p,i),N(c,h)<=0){if(l)return!0;u++;var y=this.createContactEquation(t,o,e,s);M(c,p,i),k.copy(y.normalA,h);var g=N(c,y.normalA);k.scale(c,y.normalA,g),M(y.contactPointB,p,o.position),M(y.contactPointA,p,c),M(y.contactPointA,y.contactPointA,t.position),this.contactEquations.push(y),this.enableFrictionReduction||this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(y))}}return this.enableFrictionReduction&&this.enableFriction&&u&&this.frictionEquations.push(this.createFrictionFromAverage(u)),u},J.prototype[p.PARTICLE|p.PLANE]=J.prototype.particlePlane=function(t,e,i,r,o,s,n,a,l){var p=U,h=j;a=a||0,M(p,i,n),k.rotate(h,D,a);var c=N(p,h);if(0<c)return 0;if(l)return!0;var u=this.createContactEquation(o,t,s,e);return k.copy(u.normalA,h),k.scale(p,u.normalA,c),M(u.contactPointA,i,p),M(u.contactPointA,u.contactPointA,o.position),M(u.contactPointB,i,t.position),this.contactEquations.push(u),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(u)),1},J.prototype[p.CIRCLE|p.PARTICLE]=J.prototype.circleParticle=function(t,e,i,r,o,s,n,a,l){var p=U;if(M(p,n,i),k.squaredLength(p)>Math.pow(e.radius,2))return 0;if(l)return!0;var h=this.createContactEquation(t,o,e,s);return k.copy(h.normalA,p),k.normalize(h.normalA,h.normalA),k.scale(h.contactPointA,h.normalA,e.radius),F(h.contactPointA,h.contactPointA,i),M(h.contactPointA,h.contactPointA,t.position),M(h.contactPointB,n,o.position),this.contactEquations.push(h),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(h)),1};var B=new a({radius:1}),$=k.create(),w=k.create();k.create();J.prototype[p.PLANE|p.CAPSULE]=J.prototype.planeCapsule=function(t,e,i,r,o,s,n,a,l){var p,h=$,c=w,u=B;k.set(h,-s.length/2,0),k.rotate(h,h,a),F(h,h,n),k.set(c,s.length/2,0),k.rotate(c,c,a),F(c,c,n),u.radius=s.radius,this.enableFrictionReduction&&(p=this.enableFriction,this.enableFriction=!1);var f=this.circlePlane(o,u,h,0,t,e,i,r,l),d=this.circlePlane(o,u,c,0,t,e,i,r,l);if(this.enableFrictionReduction&&(this.enableFriction=p),l)return f||d;var y=f+d;return this.enableFrictionReduction&&y&&this.frictionEquations.push(this.createFrictionFromAverage(y)),y},J.prototype[p.CIRCLE|p.PLANE]=J.prototype.circlePlane=function(t,e,i,r,o,s,n,a,l){var p=t,h=e,c=i,u=o,f=n,d=a;d=d||0;var y=U,g=j,v=G;M(y,c,f),k.rotate(g,D,d);var m=N(g,y);if(m>h.radius)return 0;if(l)return!0;var b=this.createContactEquation(u,p,s,e);return k.copy(b.normalA,g),k.scale(b.contactPointB,b.normalA,-h.radius),F(b.contactPointB,b.contactPointB,c),M(b.contactPointB,b.contactPointB,p.position),k.scale(v,b.normalA,m),M(b.contactPointA,y,v),F(b.contactPointA,b.contactPointA,f),M(b.contactPointA,b.contactPointA,u.position),this.contactEquations.push(b),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(b)),1},J.prototype[p.CONVEX]=J.prototype[p.CONVEX|p.BOX]=J.prototype[p.BOX]=J.prototype.convexConvex=function(t,e,i,r,o,s,n,a,l,p){var h=U,c=j,u=G,f=W,d=z,y=Q,g=Z,v=K,m=0;p="number"==typeof p?p:0;if(!J.findSeparatingAxis(e,i,r,s,n,a,h))return 0;M(g,n,i),0<N(h,g)&&k.scale(h,h,-1);var b=J.getClosestEdge(e,r,h,!0),S=J.getClosestEdge(s,a,h);if(-1===b||-1===S)return 0;for(var x=0;x<2;x++){var R,A=b,D=S,B=e,$=s,w=i,E=n,C=r,L=a,T=t,P=o;if(0===x)R=A,A=D,D=R,R=B,B=$,$=R,R=w,w=E,E=R,R=C,C=L,L=R,R=T,T=P,P=R;for(var _=D;_<D+2;_++){var I=$.vertices[(_+$.vertices.length)%$.vertices.length];k.rotate(c,I,L),F(c,c,E);for(var X=0,V=A-1;V<A+2;V++){var O=B.vertices[(V+B.vertices.length)%B.vertices.length],Y=B.vertices[(V+1+B.vertices.length)%B.vertices.length];k.rotate(u,O,C),k.rotate(f,Y,C),F(u,u,w),F(f,f,w),M(d,f,u),k.rotate90cw(v,d),k.normalize(v,v),M(g,c,u);var H=N(v,g);(V===A&&H<=p||V!==A&&H<=0)&&X++}if(3<=X){if(l)return!0;var q=this.createContactEquation(T,P,B,$);m++;O=B.vertices[A%B.vertices.length],Y=B.vertices[(A+1)%B.vertices.length];k.rotate(u,O,C),k.rotate(f,Y,C),F(u,u,w),F(f,f,w),M(d,f,u),k.rotate90cw(q.normalA,d),k.normalize(q.normalA,q.normalA),M(g,c,u);H=N(q.normalA,g);k.scale(y,q.normalA,H),M(q.contactPointA,c,w),M(q.contactPointA,q.contactPointA,y),F(q.contactPointA,q.contactPointA,w),M(q.contactPointA,q.contactPointA,T.position),M(q.contactPointB,c,E),F(q.contactPointB,q.contactPointB,E),M(q.contactPointB,q.contactPointB,P.position),this.contactEquations.push(q),this.enableFrictionReduction||this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(q))}}}return this.enableFrictionReduction&&this.enableFriction&&m&&this.frictionEquations.push(this.createFrictionFromAverage(m)),m};var _=k.fromValues(0,0);J.projectConvexOntoAxis=function(t,e,i,r,o){var s,n,a=null,l=null,p=_;k.rotate(p,r,-i);for(var h=0;h<t.vertices.length;h++)s=t.vertices[h],n=N(s,p),(null===a||a<n)&&(a=n),(null===l||n<l)&&(l=n);if(a<l){var c=l;l=a,a=c}var u=N(e,r);k.set(o,l+u,a+u)};var tt=k.fromValues(0,0),et=k.fromValues(0,0),it=k.fromValues(0,0),rt=k.fromValues(0,0),ot=k.fromValues(0,0),st=k.fromValues(0,0);J.findSeparatingAxis=function(t,e,i,r,o,s,n){var a=null,l=!1,p=!1,h=tt,c=et,u=it,f=rt,d=ot,y=st;if(t instanceof A&&r instanceof A)for(var g=0;2!==g;g++){var v=t,m=i;1===g&&(v=r,m=s);for(var b=0;2!==b;b++){0===b?k.set(f,0,1):1===b&&k.set(f,1,0),0!==m&&k.rotate(f,f,m),J.projectConvexOntoAxis(t,e,i,f,d),J.projectConvexOntoAxis(r,o,s,f,y);var S=d,x=y;d[0]>y[0]&&(x=d,S=y,0),l=(R=x[0]-S[1])<=0,(null===a||a<R)&&(k.copy(n,f),a=R,p=l)}}else for(g=0;2!==g;g++){v=t,m=i;1===g&&(v=r,m=s);for(b=0;b!==v.vertices.length;b++){k.rotate(c,v.vertices[b],m),k.rotate(u,v.vertices[(b+1)%v.vertices.length],m),M(h,u,c),k.rotate90cw(f,h),k.normalize(f,f),J.projectConvexOntoAxis(t,e,i,f,d),J.projectConvexOntoAxis(r,o,s,f,y);var R;S=d,x=y;d[0]>y[0]&&(x=d,S=y,0),l=(R=x[0]-S[1])<=0,(null===a||a<R)&&(k.copy(n,f),a=R,p=l)}}return p};var u=k.fromValues(0,0),nt=k.fromValues(0,0),at=k.fromValues(0,0);J.getClosestEdge=function(t,e,i,r){var o=u,s=nt,n=at;k.rotate(o,i,-e),r&&k.scale(o,o,-1);for(var a=-1,l=t.vertices.length,p=-1,h=0;h!==l;h++){M(s,t.vertices[(h+1)%l],t.vertices[h%l]),k.rotate90cw(n,s),k.normalize(n,n);var c=N(n,o);(-1===a||p<c)&&(a=h%l,p=c)}return a};var lt=k.create(),pt=k.create(),ht=k.create(),ct=k.create(),ut=k.create(),ft=k.create(),dt=k.create();J.prototype[p.CIRCLE|p.HEIGHTFIELD]=J.prototype.circleHeightfield=function(t,e,i,r,o,s,n,a,l,p){var h=s.heights,c=(p=p||e.radius,s.elementWidth),u=pt,f=lt,d=ut,y=dt,g=ft,v=ht,m=ct,b=Math.floor((i[0]-p-n[0])/c),S=Math.ceil((i[0]+p-n[0])/c);b<0&&(b=0),S>=h.length&&(S=h.length-1);for(var x=h[b],R=h[S],A=b;A<S;A++)h[A]<R&&(R=h[A]),h[A]>x&&(x=h[A]);if(i[1]-p>x)return!l&&0;var D=!1;for(A=b;A<S;A++){k.set(v,A*c,h[A]),k.set(m,(A+1)*c,h[A+1]),k.add(v,v,n),k.add(m,m,n),k.sub(g,m,v),k.rotate(g,g,Math.PI/2),k.normalize(g,g),k.scale(f,g,-p),k.add(f,f,i),k.sub(u,f,v);var B=k.dot(u,g);if(f[0]>=v[0]&&f[0]<m[0]&&B<=0){if(l)return!0;D=!0,k.scale(u,g,-B),k.add(d,f,u),k.copy(y,g);var $=this.createContactEquation(o,t,s,e);k.copy($.normalA,y),k.scale($.contactPointB,$.normalA,-p),F($.contactPointB,$.contactPointB,i),M($.contactPointB,$.contactPointB,t.position),k.copy($.contactPointA,d),k.sub($.contactPointA,$.contactPointA,o.position),this.contactEquations.push($),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact($))}}if(D=!1,0<p)for(A=b;A<=S;A++)if(k.set(v,A*c,h[A]),k.add(v,v,n),k.sub(u,i,v),k.squaredLength(u)<Math.pow(p,2)){if(l)return!0;D=!0;$=this.createContactEquation(o,t,s,e);k.copy($.normalA,u),k.normalize($.normalA,$.normalA),k.scale($.contactPointB,$.normalA,-p),F($.contactPointB,$.contactPointB,i),M($.contactPointB,$.contactPointB,t.position),M($.contactPointA,v,n),F($.contactPointA,$.contactPointA,n),M($.contactPointA,$.contactPointA,o.position),this.contactEquations.push($),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact($))}return D?1:0};var yt=k.create(),gt=k.create(),vt=k.create(),mt=new l({vertices:[k.create(),k.create(),k.create(),k.create()]});J.prototype[p.BOX|p.HEIGHTFIELD]=J.prototype[p.CONVEX|p.HEIGHTFIELD]=J.prototype.convexHeightfield=function(t,e,i,r,o,s,n,a,l){var p=s.heights,h=s.elementWidth,c=yt,u=gt,f=vt,d=mt,y=Math.floor((t.aabb.lowerBound[0]-n[0])/h),g=Math.ceil((t.aabb.upperBound[0]-n[0])/h);y<0&&(y=0),g>=p.length&&(g=p.length-1);for(var v=p[y],m=p[g],b=y;b<g;b++)p[b]<m&&(m=p[b]),p[b]>v&&(v=p[b]);if(t.aabb.lowerBound[1]>v)return!l&&0;var S=0;for(b=y;b<g;b++){k.set(c,b*h,p[b]),k.set(u,(b+1)*h,p[b+1]),k.add(c,c,n),k.add(u,u,n);k.set(f,.5*(u[0]+c[0]),.5*(u[1]+c[1]-100)),k.sub(d.vertices[0],u,f),k.sub(d.vertices[1],c,f),k.copy(d.vertices[2],d.vertices[1]),k.copy(d.vertices[3],d.vertices[0]),d.vertices[2][1]-=100,d.vertices[3][1]-=100,S+=this.convexConvex(t,e,i,r,o,d,f,0,l)}return S}},{"../equations/ContactEquation":23,"../equations/Equation":24,"../equations/FrictionEquation":25,"../math/vec2":32,"../objects/Body":33,"../shapes/Box":39,"../shapes/Circle":41,"../shapes/Convex":42,"../shapes/Shape":47,"../utils/ContactEquationPool":50,"../utils/FrictionEquationPool":51,"../utils/TupleDictionary":58,"../utils/Utils":59}],13:[function(t,e,i){"use strict";e.exports=n;var l=t("../math/vec2");t("../collision/RaycastResult"),t("../shapes/Shape"),t("../collision/AABB");function n(t){t=t||{},this.from=t.from?l.fromValues(t.from[0],t.from[1]):l.create(),this.to=t.to?l.fromValues(t.to[0],t.to[1]):l.create(),this.checkCollisionResponse=void 0===t.checkCollisionResponse||t.checkCollisionResponse,this.skipBackfaces=!!t.skipBackfaces,this.collisionMask=void 0!==t.collisionMask?t.collisionMask:-1,this.collisionGroup=void 0!==t.collisionGroup?t.collisionGroup:-1,this.mode=void 0!==t.mode?t.mode:n.ANY,this.callback=t.callback||function(t){},this.direction=l.create(),this.length=1,this.update()}(n.prototype.constructor=n).CLOSEST=1,n.ANY=2,n.ALL=4,n.prototype.update=function(){var t=this.direction;l.sub(t,this.to,this.from),this.length=l.length(t),l.normalize(t,t)},n.prototype.intersectBodies=function(t,e){for(var i=0,r=e.length;!t.shouldStop(this)&&i<r;i++){var o=e[i],s=o.getAABB();(0<=s.overlapsRay(this)||s.containsPoint(this.from))&&this.intersectBody(t,o)}};var p=l.create();n.prototype.intersectBody=function(t,e){var i=this.checkCollisionResponse;if(!i||e.collisionResponse)for(var r=p,o=0,s=e.shapes.length;o<s;o++){var n=e.shapes[o];if((!i||n.collisionResponse)&&(0!=(this.collisionGroup&n.collisionMask)&&0!=(n.collisionGroup&this.collisionMask))){l.rotate(r,n.position,e.angle),l.add(r,r,e.position);var a=n.angle+e.angle;if(this.intersectShape(t,n,a,r,e),t.shouldStop(this))break}}},n.prototype.intersectShape=function(t,e,i,r,o){(function(t,e,i){l.sub(s,i,t);var r=l.dot(s,e);return l.scale(a,e,r),l.add(a,a,t),l.squaredDistance(i,a)})(this.from,this.direction,r)>e.boundingRadius*e.boundingRadius||(this._currentBody=o,(this._currentShape=e).raycast(t,this,r,i),this._currentBody=this._currentShape=null)},n.prototype.getAABB=function(t){var e=this.to,i=this.from;l.set(t.lowerBound,Math.min(e[0],i[0]),Math.min(e[1],i[1])),l.set(t.upperBound,Math.max(e[0],i[0]),Math.max(e[1],i[1]))};l.create();n.prototype.reportIntersection=function(t,e,i,r){this.from,this.to;var o=this._currentShape,s=this._currentBody;if(!(this.skipBackfaces&&0<l.dot(i,this.direction)))switch(this.mode){case n.ALL:t.set(i,o,s,e,r),this.callback(t);break;case n.CLOSEST:(e<t.fraction||!t.hasHit())&&t.set(i,o,s,e,r);break;case n.ANY:t.set(i,o,s,e,r)}};var s=l.create(),a=l.create()},{"../collision/AABB":9,"../collision/RaycastResult":14,"../math/vec2":32,"../shapes/Shape":47}],14:[function(t,e,i){"use strict";var s=t("../math/vec2"),r=t("../collision/Ray");function o(){this.normal=s.create(),this.shape=null,this.body=null,this.faceIndex=-1,this.fraction=-1,this.isStopped=!1}(e.exports=o).prototype.reset=function(){s.set(this.normal,0,0),this.shape=null,this.body=null,this.faceIndex=-1,this.fraction=-1,this.isStopped=!1},o.prototype.getHitDistance=function(t){return s.distance(t.from,t.to)*this.fraction},o.prototype.hasHit=function(){return-1!==this.fraction},o.prototype.getHitPoint=function(t,e){s.lerp(t,e.from,e.to,this.fraction)},o.prototype.stop=function(){this.isStopped=!0},o.prototype.shouldStop=function(t){return this.isStopped||-1!==this.fraction&&t.mode===r.ANY},o.prototype.set=function(t,e,i,r,o){s.copy(this.normal,t),this.shape=e,this.body=i,this.fraction=r,this.faceIndex=o}},{"../collision/Ray":13,"../math/vec2":32}],15:[function(t,e,i){"use strict";var r=t("../utils/Utils"),c=t("../collision/Broadphase");function o(){c.call(this,c.SAP),this.axisList=[],this.axisIndex=0;var i=this;this._addBodyHandler=function(t){i.axisList.push(t.body)},this._removeBodyHandler=function(t){var e=i.axisList.indexOf(t.body);-1!==e&&i.axisList.splice(e,1)}}(((e.exports=o).prototype=new c).constructor=o).prototype.setWorld=function(t){this.axisList.length=0,r.appendArray(this.axisList,t.bodies),t.off("addBody",this._addBodyHandler).off("removeBody",this._removeBodyHandler),t.on("addBody",this._addBodyHandler).on("removeBody",this._removeBodyHandler),this.world=t},o.sortAxisList=function(t,e){e|=0;for(var i=1,r=t.length;i<r;i++){for(var o=t[i],s=i-1;0<=s&&!(t[s].aabb.lowerBound[e]<=o.aabb.lowerBound[e]);s--)t[s+1]=t[s];t[s+1]=o}return t},o.prototype.sortList=function(){var t=this.axisList,e=this.axisIndex;o.sortAxisList(t,e)},o.prototype.getCollisionPairs=function(t){var e=this.axisList,i=this.result,r=this.axisIndex;i.length=0;for(var o=e.length;o--;){var s=e[o];s.aabbNeedsUpdate&&s.updateAABB()}this.sortList();for(var n=0,a=0|e.length;n!==a;n++)for(var l=e[n],p=n+1;p<a;p++){var h=e[p];if(!(h.aabb.lowerBound[r]<=l.aabb.upperBound[r]))break;c.canCollide(l,h)&&this.boundingVolumeCheck(l,h)&&i.push(l,h)}return i},o.prototype.aabbQuery=function(t,e,i){i=i||[],this.sortList();var r=this.axisIndex,o="x";1===r&&(o="y"),2===r&&(o="z");for(var s=this.axisList,n=(e.lowerBound[o],e.upperBound[o],0);n<s.length;n++){var a=s[n];a.aabbNeedsUpdate&&a.updateAABB(),a.aabb.overlaps(e)&&i.push(a)}return i}},{"../collision/Broadphase":10,"../utils/Utils":59}],16:[function(t,e,i){"use strict";e.exports=r;var o=t("../utils/Utils");function r(t,e,i,r){this.type=i,r=o.defaults(r,{collideConnected:!0,wakeUpBodies:!0}),this.equations=[],this.bodyA=t,this.bodyB=e,this.collideConnected=r.collideConnected,r.wakeUpBodies&&(t&&t.wakeUp(),e&&e.wakeUp())}r.prototype.update=function(){throw new Error("method update() not implmemented in this Constraint subclass!")},r.DISTANCE=1,r.GEAR=2,r.LOCK=3,r.PRISMATIC=4,r.REVOLUTE=5,r.prototype.setStiffness=function(t){for(var e=this.equations,i=0;i!==e.length;i++){var r=e[i];r.stiffness=t,r.needsUpdate=!0}},r.prototype.setRelaxation=function(t){for(var e=this.equations,i=0;i!==e.length;i++){var r=e[i];r.relaxation=t,r.needsUpdate=!0}}},{"../utils/Utils":59}],17:[function(t,e,i){"use strict";var f=t("./Constraint"),d=t("../equations/Equation"),y=t("../math/vec2"),g=t("../utils/Utils");function r(t,e,i){i=g.defaults(i,{localAnchorA:[0,0],localAnchorB:[0,0]}),f.call(this,t,e,f.DISTANCE,i),this.localAnchorA=y.fromValues(i.localAnchorA[0],i.localAnchorA[1]),this.localAnchorB=y.fromValues(i.localAnchorB[0],i.localAnchorB[1]);var r,o=this.localAnchorA,s=this.localAnchorB;if(this.distance=0,"number"==typeof i.distance)this.distance=i.distance;else{var n=y.create(),a=y.create(),l=y.create();y.rotate(n,o,t.angle),y.rotate(a,s,e.angle),y.add(l,e.position,a),y.sub(l,l,n),y.sub(l,l,t.position),this.distance=y.length(l)}r=void 0===i.maxForce?Number.MAX_VALUE:i.maxForce;var p=new d(t,e,-r,r);this.equations=[p],this.maxForce=r;l=y.create();var h=y.create(),c=y.create(),u=this;p.computeGq=function(){var t=this.bodyA,e=this.bodyB,i=t.position,r=e.position;return y.rotate(h,o,t.angle),y.rotate(c,s,e.angle),y.add(l,r,c),y.sub(l,l,h),y.sub(l,l,i),y.length(l)-u.distance},this.setMaxForce(r),this.upperLimitEnabled=!1,this.upperLimit=1,this.lowerLimitEnabled=!1,this.lowerLimit=0,this.position=0}((e.exports=r).prototype=new f).constructor=r;var h=y.create(),c=y.create(),u=y.create();r.prototype.update=function(){var t=this.equations[0],e=this.bodyA,i=this.bodyB,r=(this.distance,e.position),o=i.position,s=this.equations[0],n=t.G;y.rotate(c,this.localAnchorA,e.angle),y.rotate(u,this.localAnchorB,i.angle),y.add(h,o,u),y.sub(h,h,c),y.sub(h,h,r),this.position=y.length(h);var a=!1;if(this.upperLimitEnabled&&this.position>this.upperLimit&&(s.maxForce=0,s.minForce=-this.maxForce,this.distance=this.upperLimit,a=!0),this.lowerLimitEnabled&&this.position<this.lowerLimit&&(s.maxForce=this.maxForce,s.minForce=0,this.distance=this.lowerLimit,a=!0),!this.lowerLimitEnabled&&!this.upperLimitEnabled||a){s.enabled=!0,y.normalize(h,h);var l=y.crossLength(c,h),p=y.crossLength(u,h);n[0]=-h[0],n[1]=-h[1],n[2]=-l,n[3]=h[0],n[4]=h[1],n[5]=p}else s.enabled=!1},r.prototype.setMaxForce=function(t){var e=this.equations[0];e.minForce=-t,e.maxForce=t},r.prototype.getMaxForce=function(){return this.equations[0].maxForce}},{"../equations/Equation":24,"../math/vec2":32,"../utils/Utils":59,"./Constraint":16}],18:[function(t,e,i){"use strict";var r=t("./Constraint"),o=(t("../equations/Equation"),t("../equations/AngleLockEquation"));t("../math/vec2");function s(t,e,i){i=i||{},r.call(this,t,e,r.GEAR,i),this.ratio=void 0!==i.ratio?i.ratio:1,this.angle=void 0!==i.angle?i.angle:e.angle-this.ratio*t.angle,i.angle=this.angle,i.ratio=this.ratio,this.equations=[new o(t,e,i)],void 0!==i.maxTorque&&this.setMaxTorque(i.maxTorque)}(((e.exports=s).prototype=new r).constructor=s).prototype.update=function(){var t=this.equations[0];t.ratio!==this.ratio&&t.setRatio(this.ratio),t.angle=this.angle},s.prototype.setMaxTorque=function(t){this.equations[0].setMaxTorque(t)},s.prototype.getMaxTorque=function(t){return this.equations[0].maxForce}},{"../equations/AngleLockEquation":22,"../equations/Equation":24,"../math/vec2":32,"./Constraint":16}],19:[function(t,e,i){"use strict";var u=t("./Constraint"),f=t("../math/vec2"),d=t("../equations/Equation");function r(t,e,i){i=i||{},u.call(this,t,e,u.LOCK,i);var r=void 0===i.maxForce?Number.MAX_VALUE:i.maxForce,o=(i.localAngleB,new d(t,e,-r,r)),s=new d(t,e,-r,r),n=new d(t,e,-r,r),a=f.create(),l=f.create(),p=this;o.computeGq=function(){return f.rotate(a,p.localOffsetB,t.angle),f.sub(l,e.position,t.position),f.sub(l,l,a),l[0]},s.computeGq=function(){return f.rotate(a,p.localOffsetB,t.angle),f.sub(l,e.position,t.position),f.sub(l,l,a),l[1]};var h=f.create(),c=f.create();n.computeGq=function(){return f.rotate(h,p.localOffsetB,e.angle-p.localAngleB),f.scale(h,h,-1),f.sub(l,t.position,e.position),f.add(l,l,h),f.rotate(c,h,-Math.PI/2),f.normalize(c,c),f.dot(l,c)},this.localOffsetB=f.create(),i.localOffsetB?f.copy(this.localOffsetB,i.localOffsetB):(f.sub(this.localOffsetB,e.position,t.position),f.rotate(this.localOffsetB,this.localOffsetB,-t.angle)),this.localAngleB=0,"number"==typeof i.localAngleB?this.localAngleB=i.localAngleB:this.localAngleB=e.angle-t.angle,this.equations.push(o,s,n),this.setMaxForce(r)}(((e.exports=r).prototype=new u).constructor=r).prototype.setMaxForce=function(t){for(var e=this.equations,i=0;i<this.equations.length;i++)e[i].maxForce=t,e[i].minForce=-t},r.prototype.getMaxForce=function(){return this.equations[0].maxForce};var s=f.create(),n=f.create(),a=f.create(),l=f.fromValues(1,0),p=f.fromValues(0,1);r.prototype.update=function(){var t=this.equations[0],e=this.equations[1],i=this.equations[2],r=this.bodyA,o=this.bodyB;f.rotate(s,this.localOffsetB,r.angle),f.rotate(n,this.localOffsetB,o.angle-this.localAngleB),f.scale(n,n,-1),f.rotate(a,n,Math.PI/2),f.normalize(a,a),t.G[0]=-1,t.G[1]=0,t.G[2]=-f.crossLength(s,l),t.G[3]=1,e.G[0]=0,e.G[1]=-1,e.G[2]=-f.crossLength(s,p),e.G[4]=1,i.G[0]=-a[0],i.G[1]=-a[1],i.G[3]=a[0],i.G[4]=a[1],i.G[5]=f.crossLength(n,a)}},{"../equations/Equation":24,"../math/vec2":32,"./Constraint":16}],20:[function(t,e,i){"use strict";var y=t("./Constraint"),g=t("../equations/ContactEquation"),v=t("../equations/Equation"),m=t("../math/vec2"),b=t("../equations/RotationalLockEquation");function r(r,o,t){t=t||{},y.call(this,r,o,y.PRISMATIC,t);var s=m.fromValues(0,0),n=m.fromValues(1,0),a=m.fromValues(0,0);t.localAnchorA&&m.copy(s,t.localAnchorA),t.localAxisA&&m.copy(n,t.localAxisA),t.localAnchorB&&m.copy(a,t.localAnchorB),this.localAnchorA=s,this.localAnchorB=a,this.localAxisA=n;var e=this.maxForce=void 0!==t.maxForce?t.maxForce:Number.MAX_VALUE,i=new v(r,o,-e,e),l=new m.create,p=new m.create,h=new m.create,c=new m.create;if(i.computeGq=function(){return m.dot(h,c)},i.updateJacobian=function(){var t=this.G,e=r.position,i=o.position;m.rotate(l,s,r.angle),m.rotate(p,a,o.angle),m.add(h,i,p),m.sub(h,h,e),m.sub(h,h,l),m.rotate(c,n,r.angle+Math.PI/2),t[0]=-c[0],t[1]=-c[1],t[2]=-m.crossLength(l,c)+m.crossLength(c,h),t[3]=c[0],t[4]=c[1],t[5]=m.crossLength(p,c)},this.equations.push(i),!t.disableRotationalLock){var u=new b(r,o,-e,e);this.equations.push(u)}this.position=0,this.velocity=0,this.lowerLimitEnabled=void 0!==t.lowerLimit,this.upperLimitEnabled=void 0!==t.upperLimit,this.lowerLimit=void 0!==t.lowerLimit?t.lowerLimit:0,this.upperLimit=void 0!==t.upperLimit?t.upperLimit:1,this.upperLimitEquation=new g(r,o),this.lowerLimitEquation=new g(r,o),this.upperLimitEquation.minForce=this.lowerLimitEquation.minForce=0,this.upperLimitEquation.maxForce=this.lowerLimitEquation.maxForce=e,this.motorEquation=new v(r,o),this.motorEnabled=!1,this.motorSpeed=0;var f=this,d=this.motorEquation;d.computeGW;d.computeGq=function(){return 0},d.computeGW=function(){var t=this.G,e=this.bodyA,i=this.bodyB,r=e.velocity,o=i.velocity,s=e.angularVelocity,n=i.angularVelocity;return this.gmult(t,r,s,o,n)+f.motorSpeed}}((e.exports=r).prototype=new y).constructor=r;var d=m.create(),S=m.create(),x=m.create(),R=m.create(),A=m.create(),D=m.create();r.prototype.update=function(){var t=this.equations,e=t[0],i=this.upperLimit,r=this.lowerLimit,o=this.upperLimitEquation,s=this.lowerLimitEquation,n=this.bodyA,a=this.bodyB,l=this.localAxisA,p=this.localAnchorA,h=this.localAnchorB;e.updateJacobian(),m.rotate(d,l,n.angle),m.rotate(R,p,n.angle),m.add(S,R,n.position),m.rotate(A,h,a.angle),m.add(x,A,a.position);var c,u=this.position=m.dot(x,d)-m.dot(S,d);if(this.motorEnabled){var f=this.motorEquation.G;f[0]=d[0],f[1]=d[1],f[2]=m.crossLength(d,A),f[3]=-d[0],f[4]=-d[1],f[5]=-m.crossLength(d,R)}this.upperLimitEnabled&&i<u?(m.scale(o.normalA,d,-1),m.sub(o.contactPointA,S,n.position),m.sub(o.contactPointB,x,a.position),m.scale(D,d,i),m.add(o.contactPointA,o.contactPointA,D),-1===t.indexOf(o)&&t.push(o)):-1!==(c=t.indexOf(o))&&t.splice(c,1);this.lowerLimitEnabled&&u<r?(m.scale(s.normalA,d,1),m.sub(s.contactPointA,S,n.position),m.sub(s.contactPointB,x,a.position),m.scale(D,d,r),m.sub(s.contactPointB,s.contactPointB,D),-1===t.indexOf(s)&&t.push(s)):-1!==(c=t.indexOf(s))&&t.splice(c,1)},r.prototype.enableMotor=function(){this.motorEnabled||(this.equations.push(this.motorEquation),this.motorEnabled=!0)},r.prototype.disableMotor=function(){if(this.motorEnabled){var t=this.equations.indexOf(this.motorEquation);this.equations.splice(t,1),this.motorEnabled=!1}},r.prototype.setLimits=function(t,e){"number"==typeof t?(this.lowerLimit=t,this.lowerLimitEnabled=!0):(this.lowerLimit=t,this.lowerLimitEnabled=!1),"number"==typeof e?(this.upperLimit=e,this.upperLimitEnabled=!0):(this.upperLimit=e,this.upperLimitEnabled=!1)}},{"../equations/ContactEquation":23,"../equations/Equation":24,"../equations/RotationalLockEquation":26,"../math/vec2":32,"./Constraint":16}],21:[function(t,e,i){"use strict";var l=t("./Constraint"),p=t("../equations/Equation"),h=t("../equations/RotationalVelocityEquation"),c=t("../equations/RotationalLockEquation"),f=t("../math/vec2");e.exports=r;var d=f.create(),y=f.create(),g=f.fromValues(1,0),v=f.fromValues(0,1),u=f.create();function r(t,e,i){i=i||{},l.call(this,t,e,l.REVOLUTE,i);var r=this.maxForce=void 0!==i.maxForce?i.maxForce:Number.MAX_VALUE;this.pivotA=f.create(),this.pivotB=f.create(),i.worldPivot?(f.sub(this.pivotA,i.worldPivot,t.position),f.sub(this.pivotB,i.worldPivot,e.position),f.rotate(this.pivotA,this.pivotA,-t.angle),f.rotate(this.pivotB,this.pivotB,-e.angle)):(f.copy(this.pivotA,i.localPivotA),f.copy(this.pivotB,i.localPivotB));var o=this.equations=[new p(t,e,-r,r),new p(t,e,-r,r)],s=o[0],n=o[1],a=this;s.computeGq=function(){return f.rotate(d,a.pivotA,t.angle),f.rotate(y,a.pivotB,e.angle),f.add(u,e.position,y),f.sub(u,u,t.position),f.sub(u,u,d),f.dot(u,g)},n.computeGq=function(){return f.rotate(d,a.pivotA,t.angle),f.rotate(y,a.pivotB,e.angle),f.add(u,e.position,y),f.sub(u,u,t.position),f.sub(u,u,d),f.dot(u,v)},n.minForce=s.minForce=-r,n.maxForce=s.maxForce=r,this.motorEquation=new h(t,e),this.motorEnabled=!1,this.angle=0,this.lowerLimitEnabled=!1,this.upperLimitEnabled=!1,this.lowerLimit=0,this.upperLimit=0,this.upperLimitEquation=new c(t,e),this.lowerLimitEquation=new c(t,e),this.upperLimitEquation.minForce=0,this.lowerLimitEquation.maxForce=0}((r.prototype=new l).constructor=r).prototype.setLimits=function(t,e){"number"==typeof t?(this.lowerLimit=t,this.lowerLimitEnabled=!0):(this.lowerLimit=t,this.lowerLimitEnabled=!1),"number"==typeof e?(this.upperLimit=e,this.upperLimitEnabled=!0):(this.upperLimit=e,this.upperLimitEnabled=!1)},r.prototype.update=function(){var t,e=this.bodyA,i=this.bodyB,r=this.pivotA,o=this.pivotB,s=this.equations,n=(s[0],s[1],s[0]),a=s[1],l=this.upperLimit,p=this.lowerLimit,h=this.upperLimitEquation,c=this.lowerLimitEquation,u=this.angle=i.angle-e.angle;this.upperLimitEnabled&&l<u?(h.angle=l,-1===s.indexOf(h)&&s.push(h)):-1!==(t=s.indexOf(h))&&s.splice(t,1);this.lowerLimitEnabled&&u<p?(c.angle=p,-1===s.indexOf(c)&&s.push(c)):-1!==(t=s.indexOf(c))&&s.splice(t,1);f.rotate(d,r,e.angle),f.rotate(y,o,i.angle),n.G[0]=-1,n.G[1]=0,n.G[2]=-f.crossLength(d,g),n.G[3]=1,n.G[4]=0,n.G[5]=f.crossLength(y,g),a.G[0]=0,a.G[1]=-1,a.G[2]=-f.crossLength(d,v),a.G[3]=0,a.G[4]=1,a.G[5]=f.crossLength(y,v)},r.prototype.enableMotor=function(){this.motorEnabled||(this.equations.push(this.motorEquation),this.motorEnabled=!0)},r.prototype.disableMotor=function(){if(this.motorEnabled){var t=this.equations.indexOf(this.motorEquation);this.equations.splice(t,1),this.motorEnabled=!1}},r.prototype.motorIsEnabled=function(){return!!this.motorEnabled},r.prototype.setMotorSpeed=function(t){if(this.motorEnabled){var e=this.equations.indexOf(this.motorEquation);this.equations[e].relativeVelocity=t}},r.prototype.getMotorSpeed=function(){return!!this.motorEnabled&&this.motorEquation.relativeVelocity}},{"../equations/Equation":24,"../equations/RotationalLockEquation":26,"../equations/RotationalVelocityEquation":27,"../math/vec2":32,"./Constraint":16}],22:[function(t,e,i){"use strict";var r=t("./Equation");t("../math/vec2");function o(t,e,i){i=i||{},r.call(this,t,e,-Number.MAX_VALUE,Number.MAX_VALUE),this.angle=i.angle||0,this.ratio="number"==typeof i.ratio?i.ratio:1,this.setRatio(this.ratio)}(((e.exports=o).prototype=new r).constructor=o).prototype.computeGq=function(){return this.ratio*this.bodyA.angle-this.bodyB.angle+this.angle},o.prototype.setRatio=function(t){var e=this.G;e[2]=t,e[5]=-1,this.ratio=t},o.prototype.setMaxTorque=function(t){this.maxForce=t,this.minForce=-t}},{"../math/vec2":32,"./Equation":24}],23:[function(t,e,i){"use strict";var r=t("./Equation"),g=t("../math/vec2");function o(t,e){r.call(this,t,e,0,Number.MAX_VALUE),this.contactPointA=g.create(),this.penetrationVec=g.create(),this.contactPointB=g.create(),this.normalA=g.create(),this.restitution=0,this.firstImpact=!1,this.shapeA=null,this.shapeB=null}(((e.exports=o).prototype=new r).constructor=o).prototype.computeB=function(t,e,i){var r,o,s=this.bodyA,n=this.bodyB,a=this.contactPointA,l=this.contactPointB,p=s.position,h=n.position,c=this.penetrationVec,u=this.normalA,f=this.G,d=g.crossLength(a,u),y=g.crossLength(l,u);return f[0]=-u[0],f[1]=-u[1],f[2]=-d,f[3]=u[0],f[4]=u[1],f[5]=y,g.add(c,h,l),g.sub(c,c,p),g.sub(c,c,a),r=this.firstImpact&&0!==this.restitution?(o=0,1/e*(1+this.restitution)*this.computeGW()):(o=g.dot(u,c)+this.offset,this.computeGW()),-o*t-r*e-i*this.computeGiMf()};var s=g.create(),n=g.create(),a=g.create();o.prototype.getVelocityAlongNormal=function(){return this.bodyA.getVelocityAtPoint(s,this.contactPointA),this.bodyB.getVelocityAtPoint(n,this.contactPointB),g.subtract(a,s,n),g.dot(this.normalA,a)}},{"../math/vec2":32,"./Equation":24}],24:[function(t,e,i){"use strict";e.exports=n;var c=t("../math/vec2"),s=t("../utils/Utils");t("../objects/Body");function n(t,e,i,r){this.minForce=void 0===i?-Number.MAX_VALUE:i,this.maxForce=void 0===r?Number.MAX_VALUE:r,this.bodyA=t,this.bodyB=e,this.stiffness=n.DEFAULT_STIFFNESS,this.relaxation=n.DEFAULT_RELAXATION,this.G=new s.ARRAY_TYPE(6);for(var o=0;o<6;o++)this.G[o]=0;this.offset=0,this.a=0,this.b=0,this.epsilon=0,this.timeStep=1/60,this.needsUpdate=!0,this.multiplier=0,this.relativeVelocity=0,this.enabled=!0}(n.prototype.constructor=n).DEFAULT_STIFFNESS=1e6,n.DEFAULT_RELAXATION=4,n.prototype.update=function(){var t=this.stiffness,e=this.relaxation,i=this.timeStep;this.a=4/(i*(1+4*e)),this.b=4*e/(1+4*e),this.epsilon=4/(i*i*t*(1+4*e)),this.needsUpdate=!1},n.prototype.gmult=function(t,e,i,r,o){return t[0]*e[0]+t[1]*e[1]+t[2]*i+t[3]*r[0]+t[4]*r[1]+t[5]*o},n.prototype.computeB=function(t,e,i){var r=this.computeGW();return-this.computeGq()*t-r*e-this.computeGiMf()*i};var a=c.create(),l=c.create();n.prototype.computeGq=function(){var t=this.G,e=this.bodyA,i=this.bodyB,r=(e.position,i.position,e.angle),o=i.angle;return this.gmult(t,a,r,l,o)+this.offset},n.prototype.computeGW=function(){var t=this.G,e=this.bodyA,i=this.bodyB,r=e.velocity,o=i.velocity,s=e.angularVelocity,n=i.angularVelocity;return this.gmult(t,r,s,o,n)+this.relativeVelocity},n.prototype.computeGWlambda=function(){var t=this.G,e=this.bodyA,i=this.bodyB,r=e.vlambda,o=i.vlambda,s=e.wlambda,n=i.wlambda;return this.gmult(t,r,s,o,n)};var u=c.create(),f=c.create();n.prototype.computeGiMf=function(){var t=this.bodyA,e=this.bodyB,i=t.force,r=t.angularForce,o=e.force,s=e.angularForce,n=t.invMassSolve,a=e.invMassSolve,l=t.invInertiaSolve,p=e.invInertiaSolve,h=this.G;return c.scale(u,i,n),c.multiply(u,t.massMultiplier,u),c.scale(f,o,a),c.multiply(f,e.massMultiplier,f),this.gmult(h,u,r*l,f,s*p)},n.prototype.computeGiMGt=function(){var t=this.bodyA,e=this.bodyB,i=t.invMassSolve,r=e.invMassSolve,o=t.invInertiaSolve,s=e.invInertiaSolve,n=this.G;return n[0]*n[0]*i*t.massMultiplier[0]+n[1]*n[1]*i*t.massMultiplier[1]+n[2]*n[2]*o+n[3]*n[3]*r*e.massMultiplier[0]+n[4]*n[4]*r*e.massMultiplier[1]+n[5]*n[5]*s};var d=c.create(),y=c.create(),g=c.create();c.create(),c.create(),c.create();n.prototype.addToWlambda=function(t){var e=this.bodyA,i=this.bodyB,r=d,o=y,s=g,n=e.invMassSolve,a=i.invMassSolve,l=e.invInertiaSolve,p=i.invInertiaSolve,h=this.G;o[0]=h[0],o[1]=h[1],s[0]=h[3],s[1]=h[4],c.scale(r,o,n*t),c.multiply(r,r,e.massMultiplier),c.add(e.vlambda,e.vlambda,r),e.wlambda+=l*h[2]*t,c.scale(r,s,a*t),c.multiply(r,r,i.massMultiplier),c.add(i.vlambda,i.vlambda,r),i.wlambda+=p*h[5]*t},n.prototype.computeInvC=function(t){return 1/(this.computeGiMGt()+t)}},{"../math/vec2":32,"../objects/Body":33,"../utils/Utils":59}],25:[function(t,e,i){"use strict";var a=t("../math/vec2"),r=t("./Equation");t("../utils/Utils");function o(t,e,i){r.call(this,t,e,-i,i),this.contactPointA=a.create(),this.contactPointB=a.create(),this.t=a.create(),this.contactEquations=[],this.shapeA=null,this.shapeB=null,this.frictionCoefficient=.3}(((e.exports=o).prototype=new r).constructor=o).prototype.setSlipForce=function(t){this.maxForce=t,this.minForce=-t},o.prototype.getSlipForce=function(){return this.maxForce},o.prototype.computeB=function(t,e,i){this.bodyA,this.bodyB;var r=this.contactPointA,o=this.contactPointB,s=this.t,n=this.G;return n[0]=-s[0],n[1]=-s[1],n[2]=-a.crossLength(r,s),n[3]=s[0],n[4]=s[1],n[5]=a.crossLength(o,s),-this.computeGW()*e-i*this.computeGiMf()}},{"../math/vec2":32,"../utils/Utils":59,"./Equation":24}],26:[function(t,e,i){"use strict";var o=t("./Equation"),r=t("../math/vec2");function s(t,e,i){i=i||{},o.call(this,t,e,-Number.MAX_VALUE,Number.MAX_VALUE),this.angle=i.angle||0;var r=this.G;r[2]=1,r[5]=-1}((e.exports=s).prototype=new o).constructor=s;var n=r.create(),a=r.create(),l=r.fromValues(1,0),p=r.fromValues(0,1);s.prototype.computeGq=function(){return r.rotate(n,l,this.bodyA.angle+this.angle),r.rotate(a,p,this.bodyB.angle),r.dot(n,a)}},{"../math/vec2":32,"./Equation":24}],27:[function(t,e,i){"use strict";var r=t("./Equation");t("../math/vec2");function o(t,e){r.call(this,t,e,-Number.MAX_VALUE,Number.MAX_VALUE),this.relativeVelocity=1,this.ratio=1}(((e.exports=o).prototype=new r).constructor=o).prototype.computeB=function(t,e,i){var r=this.G;r[2]=-1,r[5]=this.ratio;var o=this.computeGiMf();return-this.computeGW()*e-i*o}},{"../math/vec2":32,"./Equation":24}],28:[function(t,e,i){"use strict";function r(){}(e.exports=r).prototype={constructor:r,on:function(t,e,i){e.context=i||this,void 0===this._listeners&&(this._listeners={});var r=this._listeners;return void 0===r[t]&&(r[t]=[]),-1===r[t].indexOf(e)&&r[t].push(e),this},has:function(t,e){if(void 0===this._listeners)return!1;var i=this._listeners;if(e){if(void 0!==i[t]&&-1!==i[t].indexOf(e))return!0}else if(void 0!==i[t])return!0;return!1},off:function(t,e){if(void 0===this._listeners)return this;var i=this._listeners,r=i[t].indexOf(e);return-1!==r&&i[t].splice(r,1),this},emit:function(t){if(void 0===this._listeners)return this;var e=this._listeners[t.type];if(void 0!==e){t.target=this;for(var i=0,r=e.length;i<r;i++){var o=e[i];o.call(o.context,t)}}return this}}},{}],29:[function(t,e,i){"use strict";var r=t("./Material"),o=t("../equations/Equation");function s(t,e,i){if(i=i||{},!(t instanceof r&&e instanceof r))throw new Error("First two arguments must be Material instances.");this.id=s.idCounter++,this.materialA=t,this.materialB=e,this.friction=void 0!==i.friction?Number(i.friction):.3,this.restitution=void 0!==i.restitution?Number(i.restitution):0,this.stiffness=void 0!==i.stiffness?Number(i.stiffness):o.DEFAULT_STIFFNESS,this.relaxation=void 0!==i.relaxation?Number(i.relaxation):o.DEFAULT_RELAXATION,this.frictionStiffness=void 0!==i.frictionStiffness?Number(i.frictionStiffness):o.DEFAULT_STIFFNESS,this.frictionRelaxation=void 0!==i.frictionRelaxation?Number(i.frictionRelaxation):o.DEFAULT_RELAXATION,this.surfaceVelocity=void 0!==i.surfaceVelocity?Number(i.surfaceVelocity):0,this.contactSkinSize=.005}(e.exports=s).idCounter=0},{"../equations/Equation":24,"./Material":30}],30:[function(t,e,i){"use strict";function r(t){this.id=t||r.idCounter++}(e.exports=r).idCounter=0},{}],31:[function(t,e,i){"use strict";var m={GetArea:function(t){if(t.length<6)return 0;for(var e=t.length-2,i=0,r=0;r<e;r+=2)i+=(t[r+2]-t[r])*(t[r+1]+t[r+3]);return.5*-(i+=(t[0]-t[e])*(t[1+e]+t[1]))},Triangulate:function(t){var e=t.length>>1;if(e<3)return[];for(var i=[],r=[],o=0;o<e;o++)r.push(o);o=0;for(var s=e;3<s;){var n=r[(o+0)%s],a=r[(o+1)%s],l=r[(o+2)%s],p=t[2*n],h=t[2*n+1],c=t[2*a],u=t[2*a+1],f=t[2*l],d=t[2*l+1],y=!1;if(m._convex(p,h,c,u,f,d)){y=!0;for(var g=0;g<s;g++){var v=r[g];if(v!=n&&v!=a&&v!=l&&m._PointInTriangle(t[2*v],t[2*v+1],p,h,c,u,f,d)){y=!1;break}}}if(y)i.push(n,a,l),r.splice((o+1)%s,1),s--,o=0;else if(o++>3*s)break}return i.push(r[0],r[1],r[2]),i},_PointInTriangle:function(t,e,i,r,o,s,n,a){var l=n-i,p=a-r,h=o-i,c=s-r,u=t-i,f=e-r,d=l*l+p*p,y=l*h+p*c,g=l*u+p*f,v=h*h+c*c,m=h*u+c*f,b=1/(d*v-y*y),S=(v*g-y*m)*b,x=(d*m-y*g)*b;return 0<=S&&0<=x&&S+x<1},_convex:function(t,e,i,r,o,s){return 0<=(e-r)*(o-i)+(i-t)*(s-r)}};e.exports=m},{}],32:[function(t,e,i){"use strict";var n=e.exports={},r=t("../utils/Utils");n.crossLength=function(t,e){return t[0]*e[1]-t[1]*e[0]},n.crossVZ=function(t,e,i){return n.rotate(t,e,-Math.PI/2),n.scale(t,t,i),t},n.crossZV=function(t,e,i){return n.rotate(t,i,Math.PI/2),n.scale(t,t,e),t},n.rotate=function(t,e,i){if(0!==i){var r=Math.cos(i),o=Math.sin(i),s=e[0],n=e[1];t[0]=r*s-o*n,t[1]=o*s+r*n}else t[0]=e[0],t[1]=e[1]},n.rotate90cw=function(t,e){var i=e[0],r=e[1];t[0]=r,t[1]=-i},n.toLocalFrame=function(t,e,i,r){n.copy(t,e),n.sub(t,t,i),n.rotate(t,t,-r)},n.toGlobalFrame=function(t,e,i,r){n.copy(t,e),n.rotate(t,t,r),n.add(t,t,i)},n.vectorToLocalFrame=function(t,e,i){n.rotate(t,e,-i)},n.vectorToGlobalFrame=function(t,e,i){n.rotate(t,e,i)},n.centroid=function(t,e,i,r){return n.add(t,e,i),n.add(t,t,r),n.scale(t,t,1/3),t},n.create=function(){var t=new r.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},n.clone=function(t){var e=new r.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},n.fromValues=function(t,e){var i=new r.ARRAY_TYPE(2);return i[0]=t,i[1]=e,i},n.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},n.set=function(t,e,i){return t[0]=e,t[1]=i,t},n.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t},n.subtract=function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t},n.sub=n.subtract,n.multiply=function(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t},n.mul=n.multiply,n.divide=function(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t},n.div=n.divide,n.scale=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t},n.distance=function(t,e){var i=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(i*i+r*r)},n.dist=n.distance,n.squaredDistance=function(t,e){var i=e[0]-t[0],r=e[1]-t[1];return i*i+r*r},n.sqrDist=n.squaredDistance,n.length=function(t){var e=t[0],i=t[1];return Math.sqrt(e*e+i*i)},n.len=n.length,n.squaredLength=function(t){var e=t[0],i=t[1];return e*e+i*i},n.sqrLen=n.squaredLength,n.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},n.normalize=function(t,e){var i=e[0],r=e[1],o=i*i+r*r;return 0<o&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o),t},n.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},n.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},n.lerp=function(t,e,i,r){var o=e[0],s=e[1];return t[0]=o+r*(i[0]-o),t[1]=s+r*(i[1]-s),t},n.reflect=function(t,e,i){var r=e[0]*i[0]+e[1]*i[1];t[0]=e[0]-2*i[0]*r,t[1]=e[1]-2*i[1]*r},n.getLineSegmentsIntersection=function(t,e,i,r,o){var s=n.getLineSegmentsIntersectionFraction(e,i,r,o);return!(s<0)&&(t[0]=e[0]+s*(i[0]-e[0]),t[1]=e[1]+s*(i[1]-e[1]),!0)},n.getLineSegmentsIntersectionFraction=function(t,e,i,r){var o,s,n=e[0]-t[0],a=e[1]-t[1],l=r[0]-i[0],p=r[1]-i[1];return o=(-a*(t[0]-i[0])+n*(t[1]-i[1]))/(-l*a+n*p),s=(l*(t[1]-i[1])-p*(t[0]-i[0]))/(-l*a+n*p),0<=o&&o<=1&&0<=s&&s<=1?s:-1}},{"../utils/Utils":59}],33:[function(t,e,i){"use strict";var c=t("../math/vec2"),p=t("poly-decomp"),h=t("../shapes/Convex"),r=t("../collision/RaycastResult"),o=t("../collision/Ray"),s=t("../collision/AABB"),n=t("../events/EventEmitter");function a(t){t=t||{},n.call(this),this.id=t.id||++a._idCounter,this.world=null,this.shapes=[],this.mass=t.mass||0,this.invMass=0,this.inertia=0,this.invInertia=0,this.invMassSolve=0,this.invInertiaSolve=0,this.fixedRotation=!!t.fixedRotation,this.fixedX=!!t.fixedX,this.fixedY=!!t.fixedY,this.massMultiplier=c.create(),this.position=c.fromValues(0,0),t.position&&c.copy(this.position,t.position),this.interpolatedPosition=c.fromValues(0,0),this.interpolatedAngle=0,this.previousPosition=c.fromValues(0,0),this.previousAngle=0,this.velocity=c.fromValues(0,0),t.velocity&&c.copy(this.velocity,t.velocity),this.vlambda=c.fromValues(0,0),this.wlambda=0,this.angle=t.angle||0,this.angularVelocity=t.angularVelocity||0,this.force=c.create(),t.force&&c.copy(this.force,t.force),this.angularForce=t.angularForce||0,this.damping="number"==typeof t.damping?t.damping:.1,this.angularDamping="number"==typeof t.angularDamping?t.angularDamping:.1,this.type=a.STATIC,void 0!==t.type?this.type=t.type:t.mass?this.type=a.DYNAMIC:this.type=a.STATIC,this.boundingRadius=0,this.aabb=new s,this.aabbNeedsUpdate=!0,this.allowSleep=void 0===t.allowSleep||t.allowSleep,this.wantsToSleep=!1,this.sleepState=a.AWAKE,this.sleepSpeedLimit=void 0!==t.sleepSpeedLimit?t.sleepSpeedLimit:.2,this.sleepTimeLimit=void 0!==t.sleepTimeLimit?t.sleepTimeLimit:1,this.gravityScale=void 0!==t.gravityScale?t.gravityScale:1,this.collisionResponse=void 0===t.collisionResponse||t.collisionResponse,this.idleTime=0,this.timeLastSleepy=0,this.ccdSpeedThreshold=void 0!==t.ccdSpeedThreshold?t.ccdSpeedThreshold:-1,this.ccdIterations=void 0!==t.ccdIterations?t.ccdIterations:10,this.concavePath=null,this._wakeUpAfterNarrowphase=!1,this.updateMassProperties()}(((e.exports=a).prototype=new n).constructor=a)._idCounter=0,a.prototype.updateSolveMassProperties=function(){this.sleepState===a.SLEEPING||this.type===a.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve=0):(this.invMassSolve=this.invMass,this.invInertiaSolve=this.invInertia)},a.prototype.setDensity=function(t){var e=this.getArea();this.mass=e*t,this.updateMassProperties()},a.prototype.getArea=function(){for(var t=0,e=0;e<this.shapes.length;e++)t+=this.shapes[e].area;return t},a.prototype.getAABB=function(){return this.aabbNeedsUpdate&&this.updateAABB(),this.aabb};var l=new s,u=c.create();a.prototype.updateAABB=function(){for(var t=this.shapes,e=t.length,i=u,r=this.angle,o=0;o!==e;o++){var s=t[o],n=s.angle+r;c.rotate(i,s.position,r),c.add(i,i,this.position),s.computeAABB(l,i,n),0===o?this.aabb.copy(l):this.aabb.extend(l)}this.aabbNeedsUpdate=!1},a.prototype.updateBoundingRadius=function(){for(var t=this.shapes,e=t.length,i=0,r=0;r!==e;r++){var o=t[r],s=c.length(o.position),n=o.boundingRadius;i<s+n&&(i=s+n)}this.boundingRadius=i},a.prototype.addShape=function(t,e,i){if(t.body)throw new Error("A shape can only be added to one body.");t.body=this,e?c.copy(t.position,e):c.set(t.position,0,0),t.angle=i||0,this.shapes.push(t),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0},a.prototype.removeShape=function(t){var e=this.shapes.indexOf(t);return-1!==e&&(this.shapes.splice(e,1),this.aabbNeedsUpdate=!0,!(t.body=null))},a.prototype.updateMassProperties=function(){if(this.type===a.STATIC||this.type===a.KINEMATIC)this.mass=Number.MAX_VALUE,this.invMass=0,this.inertia=Number.MAX_VALUE,this.invInertia=0;else{var t=this.shapes,e=t.length,i=this.mass/e,r=0;if(this.fixedRotation)this.inertia=Number.MAX_VALUE,this.invInertia=0;else{for(var o=0;o<e;o++){var s=t[o],n=c.squaredLength(s.position);r+=s.computeMomentOfInertia(i)+i*n}this.inertia=r,this.invInertia=0<r?1/r:0}this.invMass=1/this.mass,c.set(this.massMultiplier,this.fixedX?0:1,this.fixedY?0:1)}};c.create();a.prototype.applyForce=function(t,e){if(c.add(this.force,this.force,t),e){var i=c.crossLength(e,t);this.angularForce+=i}};var f=c.create(),d=c.create(),y=c.create();a.prototype.applyForceLocal=function(t,e){e=e||y;var i=f,r=d;this.vectorToWorldFrame(i,t),this.vectorToWorldFrame(r,e),this.applyForce(i,r)};var g=c.create();a.prototype.applyImpulse=function(t,e){if(this.type===a.DYNAMIC){var i=g;if(c.scale(i,t,this.invMass),c.multiply(i,this.massMultiplier,i),c.add(this.velocity,i,this.velocity),e){var r=c.crossLength(e,t);r*=this.invInertia,this.angularVelocity+=r}}};var v=c.create(),m=c.create(),b=c.create();a.prototype.applyImpulseLocal=function(t,e){e=e||b;var i=v,r=m;this.vectorToWorldFrame(i,t),this.vectorToWorldFrame(r,e),this.applyImpulse(i,r)},a.prototype.toLocalFrame=function(t,e){c.toLocalFrame(t,e,this.position,this.angle)},a.prototype.toWorldFrame=function(t,e){c.toGlobalFrame(t,e,this.position,this.angle)},a.prototype.vectorToLocalFrame=function(t,e){c.vectorToLocalFrame(t,e,this.angle)},a.prototype.vectorToWorldFrame=function(t,e){c.vectorToGlobalFrame(t,e,this.angle)},a.prototype.fromPolygon=function(t,e){e=e||{};for(var i=this.shapes.length;0<=i;--i)this.removeShape(this.shapes[i]);var r,o=new p.Polygon;if(o.vertices=t,o.makeCCW(),"number"==typeof e.removeCollinearPoints&&o.removeCollinearPoints(e.removeCollinearPoints),void 0===e.skipSimpleCheck&&!o.isSimple())return!1;this.concavePath=o.vertices.slice(0);for(i=0;i<this.concavePath.length;i++){var s=[0,0];c.copy(s,this.concavePath[i]),this.concavePath[i]=s}r=e.optimalDecomp?o.decomp():o.quickDecomp();var n=c.create();for(i=0;i!==r.length;i++){for(var a=new h({vertices:r[i].vertices}),l=0;l!==a.vertices.length;l++){s=a.vertices[l];c.sub(s,s,a.centerOfMass)}c.scale(n,a.centerOfMass,1),a.updateTriangles(),a.updateCenterOfMass(),a.updateBoundingRadius(),this.addShape(a,n)}return this.adjustCenterOfMass(),this.aabbNeedsUpdate=!0};c.fromValues(0,0);var S=c.fromValues(0,0),x=c.fromValues(0,0),R=c.fromValues(0,0);a.prototype.adjustCenterOfMass=function(){var t=S,e=x,i=R,r=0;c.set(e,0,0);for(var o=0;o!==this.shapes.length;o++){var s=this.shapes[o];c.scale(t,s.position,s.area),c.add(e,e,t),r+=s.area}c.scale(i,e,1/r);for(o=0;o!==this.shapes.length;o++){s=this.shapes[o];c.sub(s.position,s.position,i)}c.add(this.position,this.position,i);for(o=0;this.concavePath&&o<this.concavePath.length;o++)c.sub(this.concavePath[o],this.concavePath[o],i);this.updateMassProperties(),this.updateBoundingRadius()},a.prototype.setZeroForce=function(){c.set(this.force,0,0),this.angularForce=0},a.prototype.resetConstraintVelocity=function(){var t=this.vlambda;c.set(t,0,0),this.wlambda=0},a.prototype.addConstraintVelocity=function(){var t=this.velocity;c.add(t,t,this.vlambda),this.angularVelocity+=this.wlambda},a.prototype.applyDamping=function(t){if(this.type===a.DYNAMIC){var e=this.velocity;c.scale(e,e,Math.pow(1-this.damping,t)),this.angularVelocity*=Math.pow(1-this.angularDamping,t)}},a.prototype.wakeUp=function(){var t=this.sleepState;this.sleepState=a.AWAKE,this.idleTime=0,t!==a.AWAKE&&this.emit(a.wakeUpEvent)},a.prototype.sleep=function(){this.sleepState=a.SLEEPING,this.angularVelocity=0,this.angularForce=0,c.set(this.velocity,0,0),c.set(this.force,0,0),this.emit(a.sleepEvent)},a.prototype.sleepTick=function(t,e,i){if(this.allowSleep&&this.type!==a.SLEEPING){this.wantsToSleep=!1;this.sleepState;var r=c.squaredLength(this.velocity)+Math.pow(this.angularVelocity,2);Math.pow(this.sleepSpeedLimit,2)<=r?(this.idleTime=0,this.sleepState=a.AWAKE):(this.idleTime+=i,this.sleepState=a.SLEEPY),this.idleTime>this.sleepTimeLimit&&(e?this.wantsToSleep=!0:this.sleep())}},a.prototype.overlaps=function(t){return this.world.overlapKeeper.bodiesAreOverlapping(this,t)};var A=c.create(),D=c.create();a.prototype.integrate=function(t){var e=this.invMass,i=this.force,r=this.position,o=this.velocity;c.copy(this.previousPosition,this.position),this.previousAngle=this.angle,this.fixedRotation||(this.angularVelocity+=this.angularForce*this.invInertia*t),c.scale(A,i,t*e),c.multiply(A,this.massMultiplier,A),c.add(o,A,o),this.integrateToTimeOfImpact(t)||(c.scale(D,o,t),c.add(r,r,D),this.fixedRotation||(this.angle+=this.angularVelocity*t)),this.aabbNeedsUpdate=!0};var B=new r,$=new o({mode:o.ALL}),w=c.create(),E=c.create(),C=c.create(),L=c.create();a.prototype.integrateToTimeOfImpact=function(t){if(this.ccdSpeedThreshold<0||c.squaredLength(this.velocity)<Math.pow(this.ccdSpeedThreshold,2))return!1;c.normalize(w,this.velocity),c.scale(E,this.velocity,t),c.add(E,E,this.position),c.sub(C,E,this.position);var e,i=this.angularVelocity*t,r=c.length(C),o=1,s=this;if(B.reset(),$.callback=function(t){t.body!==s&&(e=t.body,t.getHitPoint(E,$),c.sub(C,E,s.position),o=c.length(C)/r,t.stop())},c.copy($.from,this.position),c.copy($.to,E),$.update(),this.world.raycast(B,$),!e)return!1;var n=this.angle;c.copy(L,this.position);for(var a=0,l=0,p=0,h=o;l<=h&&a<this.ccdIterations;){a++,p=(h-l)/2,c.scale(D,C,o),c.add(this.position,L,D),this.angle=n+i*o,this.updateAABB(),this.aabb.overlaps(e.aabb)&&this.world.narrowphase.bodiesOverlap(this,e)?l=p:h=p}return o=p,c.copy(this.position,L),this.angle=n,c.scale(D,C,o),c.add(this.position,this.position,D),this.fixedRotation||(this.angle+=i*o),!0},a.prototype.getVelocityAtPoint=function(t,e){return c.crossVZ(t,e,this.angularVelocity),c.subtract(t,this.velocity,t),t},a.sleepyEvent={type:"sleepy"},a.sleepEvent={type:"sleep"},a.wakeUpEvent={type:"wakeup"},a.DYNAMIC=1,a.STATIC=2,a.KINEMATIC=4,a.AWAKE=0,a.SLEEPY=1,a.SLEEPING=2},{"../collision/AABB":9,"../collision/Ray":13,"../collision/RaycastResult":14,"../events/EventEmitter":28,"../math/vec2":32,"../shapes/Convex":42,"poly-decomp":82}],34:[function(t,e,i){"use strict";var v=t("../math/vec2"),n=t("./Spring");t("../utils/Utils");function r(t,e,i){i=i||{},n.call(this,t,e,i),this.localAnchorA=v.fromValues(0,0),this.localAnchorB=v.fromValues(0,0),i.localAnchorA&&v.copy(this.localAnchorA,i.localAnchorA),i.localAnchorB&&v.copy(this.localAnchorB,i.localAnchorB),i.worldAnchorA&&this.setWorldAnchorA(i.worldAnchorA),i.worldAnchorB&&this.setWorldAnchorB(i.worldAnchorB);var r=v.create(),o=v.create();this.getWorldAnchorA(r),this.getWorldAnchorB(o);var s=v.distance(r,o);this.restLength="number"==typeof i.restLength?i.restLength:s}(((e.exports=r).prototype=new n).constructor=r).prototype.setWorldAnchorA=function(t){this.bodyA.toLocalFrame(this.localAnchorA,t)},r.prototype.setWorldAnchorB=function(t){this.bodyB.toLocalFrame(this.localAnchorB,t)},r.prototype.getWorldAnchorA=function(t){this.bodyA.toWorldFrame(t,this.localAnchorA)},r.prototype.getWorldAnchorB=function(t){this.bodyB.toWorldFrame(t,this.localAnchorB)};var m=v.create(),b=v.create(),S=v.create(),x=v.create(),R=v.create(),A=v.create(),D=v.create(),B=v.create(),$=v.create();r.prototype.applyForce=function(){var t=this.stiffness,e=this.damping,i=this.restLength,r=this.bodyA,o=this.bodyB,s=m,n=b,a=S,l=x,p=$,h=R,c=A,u=D,f=B;this.getWorldAnchorA(h),this.getWorldAnchorB(c),v.sub(u,h,r.position),v.sub(f,c,o.position),v.sub(s,c,h);var d=v.len(s);v.normalize(n,s),v.sub(a,o.velocity,r.velocity),v.crossZV(p,o.angularVelocity,f),v.add(a,a,p),v.crossZV(p,r.angularVelocity,u),v.sub(a,a,p),v.scale(l,n,-t*(d-i)-e*v.dot(a,n)),v.sub(r.force,r.force,l),v.add(o.force,o.force,l);var y=v.crossLength(u,l),g=v.crossLength(f,l);r.angularForce-=y,o.angularForce+=g}},{"../math/vec2":32,"../utils/Utils":59,"./Spring":36}],35:[function(t,e,i){"use strict";t("../math/vec2");var r=t("./Spring");function o(t,e,i){i=i||{},r.call(this,t,e,i),this.restAngle="number"==typeof i.restAngle?i.restAngle:e.angle-t.angle}(((e.exports=o).prototype=new r).constructor=o).prototype.applyForce=function(){var t=this.stiffness,e=this.damping,i=this.restAngle,r=this.bodyA,o=this.bodyB,s=-t*(o.angle-r.angle-i)-e*(o.angularVelocity-r.angularVelocity)*0;r.angularForce-=s,o.angularForce+=s}},{"../math/vec2":32,"./Spring":36}],36:[function(t,e,i){"use strict";t("../math/vec2");var r=t("../utils/Utils");function o(t,e,i){i=r.defaults(i,{stiffness:100,damping:1}),this.stiffness=i.stiffness,this.damping=i.damping,this.bodyA=t,this.bodyB=e}(e.exports=o).prototype.applyForce=function(){}},{"../math/vec2":32,"../utils/Utils":59}],37:[function(t,e,i){"use strict";var r=t("../math/vec2"),o=(t("../utils/Utils"),t("../constraints/Constraint")),s=t("../equations/FrictionEquation"),n=t("../objects/Body");function a(t,e){this.chassisBody=t,this.wheels=[],this.groundBody=new n({mass:0}),this.world=null;var i=this;this.preStepCallback=function(){i.update()}}function l(t,e){e=e||{},this.vehicle=t,this.forwardEquation=new s(t.chassisBody,t.groundBody),this.sideEquation=new s(t.chassisBody,t.groundBody),this.steerValue=0,this.engineForce=0,this.setSideFriction(void 0!==e.sideFriction?e.sideFriction:5),this.localForwardVector=r.fromValues(0,1),e.localForwardVector&&r.copy(this.localForwardVector,e.localForwardVector),this.localPosition=r.fromValues(0,0),e.localPosition&&r.copy(this.localPosition,e.localPosition),o.apply(this,t.chassisBody,t.groundBody),this.equations.push(this.forwardEquation,this.sideEquation),this.setBrakeForce(0)}(e.exports=a).prototype.addToWorld=function(t){(this.world=t).addBody(this.groundBody),t.on("preStep",this.preStepCallback);for(var e=0;e<this.wheels.length;e++){var i=this.wheels[e];t.addConstraint(i)}},a.prototype.removeFromWorld=function(){var t=this.world;t.removeBody(this.groundBody),t.off("preStep",this.preStepCallback);for(var e=0;e<this.wheels.length;e++){var i=this.wheels[e];t.removeConstraint(i)}this.world=null},a.prototype.addWheel=function(t){var e=new l(this,t);return this.wheels.push(e),e},a.prototype.update=function(){for(var t=0;t<this.wheels.length;t++)this.wheels[t].update()},(l.prototype=new o).setBrakeForce=function(t){this.forwardEquation.setSlipForce(t)},l.prototype.setSideFriction=function(t){this.sideEquation.setSlipForce(t)};var p=r.create(),h=r.create();l.prototype.getSpeed=function(){return this.vehicle.chassisBody.vectorToWorldFrame(h,this.localForwardVector),this.vehicle.chassisBody.getVelocityAtPoint(p,h),r.dot(p,h)};var c=r.create();l.prototype.update=function(){this.vehicle.chassisBody.vectorToWorldFrame(this.forwardEquation.t,this.localForwardVector),r.rotate(this.sideEquation.t,this.localForwardVector,Math.PI/2),this.vehicle.chassisBody.vectorToWorldFrame(this.sideEquation.t,this.sideEquation.t),r.rotate(this.forwardEquation.t,this.forwardEquation.t,this.steerValue),r.rotate(this.sideEquation.t,this.sideEquation.t,this.steerValue),this.vehicle.chassisBody.toWorldFrame(this.forwardEquation.contactPointB,this.localPosition),r.copy(this.sideEquation.contactPointB,this.forwardEquation.contactPointB),this.vehicle.chassisBody.vectorToWorldFrame(this.forwardEquation.contactPointA,this.localPosition),r.copy(this.sideEquation.contactPointA,this.forwardEquation.contactPointA),r.normalize(c,this.forwardEquation.t),r.scale(c,c,this.engineForce),this.vehicle.chassisBody.applyForce(c,this.forwardEquation.contactPointA)}},{"../constraints/Constraint":16,"../equations/FrictionEquation":25,"../math/vec2":32,"../objects/Body":33,"../utils/Utils":59}],38:[function(t,e,i){"use strict";var r=e.exports={AABB:t("./collision/AABB"),AngleLockEquation:t("./equations/AngleLockEquation"),Body:t("./objects/Body"),Broadphase:t("./collision/Broadphase"),Capsule:t("./shapes/Capsule"),Circle:t("./shapes/Circle"),Constraint:t("./constraints/Constraint"),ContactEquation:t("./equations/ContactEquation"),ContactEquationPool:t("./utils/ContactEquationPool"),ContactMaterial:t("./material/ContactMaterial"),Convex:t("./shapes/Convex"),DistanceConstraint:t("./constraints/DistanceConstraint"),Equation:t("./equations/Equation"),EventEmitter:t("./events/EventEmitter"),FrictionEquation:t("./equations/FrictionEquation"),FrictionEquationPool:t("./utils/FrictionEquationPool"),GearConstraint:t("./constraints/GearConstraint"),GSSolver:t("./solver/GSSolver"),Heightfield:t("./shapes/Heightfield"),Line:t("./shapes/Line"),LockConstraint:t("./constraints/LockConstraint"),Material:t("./material/Material"),Narrowphase:t("./collision/Narrowphase"),NaiveBroadphase:t("./collision/NaiveBroadphase"),Particle:t("./shapes/Particle"),Plane:t("./shapes/Plane"),Pool:t("./utils/Pool"),RevoluteConstraint:t("./constraints/RevoluteConstraint"),PrismaticConstraint:t("./constraints/PrismaticConstraint"),Ray:t("./collision/Ray"),RaycastResult:t("./collision/RaycastResult"),Box:t("./shapes/Box"),RotationalVelocityEquation:t("./equations/RotationalVelocityEquation"),SAPBroadphase:t("./collision/SAPBroadphase"),Shape:t("./shapes/Shape"),Solver:t("./solver/Solver"),Spring:t("./objects/Spring"),TopDownVehicle:t("./objects/TopDownVehicle"),LinearSpring:t("./objects/LinearSpring"),RotationalSpring:t("./objects/RotationalSpring"),Utils:t("./utils/Utils"),World:t("./world/World"),vec2:t("./math/vec2"),version:t("../package.json").version};Object.defineProperty(r,"Rectangle",{get:function(){return console.warn("The Rectangle class has been renamed to Box."),this.Box}})},{"../package.json":8,"./collision/AABB":9,"./collision/Broadphase":10,"./collision/NaiveBroadphase":11,"./collision/Narrowphase":12,"./collision/Ray":13,"./collision/RaycastResult":14,"./collision/SAPBroadphase":15,"./constraints/Constraint":16,"./constraints/DistanceConstraint":17,"./constraints/GearConstraint":18,"./constraints/LockConstraint":19,"./constraints/PrismaticConstraint":20,"./constraints/RevoluteConstraint":21,"./equations/AngleLockEquation":22,"./equations/ContactEquation":23,"./equations/Equation":24,"./equations/FrictionEquation":25,"./equations/RotationalVelocityEquation":27,"./events/EventEmitter":28,"./material/ContactMaterial":29,"./material/Material":30,"./math/vec2":32,"./objects/Body":33,"./objects/LinearSpring":34,"./objects/RotationalSpring":35,"./objects/Spring":36,"./objects/TopDownVehicle":37,"./shapes/Box":39,"./shapes/Capsule":40,"./shapes/Circle":41,"./shapes/Convex":42,"./shapes/Heightfield":43,"./shapes/Line":44,"./shapes/Particle":45,"./shapes/Plane":46,"./shapes/Shape":47,"./solver/GSSolver":48,"./solver/Solver":49,"./utils/ContactEquationPool":50,"./utils/FrictionEquationPool":51,"./utils/Pool":57,"./utils/Utils":59,"./world/World":63}],39:[function(t,e,i){"use strict";var s=t("../math/vec2"),n=t("./Shape"),a=t("./Convex");function r(t){"number"==typeof arguments[0]&&"number"==typeof arguments[1]&&(t={width:arguments[0],height:arguments[1]},console.warn("The Rectangle has been renamed to Box and its constructor signature has changed. Please use the following format: new Box({ width: 1, height: 1, ... })")),t=t||{};var e=this.width=t.width||1,i=this.height=t.height||1,r=[s.fromValues(-e/2,-i/2),s.fromValues(e/2,-i/2),s.fromValues(e/2,i/2),s.fromValues(-e/2,i/2)],o=[s.fromValues(1,0),s.fromValues(0,1)];t.vertices=r,t.axes=o,t.type=n.BOX,a.call(this,t)}(((e.exports=r).prototype=new a).constructor=r).prototype.computeMomentOfInertia=function(t){var e=this.width,i=this.height;return t*(i*i+e*e)/12},r.prototype.updateBoundingRadius=function(){var t=this.width,e=this.height;this.boundingRadius=Math.sqrt(t*t+e*e)/2};s.create(),s.create(),s.create(),s.create();r.prototype.computeAABB=function(t,e,i){t.setFromPoints(this.vertices,e,i,0)},r.prototype.updateArea=function(){this.area=this.width*this.height}},{"../math/vec2":32,"./Convex":42,"./Shape":47}],40:[function(t,e,i){"use strict";var r=t("./Shape"),R=t("../math/vec2");function o(t){"number"==typeof arguments[0]&&"number"==typeof arguments[1]&&(t={length:arguments[0],radius:arguments[1]},console.warn("The Capsule constructor signature has changed. Please use the following format: new Capsule({ radius: 1, length: 1 })")),t=t||{},this.length=t.length||1,this.radius=t.radius||1,t.type=r.CAPSULE,r.call(this,t)}(((e.exports=o).prototype=new r).constructor=o).prototype.computeMomentOfInertia=function(t){var e=this.radius,i=this.length+e,r=2*e;return t*(r*r+i*i)/12},o.prototype.updateBoundingRadius=function(){this.boundingRadius=this.radius+this.length/2},o.prototype.updateArea=function(){this.area=Math.PI*this.radius*this.radius+2*this.radius*this.length};var s=R.create();o.prototype.computeAABB=function(t,e,i){var r=this.radius;R.set(s,this.length/2,0),0!==i&&R.rotate(s,s,i),R.set(t.upperBound,Math.max(s[0]+r,-s[0]+r),Math.max(s[1]+r,-s[1]+r)),R.set(t.lowerBound,Math.min(s[0]-r,-s[0]-r),Math.min(s[1]-r,-s[1]-r)),R.add(t.lowerBound,t.lowerBound,e),R.add(t.upperBound,t.upperBound,e)};var A=R.create(),D=R.create(),B=R.create(),$=R.create(),w=R.fromValues(0,1);o.prototype.raycast=function(t,e,i,r){for(var o=e.from,s=e.to,n=(e.direction,A),a=D,l=B,p=$,h=this.length/2,c=0;c<2;c++){var u=this.radius*(2*c-1);if(R.set(l,-h,u),R.set(p,h,u),R.toGlobalFrame(l,l,i,r),R.toGlobalFrame(p,p,i,r),0<=(d=R.getLineSegmentsIntersectionFraction(o,s,l,p))&&(R.rotate(a,w,r),R.scale(a,a,2*c-1),e.reportIntersection(t,d,a,-1),t.shouldStop(e)))return}var f=Math.pow(this.radius,2)+Math.pow(h,2);for(c=0;c<2;c++){R.set(l,h*(2*c-1),0),R.toGlobalFrame(l,l,i,r);var d,y=Math.pow(s[0]-o[0],2)+Math.pow(s[1]-o[1],2),g=2*((s[0]-o[0])*(o[0]-l[0])+(s[1]-o[1])*(o[1]-l[1])),v=Math.pow(o[0]-l[0],2)+Math.pow(o[1]-l[1],2)-Math.pow(this.radius,2);if(!((d=Math.pow(g,2)-4*y*v)<0))if(0===d){if(R.lerp(n,o,s,d),R.squaredDistance(n,i)>f&&(R.sub(a,n,l),R.normalize(a,a),e.reportIntersection(t,d,a,-1),t.shouldStop(e)))return}else{var m=Math.sqrt(d),b=1/(2*y),S=(-g-m)*b,x=(-g+m)*b;if(0<=S&&S<=1&&(R.lerp(n,o,s,S),R.squaredDistance(n,i)>f&&(R.sub(a,n,l),R.normalize(a,a),e.reportIntersection(t,S,a,-1),t.shouldStop(e))))return;if(0<=x&&x<=1&&(R.lerp(n,o,s,x),R.squaredDistance(n,i)>f&&(R.sub(a,n,l),R.normalize(a,a),e.reportIntersection(t,x,a,-1),t.shouldStop(e))))return}}}},{"../math/vec2":32,"./Shape":47}],41:[function(t,e,i){"use strict";var r=t("./Shape"),v=t("../math/vec2");function o(t){"number"==typeof arguments[0]&&(t={radius:arguments[0]},console.warn("The Circle constructor signature has changed. Please use the following format: new Circle({ radius: 1 })")),t=t||{},this.radius=t.radius||1,t.type=r.CIRCLE,r.call(this,t)}(((e.exports=o).prototype=new r).constructor=o).prototype.computeMomentOfInertia=function(t){var e=this.radius;return t*e*e/2},o.prototype.updateBoundingRadius=function(){this.boundingRadius=this.radius},o.prototype.updateArea=function(){this.area=Math.PI*this.radius*this.radius},o.prototype.computeAABB=function(t,e,i){var r=this.radius;v.set(t.upperBound,r,r),v.set(t.lowerBound,-r,-r),e&&(v.add(t.lowerBound,t.lowerBound,e),v.add(t.upperBound,t.upperBound,e))};var m=v.create(),b=v.create();o.prototype.raycast=function(t,e,i,r){var o=e.from,s=e.to,n=this.radius,a=Math.pow(s[0]-o[0],2)+Math.pow(s[1]-o[1],2),l=2*((s[0]-o[0])*(o[0]-i[0])+(s[1]-o[1])*(o[1]-i[1])),p=Math.pow(o[0]-i[0],2)+Math.pow(o[1]-i[1],2)-Math.pow(n,2),h=Math.pow(l,2)-4*a*p,c=m,u=b;if(!(h<0))if(0==h)v.lerp(c,o,s,h),v.sub(u,c,i),v.normalize(u,u),e.reportIntersection(t,h,u,-1);else{var f=Math.sqrt(h),d=1/(2*a),y=(-l-f)*d,g=(-l+f)*d;if(0<=y&&y<=1&&(v.lerp(c,o,s,y),v.sub(u,c,i),v.normalize(u,u),e.reportIntersection(t,y,u,-1),t.shouldStop(e)))return;0<=g&&g<=1&&(v.lerp(c,o,s,g),v.sub(u,c,i),v.normalize(u,u),e.reportIntersection(t,g,u,-1))}}},{"../math/vec2":32,"./Shape":47}],42:[function(t,e,i){"use strict";var l=t("./Shape"),f=t("../math/vec2"),a=t("../math/polyk");t("poly-decomp");function u(t){Array.isArray(arguments[0])&&(t={vertices:arguments[0],axes:arguments[1]},console.warn("The Convex constructor signature has changed. Please use the following format: new Convex({ vertices: [...], ... })")),t=t||{},this.vertices=[];for(var e=void 0!==t.vertices?t.vertices:[],i=0;i<e.length;i++){var r=f.create();f.copy(r,e[i]),this.vertices.push(r)}if(this.axes=[],t.axes)for(i=0;i<t.axes.length;i++){var o=f.create();f.copy(o,t.axes[i]),this.axes.push(o)}else for(i=0;i<this.vertices.length;i++){var s=this.vertices[i],n=this.vertices[(i+1)%this.vertices.length],a=f.create();f.sub(a,n,s),f.rotate90cw(a,a),f.normalize(a,a),this.axes.push(a)}if(this.centerOfMass=f.fromValues(0,0),this.triangles=[],this.vertices.length&&(this.updateTriangles(),this.updateCenterOfMass()),this.boundingRadius=0,t.type=l.CONVEX,l.call(this,t),this.updateBoundingRadius(),this.updateArea(),this.area<0)throw new Error("Convex vertices must be given in conter-clockwise winding.")}((e.exports=u).prototype=new l).constructor=u;var p=f.create(),n=f.create();u.prototype.projectOntoLocalAxis=function(t,e){for(var i,r,o=null,s=null,n=(t=p,0);n<this.vertices.length;n++)i=this.vertices[n],r=f.dot(i,t),(null===o||o<r)&&(o=r),(null===s||r<s)&&(s=r);if(o<s){var a=s;s=o,o=a}f.set(e,s,o)},u.prototype.projectOntoWorldAxis=function(t,e,i,r){var o=n;this.projectOntoLocalAxis(t,r),0!==i?f.rotate(o,t,i):o=t;var s=f.dot(e,o);f.set(r,r[0]+s,r[1]+s)},u.prototype.updateTriangles=function(){for(var t=[],e=this.triangles.length=0;e<this.vertices.length;e++){var i=this.vertices[e];t.push(i[0],i[1])}var r=a.Triangulate(t);for(e=0;e<r.length;e+=3){var o=r[e],s=r[e+1],n=r[e+2];this.triangles.push([o,s,n])}};var d=f.create(),y=f.create(),g=f.create(),v=f.create(),m=f.create();f.create(),f.create(),f.create(),f.create();u.prototype.updateCenterOfMass=function(){var t=this.triangles,e=this.vertices,i=this.centerOfMass,r=d,o=g,s=v,n=m,a=y;f.set(i,0,0);for(var l=0,p=0;p!==t.length;p++){var h=t[p];o=e[h[0]],s=e[h[1]],n=e[h[2]];f.centroid(r,o,s,n);var c=u.triangleArea(o,s,n);l+=c,f.scale(a,r,c),f.add(i,i,a)}f.scale(i,i,1/l)},u.prototype.computeMomentOfInertia=function(t){for(var e=0,i=0,r=this.vertices.length,o=r-1,s=0;s<r;o=s,s++){var n=this.vertices[o],a=this.vertices[s],l=Math.abs(f.crossLength(n,a));e+=l*(f.dot(a,a)+f.dot(a,n)+f.dot(n,n)),i+=l}return t/6*(e/i)},u.prototype.updateBoundingRadius=function(){for(var t=this.vertices,e=0,i=0;i!==t.length;i++){var r=f.squaredLength(t[i]);e<r&&(e=r)}this.boundingRadius=Math.sqrt(e)},u.triangleArea=function(t,e,i){return.5*((e[0]-t[0])*(i[1]-t[1])-(i[0]-t[0])*(e[1]-t[1]))},u.prototype.updateArea=function(){this.updateTriangles(),this.area=0;for(var t=this.triangles,e=this.vertices,i=0;i!==t.length;i++){var r=t[i],o=e[r[0]],s=e[r[1]],n=e[r[2]],a=u.triangleArea(o,s,n);this.area+=a}},u.prototype.computeAABB=function(t,e,i){t.setFromPoints(this.vertices,e,i,0)};var b=f.create(),S=f.create(),x=f.create();u.prototype.raycast=function(t,e,i,r){var o=b,s=S,n=x,a=this.vertices;f.toLocalFrame(o,e.from,i,r),f.toLocalFrame(s,e.to,i,r);for(var l=a.length,p=0;p<l&&!t.shouldStop(e);p++){var h=a[p],c=a[(p+1)%l],u=f.getLineSegmentsIntersectionFraction(o,s,h,c);0<=u&&(f.sub(n,c,h),f.rotate(n,n,-Math.PI/2+r),f.normalize(n,n),e.reportIntersection(t,u,n,p))}}},{"../math/polyk":31,"../math/vec2":32,"./Shape":47,"poly-decomp":82}],43:[function(t,e,i){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var o=t("./Shape"),g=t("../math/vec2");t("../utils/Utils");function s(t){if(Array.isArray(arguments[0])){if(t={heights:arguments[0]},"object"===r(arguments[1]))for(var e in arguments[1])t[e]=arguments[1][e];console.warn("The Heightfield constructor signature has changed. Please use the following format: new Heightfield({ heights: [...], ... })")}t=t||{},this.heights=t.heights?t.heights.slice(0):[],this.maxValue=t.maxValue||null,this.minValue=t.minValue||null,this.elementWidth=t.elementWidth||.1,void 0!==t.maxValue&&void 0!==t.minValue||this.updateMaxMinValues(),t.type=o.HEIGHTFIELD,o.call(this,t)}(((e.exports=s).prototype=new o).constructor=s).prototype.updateMaxMinValues=function(){for(var t=this.heights,e=t[0],i=t[0],r=0;r!==t.length;r++){var o=t[r];e<o&&(e=o),o<i&&(i=o)}this.maxValue=e,this.minValue=i},s.prototype.computeMomentOfInertia=function(t){return Number.MAX_VALUE},s.prototype.updateBoundingRadius=function(){this.boundingRadius=Number.MAX_VALUE},s.prototype.updateArea=function(){for(var t=this.heights,e=0,i=0;i<t.length-1;i++)e+=(t[i]+t[i+1])/2*this.elementWidth;this.area=e};var n=[g.create(),g.create(),g.create(),g.create()];s.prototype.computeAABB=function(t,e,i){g.set(n[0],0,this.maxValue),g.set(n[1],this.elementWidth*this.heights.length,this.maxValue),g.set(n[2],this.elementWidth*this.heights.length,this.minValue),g.set(n[3],0,this.minValue),t.setFromPoints(n,e,i)},s.prototype.getLineSegment=function(t,e,i){var r=this.heights,o=this.elementWidth;g.set(t,i*o,r[i]),g.set(e,(i+1)*o,r[i+1])},s.prototype.getSegmentIndex=function(t){return Math.floor(t[0]/this.elementWidth)},s.prototype.getClampedSegmentIndex=function(t){var e=this.getSegmentIndex(t);return e=Math.min(this.heights.length,Math.max(e,0))};g.create();var v=g.create(),m=g.create(),b=g.create(),S=g.create(),x=g.create();g.fromValues(0,1);s.prototype.raycast=function(t,e,i,r){var o=e.from,s=e.to,n=(e.direction,v),a=m,l=b,p=S,h=x;g.toLocalFrame(p,o,i,r),g.toLocalFrame(h,s,i,r);var c=this.getClampedSegmentIndex(p),u=this.getClampedSegmentIndex(h);if(u<c){var f=c;c=u,u=f}for(var d=0;d<this.heights.length-1;d++){this.getLineSegment(a,l,d);var y=g.getLineSegmentsIntersectionFraction(p,h,a,l);if(0<=y&&(g.sub(n,l,a),g.rotate(n,n,r+Math.PI/2),g.normalize(n,n),e.reportIntersection(t,y,n,-1),t.shouldStop(e)))return}}},{"../math/vec2":32,"../utils/Utils":59,"./Shape":47}],44:[function(t,e,i){"use strict";var r=t("./Shape"),c=t("../math/vec2");function o(t){"number"==typeof arguments[0]&&(t={length:arguments[0]},console.warn("The Line constructor signature has changed. Please use the following format: new Line({ length: 1, ... })")),t=t||{},this.length=t.length||1,t.type=r.LINE,r.call(this,t)}(((e.exports=o).prototype=new r).constructor=o).prototype.computeMomentOfInertia=function(t){return t*Math.pow(this.length,2)/12},o.prototype.updateBoundingRadius=function(){this.boundingRadius=this.length/2};var s=[c.create(),c.create()];o.prototype.computeAABB=function(t,e,i){var r=this.length/2;c.set(s[0],-r,0),c.set(s[1],r,0),t.setFromPoints(s,e,i,0)};c.create();var u=c.create(),f=c.create(),d=c.create(),y=c.fromValues(0,1);o.prototype.raycast=function(t,e,i,r){var o=e.from,s=e.to,n=f,a=d,l=this.length/2;c.set(n,-l,0),c.set(a,l,0),c.toGlobalFrame(n,n,i,r),c.toGlobalFrame(a,a,i,r);var p=c.getLineSegmentsIntersectionFraction(n,a,o,s);if(0<=p){var h=u;c.rotate(h,y,r),e.reportIntersection(t,p,h,-1)}}},{"../math/vec2":32,"./Shape":47}],45:[function(t,e,i){"use strict";var r=t("./Shape"),o=t("../math/vec2");function s(t){(t=t||{}).type=r.PARTICLE,r.call(this,t)}(((e.exports=s).prototype=new r).constructor=s).prototype.computeMomentOfInertia=function(t){return 0},s.prototype.updateBoundingRadius=function(){this.boundingRadius=0},s.prototype.computeAABB=function(t,e,i){o.copy(t.lowerBound,e),o.copy(t.upperBound,e)}},{"../math/vec2":32,"./Shape":47}],46:[function(t,e,i){"use strict";var r=t("./Shape"),f=t("../math/vec2");t("../utils/Utils");function o(t){(t=t||{}).type=r.PLANE,r.call(this,t)}(((e.exports=o).prototype=new r).constructor=o).prototype.computeMomentOfInertia=function(t){return 0},o.prototype.updateBoundingRadius=function(){this.boundingRadius=Number.MAX_VALUE},o.prototype.computeAABB=function(t,e,i){var r=i%(2*Math.PI),o=f.set,s=t.lowerBound,n=t.upperBound;o(s,-1e7,-1e7),o(n,1e7,1e7),0==r?n[1]=0:r==Math.PI/2?s[0]=0:r===Math.PI?s[1]=0:r==3*Math.PI/2&&(n[0]=0)},o.prototype.updateArea=function(){this.area=Number.MAX_VALUE};var d=f.create(),y=(f.create(),f.create(),f.create()),g=f.create();o.prototype.raycast=function(t,e,i,r){var o=e.from,s=e.to,n=e.direction,a=d,l=y,p=g;f.set(l,0,1),f.rotate(l,l,r),f.sub(p,o,i);var h=f.dot(p,l);if(f.sub(p,s,i),!(0<h*f.dot(p,l)||f.squaredDistance(o,s)<h*h)){var c=f.dot(l,n);f.sub(a,o,i);var u=-f.dot(l,a)/c/e.length;e.reportIntersection(t,u,l,-1)}}},{"../math/vec2":32,"../utils/Utils":59,"./Shape":47}],47:[function(t,e,i){"use strict";e.exports=o;var r=t("../math/vec2");function o(t){t=t||{},this.body=null,this.position=r.fromValues(0,0),t.position&&r.copy(this.position,t.position),this.angle=t.angle||0,this.type=t.type||0,this.id=o.idCounter++,this.boundingRadius=0,this.collisionGroup=void 0!==t.collisionGroup?t.collisionGroup:1,this.collisionResponse=void 0===t.collisionResponse||t.collisionResponse,this.collisionMask=void 0!==t.collisionMask?t.collisionMask:1,this.material=t.material||null,this.area=0,this.sensor=void 0!==t.sensor&&t.sensor,this.type&&this.updateBoundingRadius(),this.updateArea()}o.idCounter=0,o.CIRCLE=1,o.PARTICLE=2,o.PLANE=4,o.CONVEX=8,o.LINE=16,o.BOX=32,Object.defineProperty(o,"RECTANGLE",{get:function(){return console.warn("Shape.RECTANGLE is deprecated, use Shape.BOX instead."),o.BOX}}),o.CAPSULE=64,o.HEIGHTFIELD=128,o.prototype.computeMomentOfInertia=function(t){},o.prototype.updateBoundingRadius=function(){},o.prototype.updateArea=function(){},o.prototype.computeAABB=function(t,e,i){},o.prototype.raycast=function(t,e,i,r){}},{"../math/vec2":32}],48:[function(t,e,i){"use strict";var R=t("../math/vec2"),r=t("./Solver"),A=t("../utils/Utils"),D=t("../equations/FrictionEquation");function B(t){r.call(this,t,r.GS),t=t||{},this.iterations=t.iterations||10,this.tolerance=t.tolerance||1e-7,this.arrayStep=30,this.lambda=new A.ARRAY_TYPE(this.arrayStep),this.Bs=new A.ARRAY_TYPE(this.arrayStep),this.invCs=new A.ARRAY_TYPE(this.arrayStep),this.useZeroRHS=!1,this.frictionIterations=void 0!==t.frictionIterations?0:t.frictionIterations,this.usedIterations=0}(((e.exports=B).prototype=new r).constructor=B).prototype.solve=function(t,e){this.sortEquations();var i=0,r=this.iterations,o=this.frictionIterations,s=this.equations,n=s.length,a=Math.pow(this.tolerance*n,2),l=e.bodies,p=e.bodies.length,h=(R.add,R.set,this.useZeroRHS),c=this.lambda;if(this.usedIterations=0,n)for(var u=0;u!==p;u++){l[u].updateSolveMassProperties()}c.length<n&&(c=this.lambda=new A.ARRAY_TYPE(n+this.arrayStep),this.Bs=new A.ARRAY_TYPE(n+this.arrayStep),this.invCs=new A.ARRAY_TYPE(n+this.arrayStep)),function(t){for(var e=t.length;e--;)t[e]=0}(c);var f,d,y=this.invCs,g=this.Bs;for(c=this.lambda,u=0;u!==s.length;u++){var v;(v=s[u]).timeStep===t&&!v.needsUpdate||(v.timeStep=t,v.update()),g[u]=v.computeB(v.a,v.b,t),y[u]=v.computeInvC(v.epsilon)}if(0!==n){for(u=0;u!==p;u++){l[u].resetConstraintVelocity()}if(o){for(i=0;i!==o;i++){for(d=f=0;d!==n;d++){v=s[d];var m=B.iterateEquation(d,v,v.epsilon,g,y,c,h,t,i);f+=Math.abs(m)}if(this.usedIterations++,f*f<=a)break}for(B.updateMultipliers(s,c,1/t),d=0;d!==n;d++){var b=s[d];if(b instanceof D){for(var S=0,x=0;x!==b.contactEquations.length;x++)S+=b.contactEquations[x].multiplier;S*=b.frictionCoefficient/b.contactEquations.length,b.maxForce=S,b.minForce=-S}}}for(i=0;i!==r;i++){for(d=f=0;d!==n;d++){v=s[d];m=B.iterateEquation(d,v,v.epsilon,g,y,c,h,t,i);f+=Math.abs(m)}if(this.usedIterations++,f*f<=a)break}for(u=0;u!==p;u++)l[u].addConstraintVelocity();B.updateMultipliers(s,c,1/t)}},B.updateMultipliers=function(t,e,i){for(var r=t.length;r--;)t[r].multiplier=e[r]*i},B.iterateEquation=function(t,e,i,r,o,s,n,a,l){var p=r[t],h=o[t],c=s[t],u=e.computeGWlambda(),f=e.maxForce,d=e.minForce;n&&(p=0);var y=h*(p-u-i*c),g=c+y;return g<d*a?y=d*a-c:f*a<g&&(y=f*a-c),s[t]+=y,e.addToWlambda(y),y}},{"../equations/FrictionEquation":25,"../math/vec2":32,"../utils/Utils":59,"./Solver":49}],49:[function(t,e,i){"use strict";t("../utils/Utils");var r=t("../events/EventEmitter");function o(t,e){t=t||{},r.call(this),this.type=e,this.equations=[],this.equationSortFunction=t.equationSortFunction||!1}(((e.exports=o).prototype=new r).constructor=o).prototype.solve=function(t,e){throw new Error("Solver.solve should be implemented by subclasses!")};var s={bodies:[]};o.prototype.solveIsland=function(t,e){this.removeAllEquations(),e.equations.length&&(this.addEquations(e.equations),s.bodies.length=0,e.getBodies(s.bodies),s.bodies.length&&this.solve(t,s))},o.prototype.sortEquations=function(){this.equationSortFunction&&this.equations.sort(this.equationSortFunction)},o.prototype.addEquation=function(t){t.enabled&&this.equations.push(t)},o.prototype.addEquations=function(t){for(var e=0,i=t.length;e!==i;e++){var r=t[e];r.enabled&&this.equations.push(r)}},o.prototype.removeEquation=function(t){var e=this.equations.indexOf(t);-1!==e&&this.equations.splice(e,1)},o.prototype.removeAllEquations=function(){this.equations.length=0},o.GS=1,o.ISLAND=2},{"../events/EventEmitter":28,"../utils/Utils":59}],50:[function(t,e,i){"use strict";var r=t("../equations/ContactEquation"),o=t("./Pool");function s(){o.apply(this,arguments)}(((e.exports=s).prototype=new o).constructor=s).prototype.create=function(){return new r},s.prototype.destroy=function(t){return t.bodyA=t.bodyB=null,this}},{"../equations/ContactEquation":23,"./Pool":57}],51:[function(t,e,i){"use strict";var r=t("../equations/FrictionEquation"),o=t("./Pool");function s(){o.apply(this,arguments)}(((e.exports=s).prototype=new o).constructor=s).prototype.create=function(){return new r},s.prototype.destroy=function(t){return t.bodyA=t.bodyB=null,this}},{"../equations/FrictionEquation":25,"./Pool":57}],52:[function(t,e,i){"use strict";var r=t("../world/IslandNode"),o=t("./Pool");function s(){o.apply(this,arguments)}(((e.exports=s).prototype=new o).constructor=s).prototype.create=function(){return new r},s.prototype.destroy=function(t){return t.reset(),this}},{"../world/IslandNode":62,"./Pool":57}],53:[function(t,e,i){"use strict";var r=t("../world/Island"),o=t("./Pool");function s(){o.apply(this,arguments)}(((e.exports=s).prototype=new o).constructor=s).prototype.create=function(){return new r},s.prototype.destroy=function(t){return t.reset(),this}},{"../world/Island":60,"./Pool":57}],54:[function(t,e,i){"use strict";var r=t("./TupleDictionary"),o=(t("./OverlapKeeperRecord"),t("./OverlapKeeperRecordPool"));t("./Utils");function s(){this.overlappingShapesLastState=new r,this.overlappingShapesCurrentState=new r,this.recordPool=new o({size:16}),this.tmpDict=new r,this.tmpArray1=[]}(e.exports=s).prototype.tick=function(){for(var t=this.overlappingShapesLastState,e=this.overlappingShapesCurrentState,i=t.keys.length;i--;){var r=t.keys[i],o=t.getByKey(r);e.getByKey(r);o&&this.recordPool.release(o)}t.reset(),t.copy(e),e.reset()},s.prototype.setOverlapping=function(t,e,i,r){this.overlappingShapesLastState;var o=this.overlappingShapesCurrentState;if(!o.get(e.id,r.id)){var s=this.recordPool.get();s.set(t,e,i,r),o.set(e.id,r.id,s)}},s.prototype.getNewOverlaps=function(t){return this.getDiff(this.overlappingShapesLastState,this.overlappingShapesCurrentState,t)},s.prototype.getEndOverlaps=function(t){return this.getDiff(this.overlappingShapesCurrentState,this.overlappingShapesLastState,t)},s.prototype.bodiesAreOverlapping=function(t,e){for(var i=this.overlappingShapesCurrentState,r=i.keys.length;r--;){var o=i.keys[r],s=i.data[o];if(s.bodyA===t&&s.bodyB===e||s.bodyA===e&&s.bodyB===t)return!0}return!1},s.prototype.getDiff=function(t,e,i){var r=t,o=e;(i=i||[]).length=0;for(var s=o.keys.length;s--;){var n=o.keys[s],a=o.data[n];if(!a)throw new Error("Key "+n+" had no data!");r.data[n]||i.push(a)}return i},s.prototype.isNewOverlap=function(t,e){var i=0|t.id,r=0|e.id,o=this.overlappingShapesLastState,s=this.overlappingShapesCurrentState;return!o.get(i,r)&&!!s.get(i,r)},s.prototype.getNewBodyOverlaps=function(t){this.tmpArray1.length=0;var e=this.getNewOverlaps(this.tmpArray1);return this.getBodyDiff(e,t)},s.prototype.getEndBodyOverlaps=function(t){this.tmpArray1.length=0;var e=this.getEndOverlaps(this.tmpArray1);return this.getBodyDiff(e,t)},s.prototype.getBodyDiff=function(t,e){e=e||[];for(var i=this.tmpDict,r=t.length;r--;){var o=t[r];i.set(0|o.bodyA.id,0|o.bodyB.id,o)}for(r=i.keys.length;r--;){(o=i.getByKey(i.keys[r]))&&e.push(o.bodyA,o.bodyB)}return i.reset(),e}},{"./OverlapKeeperRecord":55,"./OverlapKeeperRecordPool":56,"./TupleDictionary":58,"./Utils":59}],55:[function(t,e,i){"use strict";function o(t,e,i,r){this.shapeA=e,this.shapeB=r,this.bodyA=t,this.bodyB=i}(e.exports=o).prototype.set=function(t,e,i,r){o.call(this,t,e,i,r)}},{}],56:[function(t,e,i){"use strict";var r=t("./OverlapKeeperRecord"),o=t("./Pool");function s(){o.apply(this,arguments)}(((e.exports=s).prototype=new o).constructor=s).prototype.create=function(){return new r},s.prototype.destroy=function(t){return t.bodyA=t.bodyB=t.shapeA=t.shapeB=null,this}},{"./OverlapKeeperRecord":55,"./Pool":57}],57:[function(t,e,i){"use strict";function r(t){t=t||{},this.objects=[],void 0!==t.size&&this.resize(t.size)}(e.exports=r).prototype.resize=function(t){for(var e=this.objects;e.length>t;)e.pop();for(;e.length<t;)e.push(this.create());return this},r.prototype.get=function(){var t=this.objects;return t.length?t.pop():this.create()},r.prototype.release=function(t){return this.destroy(t),this.objects.push(t),this}},{}],58:[function(t,e,i){"use strict";var r=t("./Utils");function o(){this.data={},this.keys=[]}(e.exports=o).prototype.getKey=function(t,e){return(0|(t|=0))==(0|(e|=0))?-1:0|((0|e)<(0|t)?t<<16|65535&e:e<<16|65535&t)},o.prototype.getByKey=function(t){return t|=0,this.data[t]},o.prototype.get=function(t,e){return this.data[this.getKey(t,e)]},o.prototype.set=function(t,e,i){if(!i)throw new Error("No data!");var r=this.getKey(t,e);return this.data[r]||this.keys.push(r),this.data[r]=i,r},o.prototype.reset=function(){for(var t=this.data,e=this.keys,i=e.length;i--;)delete t[e[i]];e.length=0},o.prototype.copy=function(t){this.reset(),r.appendArray(this.keys,t.keys);for(var e=t.keys.length;e--;){var i=t.keys[e];this.data[i]=t.data[i]}}},{"./Utils":59}],59:[function(t,e,i){"use strict";function r(){}(e.exports=r).appendArray=function(t,e){if(e.length<15e4)t.push.apply(t,e);else for(var i=0,r=e.length;i!==r;++i)t.push(e[i])},r.splice=function(t,e,i){i=i||1;for(var r=e,o=t.length-i;r<o;r++)t[r]=t[r+i];t.length=o},"undefined"!=typeof P2_ARRAY_TYPE?r.ARRAY_TYPE=P2_ARRAY_TYPE:"undefined"!=typeof Float32Array?r.ARRAY_TYPE=Float32Array:r.ARRAY_TYPE=Array,r.extend=function(t,e){for(var i in e)t[i]=e[i]},r.defaults=function(t,e){for(var i in t=t||{},e)i in t||(t[i]=e[i]);return t}},{}],60:[function(t,e,i){"use strict";var r=t("../objects/Body");function o(){this.equations=[],this.bodies=[]}(e.exports=o).prototype.reset=function(){this.equations.length=this.bodies.length=0};var s=[];o.prototype.getBodies=function(t){for(var e=t||[],i=this.equations,r=s.length=0;r!==i.length;r++){var o=i[r];-1===s.indexOf(o.bodyA.id)&&(e.push(o.bodyA),s.push(o.bodyA.id)),-1===s.indexOf(o.bodyB.id)&&(e.push(o.bodyB),s.push(o.bodyB.id))}return e},o.prototype.wantsToSleep=function(){for(var t=0;t<this.bodies.length;t++){var e=this.bodies[t];if(e.type===r.DYNAMIC&&!e.wantsToSleep)return!1}return!0},o.prototype.sleep=function(){for(var t=0;t<this.bodies.length;t++){this.bodies[t].sleep()}return!0}},{"../objects/Body":33}],61:[function(t,e,i){"use strict";t("../math/vec2"),t("./Island"),t("./IslandNode");var r=t("./../utils/IslandNodePool"),o=t("./../utils/IslandPool"),n=t("../objects/Body");function d(t){this.nodePool=new r({size:16}),this.islandPool=new o({size:8}),this.equations=[],this.islands=[],this.nodes=[],this.queue=[]}(e.exports=d).getUnvisitedNode=function(t){for(var e=t.length,i=0;i!==e;i++){var r=t[i];if(!r.visited&&r.body.type===n.DYNAMIC)return r}return!1},d.prototype.visit=function(t,e,i){e.push(t.body);for(var r=t.equations.length,o=0;o!==r;o++){var s=t.equations[o];-1===i.indexOf(s)&&i.push(s)}},d.prototype.bfs=function(t,e,i){var r=this.queue;for(r.length=0,r.push(t),t.visited=!0,this.visit(t,e,i);r.length;)for(var o,s=r.pop();o=d.getUnvisitedNode(s.neighbors);)o.visited=!0,this.visit(o,e,i),o.body.type===n.DYNAMIC&&r.push(o)},d.prototype.split=function(t){for(var e=t.bodies,i=this.nodes,r=this.equations;i.length;)this.nodePool.release(i.pop());for(var o=0;o!==e.length;o++){var s=this.nodePool.get();s.body=e[o],i.push(s)}for(var n=0;n!==r.length;n++){var a=r[n],l=(o=e.indexOf(a.bodyA),e.indexOf(a.bodyB)),p=i[o],h=i[l];p.neighbors.push(h),h.neighbors.push(p),p.equations.push(a),h.equations.push(a)}var c,u=this.islands;for(o=0;o<u.length;o++)this.islandPool.release(u[o]);for(u.length=0;c=d.getUnvisitedNode(i);){var f=this.islandPool.get();this.bfs(c,f.bodies,f.equations),u.push(f)}return u}},{"../math/vec2":32,"../objects/Body":33,"./../utils/IslandNodePool":52,"./../utils/IslandPool":53,"./Island":60,"./IslandNode":62}],62:[function(t,e,i){"use strict";function r(t){this.body=t,this.neighbors=[],this.equations=[],this.visited=!1}(e.exports=r).prototype.reset=function(){this.equations.length=0,this.neighbors.length=0,this.visited=!1,this.body=null}},{}],63:[function(t,e,i){"use strict";var r=t("../solver/GSSolver"),U=(t("../solver/Solver"),t("../collision/Ray"),t("../math/vec2")),v=t("../shapes/Circle"),m=t("../shapes/Convex"),b=(t("../shapes/Line"),t("../shapes/Plane")),S=t("../shapes/Capsule"),x=t("../shapes/Particle"),o=t("../events/EventEmitter"),j=t("../objects/Body"),s=(t("../shapes/Shape"),t("../objects/LinearSpring"),t("../material/Material")),n=t("../material/ContactMaterial"),a=(t("../constraints/DistanceConstraint"),t("../constraints/Constraint"),t("../constraints/LockConstraint"),t("../constraints/RevoluteConstraint"),t("../constraints/PrismaticConstraint"),t("../constraints/GearConstraint"),t("../../package.json"),t("../collision/Broadphase"),t("../collision/AABB")),l=t("../collision/SAPBroadphase"),p=t("../collision/Narrowphase"),G=t("../utils/Utils"),h=t("../utils/OverlapKeeper"),c=t("./IslandManager");t("../objects/RotationalSpring");function W(t){o.apply(this),t=t||{},this.springs=[],this.bodies=[],this.disabledBodyCollisionPairs=[],this.solver=t.solver||new r,this.narrowphase=new p(this),this.islandManager=new c,this.gravity=U.fromValues(0,-9.78),t.gravity&&U.copy(this.gravity,t.gravity),this.frictionGravity=U.length(this.gravity)||10,this.useWorldGravityAsFrictionGravity=!0,this.useFrictionGravityOnZeroGravity=!0,this.broadphase=t.broadphase||new l,this.broadphase.setWorld(this),this.constraints=[],this.defaultMaterial=new s,this.defaultContactMaterial=new n(this.defaultMaterial,this.defaultMaterial),this.lastTimeStep=1/60,this.applySpringForces=!0,this.applyDamping=!0,this.applyGravity=!0,this.solveConstraints=!0,this.contactMaterials=[],this.time=0,this.accumulator=0,this.stepping=!1,this.bodiesToBeRemoved=[],this.islandSplit=void 0===t.islandSplit||!!t.islandSplit,this.emitImpactEvent=!0,this._constraintIdCounter=0,this._bodyIdCounter=0,this.postStepEvent={type:"postStep"},this.addBodyEvent={type:"addBody",body:null},this.removeBodyEvent={type:"removeBody",body:null},this.addSpringEvent={type:"addSpring",spring:null},this.impactEvent={type:"impact",bodyA:null,bodyB:null,shapeA:null,shapeB:null,contactEquation:null},this.postBroadphaseEvent={type:"postBroadphase",pairs:null},this.sleepMode=W.NO_SLEEPING,this.beginContactEvent={type:"beginContact",shapeA:null,shapeB:null,bodyA:null,bodyB:null,contactEquations:[]},this.endContactEvent={type:"endContact",shapeA:null,shapeB:null,bodyA:null,bodyB:null},this.preSolveEvent={type:"preSolve",contactEquations:null,frictionEquations:null},this.overlappingShapesLastState={keys:[]},this.overlappingShapesCurrentState={keys:[]},this.overlapKeeper=new h}(((e.exports=W).prototype=new Object(o.prototype)).constructor=W).NO_SLEEPING=1,W.BODY_SLEEPING=2,W.ISLAND_SLEEPING=4,W.prototype.addConstraint=function(t){this.constraints.push(t)},W.prototype.addContactMaterial=function(t){this.contactMaterials.push(t)},W.prototype.removeContactMaterial=function(t){var e=this.contactMaterials.indexOf(t);-1!==e&&G.splice(this.contactMaterials,e,1)},W.prototype.getContactMaterial=function(t,e){for(var i=this.contactMaterials,r=0,o=i.length;r!==o;r++){var s=i[r];if(s.materialA.id===t.id&&s.materialB.id===e.id||s.materialA.id===e.id&&s.materialB.id===t.id)return s}return!1},W.prototype.removeConstraint=function(t){var e=this.constraints.indexOf(t);-1!==e&&G.splice(this.constraints,e,1)};U.create(),U.create(),U.create(),U.create(),U.create(),U.create();var z=U.create(),D=U.fromValues(0,0),B=U.fromValues(0,0);U.fromValues(0,0),U.fromValues(0,0);W.prototype.step=function(t,e,i){if(i=i||10,0===(e=e||0))this.internalStep(t),this.time+=t;else{this.accumulator+=e;for(var r=0;this.accumulator>=t&&r<i;)this.internalStep(t),this.time+=t,this.accumulator-=t,r++;for(var o=this.accumulator%t/t,s=0;s!==this.bodies.length;s++){var n=this.bodies[s];U.lerp(n.interpolatedPosition,n.previousPosition,n.position,o),n.interpolatedAngle=n.previousAngle+o*(n.angle-n.previousAngle)}}};var Q=[];W.prototype.internalStep=function(t){this.stepping=!0;var e=this.springs.length,i=this.springs,r=this.bodies,o=this.gravity,s=this.solver,n=this.bodies.length,a=this.broadphase,l=this.narrowphase,p=this.constraints,h=z,c=(U.scale,U.add),u=(U.rotate,this.islandManager);if(this.overlapKeeper.tick(),this.lastTimeStep=t,this.useWorldGravityAsFrictionGravity){var f=U.length(this.gravity);0===f&&this.useFrictionGravityOnZeroGravity||(this.frictionGravity=f)}if(this.applyGravity)for(var d=0;d!==n;d++){var y=(g=r[d]).force;g.type===j.DYNAMIC&&g.sleepState!==j.SLEEPING&&(U.scale(h,o,g.mass*g.gravityScale),c(y,y,h))}if(this.applySpringForces)for(d=0;d!==e;d++){i[d].applyForce()}if(this.applyDamping)for(d=0;d!==n;d++){var g;(g=r[d]).type===j.DYNAMIC&&g.applyDamping(t)}var v=a.getCollisionPairs(this),m=this.disabledBodyCollisionPairs;for(d=m.length-2;0<=d;d-=2)for(var b=v.length-2;0<=b;b-=2)(m[d]===v[b]&&m[d+1]===v[b+1]||m[d+1]===v[b]&&m[d]===v[b+1])&&v.splice(b,2);var S=p.length;for(d=0;d!==S;d++){var x=p[d];if(!x.collideConnected)for(b=v.length-2;0<=b;b-=2)(x.bodyA===v[b]&&x.bodyB===v[b+1]||x.bodyB===v[b]&&x.bodyA===v[b+1])&&v.splice(b,2)}this.postBroadphaseEvent.pairs=v,this.emit(this.postBroadphaseEvent),this.postBroadphaseEvent.pairs=null,l.reset(this);d=0;for(var R=v.length;d!==R;d+=2)for(var A=v[d],D=v[d+1],B=0,$=A.shapes.length;B!==$;B++)for(var w=A.shapes[B],E=w.position,C=w.angle,L=0,T=D.shapes.length;L!==T;L++){var P=D.shapes[L],_=P.position,I=P.angle,X=this.defaultContactMaterial;if(w.material&&P.material){var V=this.getContactMaterial(w.material,P.material);V&&(X=V)}this.runNarrowphase(l,A,w,E,C,D,P,_,I,X,this.frictionGravity)}for(d=0;d!==n;d++){(q=r[d])._wakeUpAfterNarrowphase&&(q.wakeUp(),q._wakeUpAfterNarrowphase=!1)}if(this.has("endContact")){this.overlapKeeper.getEndOverlaps(Q);var O=this.endContactEvent;for(L=Q.length;L--;){var Y=Q[L];O.shapeA=Y.shapeA,O.shapeB=Y.shapeB,O.bodyA=Y.bodyA,O.bodyB=Y.bodyB,this.emit(O)}Q.length=0}var H=this.preSolveEvent;H.contactEquations=l.contactEquations,H.frictionEquations=l.frictionEquations,this.emit(H),H.contactEquations=H.frictionEquations=null;S=p.length;for(d=0;d!==S;d++)p[d].update();if(l.contactEquations.length||l.frictionEquations.length||S)if(this.islandSplit){for(u.equations.length=0,G.appendArray(u.equations,l.contactEquations),G.appendArray(u.equations,l.frictionEquations),d=0;d!==S;d++)G.appendArray(u.equations,p[d].equations);u.split(this);for(d=0;d!==u.islands.length;d++){(F=u.islands[d]).equations.length&&s.solveIsland(t,F)}}else{for(s.addEquations(l.contactEquations),s.addEquations(l.frictionEquations),d=0;d!==S;d++)s.addEquations(p[d].equations);this.solveConstraints&&s.solve(t,this),s.removeAllEquations()}for(d=0;d!==n;d++){var q;(q=r[d]).integrate(t)}for(d=0;d!==n;d++)r[d].setZeroForce();if(this.emitImpactEvent&&this.has("impact")){var k=this.impactEvent;for(d=0;d!==l.contactEquations.length;d++){var M=l.contactEquations[d];M.firstImpact&&(k.bodyA=M.bodyA,k.bodyB=M.bodyB,k.shapeA=M.shapeA,k.shapeB=M.shapeB,k.contactEquation=M,this.emit(k))}}if(this.sleepMode===W.BODY_SLEEPING)for(d=0;d!==n;d++)r[d].sleepTick(this.time,!1,t);else if(this.sleepMode===W.ISLAND_SLEEPING&&this.islandSplit){for(d=0;d!==n;d++)r[d].sleepTick(this.time,!0,t);for(d=0;d<this.islandManager.islands.length;d++){var F;(F=this.islandManager.islands[d]).wantsToSleep()&&F.sleep()}}this.stepping=!1;var N=this.bodiesToBeRemoved;for(d=0;d!==N.length;d++)this.removeBody(N[d]);N.length=0,this.emit(this.postStepEvent)},W.prototype.runNarrowphase=function(t,e,i,r,o,s,n,a,l,p,h){if(0!=(i.collisionGroup&n.collisionMask)&&0!=(n.collisionGroup&i.collisionMask)){U.rotate(D,r,e.angle),U.rotate(B,a,s.angle),U.add(D,D,e.position),U.add(B,B,s.position);var c,u=o+e.angle,f=l+s.angle;t.enableFriction=0<p.friction,t.frictionCoefficient=p.friction,c=e.type===j.STATIC||e.type===j.KINEMATIC?s.mass:s.type===j.STATIC||s.type===j.KINEMATIC?e.mass:e.mass*s.mass/(e.mass+s.mass),t.slipForce=p.friction*h*c,t.restitution=p.restitution,t.surfaceVelocity=p.surfaceVelocity,t.frictionStiffness=p.frictionStiffness,t.frictionRelaxation=p.frictionRelaxation,t.stiffness=p.stiffness,t.relaxation=p.relaxation,t.contactSkinSize=p.contactSkinSize,t.enabledEquations=e.collisionResponse&&s.collisionResponse&&i.collisionResponse&&n.collisionResponse;var d=t[i.type|n.type],y=0;if(d){var g=i.sensor||n.sensor,v=t.frictionEquations.length;y=i.type<n.type?d.call(t,e,i,D,u,s,n,B,f,g):d.call(t,s,n,B,f,e,i,D,u,g);var m=t.frictionEquations.length-v;if(y){if(e.allowSleep&&e.type===j.DYNAMIC&&e.sleepState===j.SLEEPING&&s.sleepState===j.AWAKE&&s.type!==j.STATIC){var b=U.squaredLength(s.velocity)+Math.pow(s.angularVelocity,2);2*Math.pow(s.sleepSpeedLimit,2)<=b&&(e._wakeUpAfterNarrowphase=!0)}if(s.allowSleep&&s.type===j.DYNAMIC&&s.sleepState===j.SLEEPING&&e.sleepState===j.AWAKE&&e.type!==j.STATIC){var S=U.squaredLength(e.velocity)+Math.pow(e.angularVelocity,2);2*Math.pow(e.sleepSpeedLimit,2)<=S&&(s._wakeUpAfterNarrowphase=!0)}if(this.overlapKeeper.setOverlapping(e,i,s,n),this.has("beginContact")&&this.overlapKeeper.isNewOverlap(i,n)){var x=this.beginContactEvent;if(x.shapeA=i,x.shapeB=n,x.bodyA=e,x.bodyB=s,x.contactEquations.length=0,"number"==typeof y)for(var R=t.contactEquations.length-y;R<t.contactEquations.length;R++)x.contactEquations.push(t.contactEquations[R]);this.emit(x)}if("number"==typeof y&&1<m)for(R=t.frictionEquations.length-m;R<t.frictionEquations.length;R++){var A=t.frictionEquations[R];A.setSlipForce(A.getSlipForce()/m)}}}}},W.prototype.addSpring=function(t){this.springs.push(t);var e=this.addSpringEvent;e.spring=t,this.emit(e),e.spring=null},W.prototype.removeSpring=function(t){var e=this.springs.indexOf(t);-1!==e&&G.splice(this.springs,e,1)},W.prototype.addBody=function(t){if(-1===this.bodies.indexOf(t)){this.bodies.push(t);var e=(t.world=this).addBodyEvent;e.body=t,this.emit(e),e.body=null}},W.prototype.removeBody=function(t){if(this.stepping)this.bodiesToBeRemoved.push(t);else{t.world=null;var e=this.bodies.indexOf(t);-1!==e&&(G.splice(this.bodies,e,1),(this.removeBodyEvent.body=t).resetConstraintVelocity(),this.emit(this.removeBodyEvent),this.removeBodyEvent.body=null)}},W.prototype.getBodyById=function(t){for(var e=this.bodies,i=0;i<e.length;i++){var r=e[i];if(r.id===t)return r}return!1},W.prototype.disableBodyCollision=function(t,e){this.disabledBodyCollisionPairs.push(t,e)},W.prototype.enableBodyCollision=function(t,e){for(var i=this.disabledBodyCollisionPairs,r=0;r<i.length;r+=2)if(i[r]===t&&i[r+1]===e||i[r+1]===t&&i[r]===e)return void i.splice(r,2)},W.prototype.clear=function(){this.time=0,this.solver&&this.solver.equations.length&&this.solver.removeAllEquations();for(var t=this.constraints,e=t.length-1;0<=e;e--)this.removeConstraint(t[e]);var i=this.bodies;for(e=i.length-1;0<=e;e--)this.removeBody(i[e]);var r=this.springs;for(e=r.length-1;0<=e;e--)this.removeSpring(r[e]);var o=this.contactMaterials;for(e=o.length-1;0<=e;e--)this.removeContactMaterial(o[e]);W.apply(this)};var R=U.create(),A=(U.fromValues(0,0),U.fromValues(0,0));W.prototype.hitTest=function(t,e,i){i=i||0;var r=new j({position:t}),o=new x,s=t,n=R,a=A;r.addShape(o);for(var l=this.narrowphase,p=[],h=0,c=e.length;h!==c;h++)for(var u=e[h],f=0,d=u.shapes.length;f!==d;f++){var y=u.shapes[f];U.rotate(n,y.position,u.angle),U.add(n,n,u.position);var g=y.angle+u.angle;(y instanceof v&&l.circleParticle(u,y,n,g,r,o,s,0,!0)||y instanceof m&&l.particleConvex(r,o,s,0,u,y,n,g,!0)||y instanceof b&&l.particlePlane(r,o,s,0,u,y,n,g,!0)||y instanceof S&&l.particleCapsule(r,o,s,0,u,y,n,g,!0)||y instanceof x&&U.squaredLength(U.sub(a,n,t))<i*i)&&p.push(u)}return p},W.prototype.setGlobalStiffness=function(t){for(var e=this.constraints,i=0;i!==e.length;i++)for(var r=e[i],o=0;o!==r.equations.length;o++){var s=r.equations[o];s.stiffness=t,s.needsUpdate=!0}var n=this.contactMaterials;for(i=0;i!==n.length;i++){(r=n[i]).stiffness=r.frictionStiffness=t}(r=this.defaultContactMaterial).stiffness=r.frictionStiffness=t},W.prototype.setGlobalRelaxation=function(t){for(var e=0;e!==this.constraints.length;e++)for(var i=this.constraints[e],r=0;r!==i.equations.length;r++){var o=i.equations[r];o.relaxation=t,o.needsUpdate=!0}for(e=0;e!==this.contactMaterials.length;e++){(i=this.contactMaterials[e]).relaxation=i.frictionRelaxation=t}(i=this.defaultContactMaterial).relaxation=i.frictionRelaxation=t};var u=new a,f=[];W.prototype.raycast=function(t,e){return e.getAABB(u),this.broadphase.aabbQuery(this,u,f),e.intersectBodies(t,f),f.length=0,t.hasHit()}},{"../../package.json":8,"../collision/AABB":9,"../collision/Broadphase":10,"../collision/Narrowphase":12,"../collision/Ray":13,"../collision/SAPBroadphase":15,"../constraints/Constraint":16,"../constraints/DistanceConstraint":17,"../constraints/GearConstraint":18,"../constraints/LockConstraint":19,"../constraints/PrismaticConstraint":20,"../constraints/RevoluteConstraint":21,"../events/EventEmitter":28,"../material/ContactMaterial":29,"../material/Material":30,"../math/vec2":32,"../objects/Body":33,"../objects/LinearSpring":34,"../objects/RotationalSpring":35,"../shapes/Capsule":40,"../shapes/Circle":41,"../shapes/Convex":42,"../shapes/Line":44,"../shapes/Particle":45,"../shapes/Plane":46,"../shapes/Shape":47,"../solver/GSSolver":48,"../solver/Solver":49,"../utils/OverlapKeeper":54,"../utils/Utils":59,"./IslandManager":61}],64:[function(t,e,i){"use strict";var n=/rgba?\(\s*([.0-9]+)\s*,\s*([.0-9]+)\s*,\s*([.0-9]+)\s*,?\s*([.0-9]+)?\s*\)/;function r(){this.r=0,this.g=0,this.b=0,this.a=void 0,this.string=""}(e.exports=r).prototype._setRGB=function(t,e,i){this.r=t,this.g=e,this.b=i},r.prototype.fromPixel=function(t,e){var i=t[e+0],r=t[e+1],o=t[e+2];return this.string="rgb("+i+","+r+","+o+")",this._setRGB(i,r,o),this},r.prototype.fromString=function(t){var e,i,r,o=(this.string=t).match(n);if(o)e=~~o[1],i=~~o[2],r=~~o[3],this._setRGB(e,i,r);else{var s="0x"+t.slice(1).replace(t.length<5&&/./g,"$&$&");this._setRGB(s>>16,s>>8&255,255&s)}return this},r.prototype.fromRGB=function(t,e,i){return this._setRGB(t,e,i),this.string="rgb("+t+","+e+","+i+")",this},r.prototype.fromColor=function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this.string=t.string,this}},{}],65:[function(t,e,i){"use strict";var r=t("./index"),o=t("../domUtils/createCanvas"),p=8,h=8,y=Math.PI/2;r.setTileSize=function(t,e){p=~~t,h=~~e},r.prototype._init=function(){this.canvas=o(this.width,this.height),this.ctx=this.canvas.getContext("2d"),this.ctx.fillStyle=this.palette[0].string,this.ctx.strokeStyle=this.palette[1].string,this.resize(this.width,this.height)},r.prototype.resize=function(t,e){return this.canvas.width=this.width=t,this.canvas.height=this.height=e,this.clear(),this},r.prototype.sprite=function(t,e,i,r,o,s){var n=p*(t%16),a=h*~~(t/16),l=this.ctx;return e=e||0,i=i||0,e=~~Math.round(e-this.camera.x),i=~~Math.round(i-this.camera.y),r||o||s?(l.save(),r&&(l.scale(-1,1),e=-e-p),o&&(l.scale(1,-1),i=-i-h),s?(l.translate(e+h,i),l.rotate(y)):l.translate(e,i),l.drawImage(this.tilesheet,this.ox+n,this.oy+a,p,h,0,0,p,h),l.restore()):l.drawImage(this.tilesheet,this.ox+n,this.oy+a,p,h,e,i,p,h),this},r.prototype.draw=function(t,e,i,r,o,s){var n=r||o||s;if(t._isSprite){var a=t;t=a.img;var l=a.x,p=a.y,h=a.width,c=a.height,u=~~Math.round((e||0)-this.camera.x),f=~~Math.round((i||0)-this.camera.y);return n?((d=this.ctx).save(),s?(r&&(d.scale(-1,1),u*=-1,u-=c),o&&(d.scale(1,-1),f*=-1,f-=h),d.translate(u+c,f),d.rotate(y)):(r&&(d.scale(-1,1),u*=-1,u-=h),o&&(d.scale(1,-1),f*=-1,f-=c),d.translate(u,f)),d.drawImage(t,l,p,h,c,0,0,h,c),d.restore(),this):(this.ctx.drawImage(t,l,p,h,c,u,f,h,c),this)}t._isTileMap&&(t.texture||t._prepareTexture(),t=t.texture.canvas),t._isTexture&&(t=t.canvas);var d;u=~~Math.round((e||0)-this.camera.x),f=~~Math.round((i||0)-this.camera.y);return n?((d=this.ctx).save(),s?(r&&(d.scale(-1,1),u*=-1,u-=t.height),o&&(d.scale(1,-1),f*=-1,f-=t.width),d.translate(u+t.height,f),d.rotate(y)):(r&&(d.scale(-1,1),u*=-1,u-=t.width),o&&(d.scale(1,-1),f*=-1,f-=t.height),d.translate(u,f)),d.drawImage(t,0,0),d.restore()):this.ctx.drawImage(t,u,f),this},r.prototype.clear=function(){return this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this},r.prototype.cls=function(){return this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this},r.prototype.pen=function(t){return this._pen=t%this.palette.length,this.ctx.strokeStyle=this.palette[this._pen].string,this},r.prototype.paper=function(t){return this._paper=t%this.palette.length,this.ctx.fillStyle=this.palette[this._paper].string,this},r.prototype.rect=function(t,e,i,r){if(i<=1||r<=1){var o=this.ctx.fillStyle;return this.ctx.fillStyle=this.ctx.strokeStyle,this.ctx.fillRect(~~(t-this.camera.x),~~(e-this.camera.y),~~i,~~r),this.ctx.fillStyle=o,this}return this.ctx.strokeRect(.5+~~(t-this.camera.x),.5+~~(e-this.camera.y),~~(i-1),~~(r-1)),this},r.prototype.rectf=function(t,e,i,r){return this.ctx.fillRect(~~(t-this.camera.x),~~(e-this.camera.y),~~i,~~r),this},r.prototype.rectfill=r.prototype.rectf,r.prototype._isTexture=!0,r.prototype.tilesheet=o(16*p,16*h)},{"../domUtils/createCanvas":72,"./index":66}],66:[function(t,e,i){"use strict";function r(t,e){this.width=t,this.height=e,this.camera={x:0,y:0},this._cursor={i:0,j:0},this._paper=0,this._pen=1,this._init()}function o(t,e){t.ox=0,t.oy=0,e._isImageWrapper&&(e=e.asset),e._isSprite?(t.ox=e.x,t.oy=e.y,t.tilesheet=e.img):e._isMap?(e.texture||e._prepareTexture(),t.tilesheet=e.texture.canvas):e._isTexture?t.tilesheet=e.canvas:(e instanceof Image||e instanceof HTMLCanvasElement)&&(t.tilesheet=e)}(e.exports=r).prototype.palette=[{string:"#000000",r:0,g:0,b:0},{string:"#FFFFFF",r:1,g:1,b:1}],r.prototype.ox=0,r.prototype.oy=0,r.setTileSize=function(){},r.prototype.setPalette=function(t){r.prototype.palette=t},r.prototype.setGlobalTilesheet=function(t){o(r.prototype,t)},r.prototype.setTilesheet=function(t){if(t)return o(this,t),this;delete this.tilesheet},r.prototype.setCamera=function(t,e){return this.camera.x=t||0,this.camera.y=e||0,this}},{}],67:[function(t,e,i){"use strict";var p=t("../domUtils/createCanvas"),h=[0,8338,45,11962,5588,21157,29354,10,17556,5265,21973,1488,5312,448,13824,5268,31599,29843,29671,31143,18925,31183,31689,18735,31727,18927,1040,5136,17492,3640,5393,8359,25450,23530,31467,25166,15211,29391,4815,27470,23533,29847,15142,23277,29257,23421,23403,11114,4843,26474,23279,14798,9367,27501,12141,24429,23213,14829,29351,25750,17553,13459,9402,28672,34,23530,31467,25166,15211,29391,4815,27470,23533,29847,15142,23277,29257,23421,23403,11114,4843,26474,23279,14798,9367,27501,12141,24429,23213,14829,29351,25686,9362,13587,42,21845];e.exports=function(){var t=p(64,36),e=t.getContext("2d");e.fillStyle="#FFF";for(var i=0;i<h.length;i++)for(var r=h[i],o=i%16,s=~~(i/16),n=0;n<15;n++){var a=n%3,l=~~(n/3);1==(r>>n&1)&&e.fillRect(4*o+a,6*s+l,1,1)}return t}},{"../domUtils/createCanvas":72}],68:[function(t,e,i){"use strict";function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var s=t("./index.js"),r=t("./minitext"),f=4,d=6;function o(t){if(!t._isTexture){var e=new s(t.width,t.height);e.draw(t,0,0),t=e}this.template=t,this.colors={}}o.prototype.getColor=function(t){if(this.colors[t])return this.colors[t];var e=this.template.width,i=this.template.height,r=new s(e,i);r.clear(),r.ctx.fillStyle=t,r.ctx.fillRect(0,0,e,i),r.ctx.globalCompositeOperation="destination-in",r.ctx.drawImage(this.template.canvas,0,0);var o=r.canvas;return this.colors[t]=o};var n=s.prototype.resize;s.prototype.resize=function(t,e){return this._cursor.i=0,this._cursor.j=0,n.call(this,t,e),this},s.prototype.cls=function(){return this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.locate(0,0),this};var a=new o(r()),y=a;s.prototype.locate=function(t,e){return this._cursor.i=~~t,this._cursor.j=~~e,this},s.prototype.print=function(e,t,i){if("object"===u(e))try{e=JSON.stringify(e)}catch(t){e="[Object]"}else"string"!=typeof e&&(e=e.toString());var r=this.palette[this._pen].string,o=y.getColor(r);if(void 0!==t){t=~~Math.round(t-this.camera.x),i=~~Math.round(i-this.camera.y);for(var s=t,n=0;n<e.length;n++){if(10!==(c=e.charCodeAt(n))&&13!==c)if((c-=32)<0||255<c)t+=f;else{var a=f*(c%16),l=d*~~(c/16);this.ctx.drawImage(o,a,l,f,d,t,i,f,d),t+=f}else i+=d,t=s}return this}n=this._cursor.i;for(var p=this._cursor.j,h=0;h<e.length;h++){var c;if(this.width-n*f<f&&(n=0,p+=1),this.height-p*d<d&&(this.textScroll(),--p),10!==(c=e.charCodeAt(h))&&13!==c)if((c-=32)<0||255<c)n+=1;else{a=f*(c%16),l=d*~~(c/16);this.ctx.drawImage(o,a,l,f,d,n*f,p*d,f,d),n+=1}else n=0,p+=1}return this._cursor.i=n,this._cursor.j=p,this},s.prototype.println=function(t){return this.print(t),this.print("\n"),this},s.prototype.textScroll=function(t){return void 0===t&&(t=1),this._cursor.j-=t,t*=d,this.ctx.drawImage(this.canvas,0,-t),this.ctx.fillRect(0,this.canvas.height-t,this.canvas.width,t),this};var l=new WeakMap;s.prototype.setCharset=function(t){var e=this._cursor.i*f,i=this._cursor.j*d;t?(f=~~(t.width/16),d=~~(t.height/6),l.has(t)?y=l.get(t):(y=new o(t),l.set(t,y))):(y=a,f=4,d=6),this._cursor.i=Math.ceil(e/f),this._cursor.j=Math.ceil(i/d)}},{"./index.js":66,"./minitext":67}],69:[function(t,e,i){"use strict";var r=t("../Texture"),o=t(".."),p=8,h=8;function c(t,e,i,r,o,s,n,a){this.x=~~t,this.y=~~e,this.sprite=~~i,this.flipH=!!r,this.flipV=!!o,this.flipR=!!s,this.flagA=!!n,this.flagB=!!a}function s(t,e){this._name="",this.width=0,this.height=0,this.items=[],this.texture=null,this.tilesheet=null,this._tilesheetPath="",t&&e&&this._init(t,e)}(e.exports=s).prototype._isTileMap=!0;var a,f,n={},l=[];s.getMap=function(t){return"string"==typeof t?n[t]:"number"==typeof t?l[t]:(console.error("Map does not exist",t),null)},s._checkBankFormat=function(t){return t?Array.isArray(t)?{_type:"maps",maps:t}:"maps"!==t._type?(console.warn("Map bank format incorrect"),{_type:"maps",maps:[]}):t:{_type:"maps",maps:[]}},s.loadBank=function(t){t=s._checkBankFormat(t),n={},l=[];for(var e=t.maps||[],i=0;i<e.length;i++)l.push((new s).load(e[i]))},s.setTileSize=function(t,e){p=~~t,h=~~e},Object.defineProperty(s.prototype,"name",{get:function(){return this._name},set:function(t){this._name&&n[this._name]&&n[this._name]===this&&delete n[this._name],(this._name=t)&&!n[t]&&(n[t]=this)}}),s.prototype._init=function(t,e){this.width=t,this.height=e,this.items=[];for(var i=0;i<t;i++){this.items.push([]);for(var r=0;r<e;r++)this.items[i][r]=null}this.texture&&this.texture.resize(t*p,e*h)},s.prototype.resize=function(t,e){var i=this.items,r=Math.min(this.width,t),o=Math.min(this.height,e);this._init(t,e);for(var s=0;s<r;s++)for(var n=0;n<o;n++)this.items[s][n]=i[s][n];return this.redraw(),this},s.prototype.set=function(t,e,i,r,o,s,n,a){if(null==i)return this.remove(t,e);if(!(t<0||e<0||t>=this.width||e>=this.height)){var l=this.items[t][e]=new c(t,e,i,r,o,s,n,a);return this.texture&&(this.texture.ctx.clearRect(t*p,e*h,p,h),this.texture.sprite(l.sprite,l.x*p,l.y*h,l.flipH,l.flipV,l.flipR)),this}},s.prototype.remove=function(t,e){if(!(t<0||e<0||t>=this.width||e>=this.height))return this.items[t][e]=null,this.texture&&this.texture.ctx.clearRect(t*p,e*h,p,h),this},s.prototype.get=function(t,e){return t<0||e<0||t>=this.width||e>=this.height?null:this.items[t][e]},s.prototype.redraw=function(){if(!this.texture)return this;this.texture.clear();for(var t=0;t<this.width;t++)for(var e=0;e<this.height;e++){var i=this.items[t][e];i&&this.texture.sprite(i.sprite,i.x*p,i.y*h,i.flipH,i.flipV,i.flipR)}return this},s.prototype._prepareTexture=function(){this.texture=new r(this.width*p,this.height*h),this.texture.setTilesheet(this.tilesheet),this.redraw()},s.prototype.release=function(){this.texture=null},s.prototype.draw=function(t,e){this.texture||this._prepareTexture(),draw(this.texture,t,e)},s.prototype.setTilesheet=function(t){return this.tilesheet=t,this._tilesheetPath=t&&t.path||"",this.texture&&(this.texture.setTilesheet(t),this.redraw()),this},s.prototype._setTilesheetPath=function(t){if(this._tilesheetPath=t||"",!t)return this.setTilesheet();for(var e=t.split("/"),i=o.assets||{},r=0;r<e.length;r++)if(!(i=i[e[r]]))return console.warn("Could not find tilesheet",t);this.setTilesheet(i)},function(){for(var i="#$%&'()*+,-~/0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_`abcdefghijklmnopqrstuvwxyz{|}. !",p={},t=0;t<i.length;t++)p[i[t]]=t;var h=i.length,c=h*h-1,u=Math.pow(2,13),s=c-u-1;function n(t){var e=t%h;return i[~~(t/h)]+i[e]}a=function(t){for(var e="",i=0,r=0;r<t.length;r++){var o=t[r];o===t[r+1]&&++i<s||(null===o&&(o=c),e+=n(o),i===s&&i--,0!==i&&(e+=n(u+i)),i=0)}return i===s&&i--,0!==i&&(e+=n(u+i)),e},f=function(t){for(var e=[],i=0;i<t.length;){var r=t[i++],o=t[i++],s=p[r]*h+p[o];if(s===c)e.push(null);else if(u<s)for(var n=s-u,a=e[e.length-1],l=0;l<n;l++)e.push(a);else e.push(s)}return e}}(),s.prototype.save=function(){for(var t=this.width,e=this.height,i=new Array(t*e),r=0;r<t;r++)for(var o=0;o<e;o++){var s=this.items[r][o];i[r+o*t]=s?s.sprite+(s.flipH<<8)+(s.flipV<<9)+(s.flipR<<10)+(s.flagA<<11)+(s.flagB<<12):null}return{w:t,h:e,name:this.name,sheet:this._tilesheetPath||"",data:a(i)}},s.prototype.load=function(t){this.texture=null;var e=t.w,i=t.h;this._init(e,i),this.name=t.name||"",this._setTilesheetPath(t.sheet);for(var r=f(t.data),o=0;o<e;o++)for(var s=0;s<i;s++){var n=r[o+s*e];if(null!==n){var a=255&n,l=n>>8&1,p=n>>9&1,h=n>>10&1,c=n>>11&1,u=n>>12&1;this.set(o,s,a,l,p,h,c,u)}}return this},s.prototype.copy=function(t,e,i,r){t=t||0,e=e||0,null==i&&(i=this.width),null==r&&(r=this.height);var o=new s(i,r);return o.paste(this,-t,-e),o},s.prototype.paste=function(t,e,i,r){e=e||0,i=i||0;for(var o=Math.min(t.width,this.width-e),s=Math.min(t.height,this.height-i),n=Math.max(0,-e),a=Math.max(0,-i),l=n;l<o;l++)for(var p=a;p<s;p++){var h=t.items[l][p];if(h)this.set(l+e,p+i,h.sprite,h.flipH,h.flipV,h.flipR,h.flagA,h.flagB);else{if(r)continue;this.remove(l+e,p+i)}}return this},s.prototype.clear=function(){for(var t=0;t<this.width;t++)for(var e=0;e<this.height;e++)this.items[t][e]=null;return this.texture&&this.texture.clear(),this},s.prototype.find=function(t,e,i){if(null===t)return this._findNull();void 0===e&&(e=null),void 0===i&&(i=null);for(var r=[],o=0;o<this.width;o++)for(var s=0;s<this.height;s++){var n=this.items[o][s];if(n){var a=null===e||n.flagA===e,l=null===i||n.flagB===i;n.sprite===t&&a&&l&&r.push(n)}}return r},s.prototype._findNull=function(){for(var t=[],e=0;e<this.width;e++)for(var i=0;i<this.height;i++)null===this.items[e][i]&&t.push({x:e,y:i});return t}},{"..":74,"../Texture":66}],70:[function(t,e,i){"use strict";function f(t,e){var i=new Image;i.onload=function(){this.onload=null,this.onerror=null,e&&e(null,this)},i.onerror=function(){this.onload=null,this.onerror=null,e&&e("img:"+t)},i.src=t}function d(t,e){var i=new Audio;function r(){e&&e(null,i),i.removeEventListener("canplaythrough",r),i.removeEventListener("error",o)}function o(){e&&e("snd:load"),i.removeEventListener("canplaythrough",r),i.removeEventListener("error",o)}i.preload=!0,i.loop=!1,i.addEventListener("canplaythrough",r),i.addEventListener("error",o),i.src=t,i.load()}i.loadData=function(t,e,i){var r=new XMLHttpRequest;r.responseType=e||"arraybuffer",r.onreadystatechange=function(){if(4==~~r.readyState)return 200!=~~r.status&&0!=~~r.status?i&&i("xhrError:"+r.status):i&&i(null,r.response)},r.open("GET",t,!0),r.send()},i.loadJson=function(t,e){var i=new XMLHttpRequest;i.onreadystatechange=function(){if(4==~~i.readyState)return 200!=~~i.status?e("xhrError:"+i.status):e&&e(null,JSON.parse(i.response))},i.open("GET",t,!0),i.send()},i.loadImage=f,i.loadSound=d,i.preloadStaticAssets=function(r,o,s){var a=r.dat,n=r.img.length,l=n+r.snd.length,p=r.root,h=0,c=0;function u(){var i,t,e=h+c;s&&s(h,e,l,e/l),t=e<n?(i=r.img[e],f):(i=r.snd[e-n],d),c+=1,t(p+i,function(t,e){t||function(t,e){var i=t.split("/"),r=i.pop().split(".");r.pop(),r=r.join(".");for(var o=a,s=0,n=i.length;s<n;s++)o=o[i[s]];o[r]=e,i.push(r),e.name=r,e.path=i.join("/")}(i,e),(h+=1)+--c<l?u():0===c&&o(null,a)})}if(0===l)return o(null,a);for(var t=Math.min(5,l-1),e=0;e<=t;e++)u()}},{}],71:[function(t,e,i){"use strict";function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var r,o;r=window,o=function(){return r={},o.m=i=[function(t,e,i){var o=i(4);function r(){this.name="",this.speed=20,this.pmin=0,this.pmax=127,this.snap=!1,this.steps=[],this.audio=null}(t.exports=r).prototype.serialize=function(){for(var t="",e=0;e<this.steps.length;e++)t+=this.steps[e].serialize();return{n:this.name,i:[this.speed,this.pmin,this.pmax,~~this.snap],s:t}},r.prototype.deserialize=function(t){this.name=t.n,this.speed=t.i[0],this.pmin=t.i[1],this.pmax=t.i[2],this.snap=!!t.i[3],this.audio=null,this.steps=[];for(var e=t.s,i=0;i<e.length;i+=3){var r=new o;r.deserialize(e,i),this.steps.push(r)}return this},r.prototype.check=function(){11<this.name.length&&(this.name=this.name.substr(0,11)),this.speed=Math.max(0,Math.min(53,~~this.speed)),this.pmin=Math.max(0,Math.min(101,~~this.pmin)),this.pmax=Math.max(26,Math.min(127,~~this.pmax));for(var t=0;t<this.steps.length;t++)this.steps[t].check()}},function(t,e){e.SAMPLE_RATE=44100,e.CHUNK_LENGTH=50},function(t,e,i){var r=i(3),o=i(0),s=new(i(6)),n=audioManager.getEmptySound().__proto__.constructor;if(!n.prototype._createAudioNodes)throw new Error("webAudio required");function a(t){n.call(this),this._data=t}function l(t){var e=new a(t);return t.audio=e}inherits(a,n),a.prototype.load=function(t){if(this._loaded)return t&&t(null,this);t&&this._onLoadQueuedCallback.push(t),this.buffer=s.generateSound(this._data),this.usedMemory=this.buffer.duration,this.audioManager.usedMemory+=this.buffer.duration,this._finalizeLoad(null)},o.prototype.play=function(t,e,i){this.audio?this.audio.play(t,e,i):l(this).play(t,e,i)};var p=new r,h=[];e.loadProgram=function(t){p.deserialize(t),assets.bleeper={};for(var e=h.length=0;e<p.sounds.length;e++){var i=p.sounds[e],r=l(i);h.push(r);var o=i.name;o&&(assets.bleeper[o]=r,audioManager.permanentSounds[o]=r)}return p},e.sounds=h},function(t,e,i){var o=i(0);function r(){this.version=1,this.sounds=[]}(t.exports=r).prototype.serialize=function(){for(var t=[],e=0;e<this.sounds.length;e++)t.push(this.sounds[e].serialize());return{_type:"Bleeper program",v:this.version,s:t}},r.prototype.deserialize=function(t){if("Bleeper program"!==t._type)throw new Error("Incorrect data type");this.version=t.v,this.sounds.length=0;for(var e=t.s,i=0;i<e.length;i++){var r=new o;r.deserialize(e[i]),this.sounds.push(r)}return this},r.prototype.check=function(){if(0!==this.sounds.length)for(var t=0;t<this.sounds.length;t++)this.sounds[t].check();else this.sounds.push(new o)}},function(t,e,i){var o=i(5);function r(){this.wave=0,this.pitch=0,this.volume=0}(t.exports=r).prototype.serialize=function(){var t=this.wave,e=this.pitch;return 92<this.pitch&&(t+=8,e-=92),o.encodeUint6(t)+o.encodeUint6(e)+o.encodeUint6(this.volume)},r.prototype.deserialize=function(t,e){var i=o.decodeUint6(t,e),r=o.decodeUint6(t,e+1);return this.volume=o.decodeUint6(t,e+2),8<=i&&(i-=8,r+=92),this.wave=i,this.pitch=r,this},r.prototype.check=function(){this.wave=Math.max(0,Math.min(7,~~this.wave)),this.pitch=Math.max(0,Math.min(93,~~this.pitch)),this.volume=Math.max(0,Math.min(62,~~this.volume))}},function(t,e){for(var i="#$%&'()*+,-~/0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_`abcdefghijklmnopqrstuvwxyz{|}. !",o=i.length,s={},r=0;r<i.length;r++)s[i[r]]=r;e.encodeUint13=function(t){return i[~~(t/o)]+i[t%o]},e.encodeUint6=function(t){return i[t]},e.decodeUint13=function(t,e){var i=t[e],r=t[e+1];return s[i]*o+s[r]},e.decodeUint6=function(t,e){return s[t[e]]}},function(t,e,i){var p=i(7),r=i(8),o=i(1),h=o.SAMPLE_RATE,c=o.CHUNK_LENGTH;function s(){this.oscillator=new r}(t.exports=s).prototype.generateSound=function(t){var e=t.steps;if(0===e.length)return null;var i=(t.speed+1)*c,r=e.length*i+100,o=p.createBuffer(1,r,h),s=o.getChannelData(0);this.oscillator.reset();for(var n=0,a=0;n<e.length;n++){var l=e[n];this.oscillator.setStep(t,l),this.oscillator.generate(s,a,a+i),a+=i}return this.oscillator.generateEndDamping(s,a,a+100),o}},function(t,e){var i=new window.AudioContext;t.exports=i},function(t,e,i){var r=i(9),o=i(1).SAMPLE_RATE,s=2*Math.PI,n=[0,.12,.25,.37,.5,.62,.75,.87,.87,.75,.62,.5,.37,.25,.12,0,-.12,-.25,-.37,-.5,-.62,-.75,-.87,-1,-1,-.87,-.75,-.62,-.5,-.37,-.25,-.12];function a(){this._amp=1,this._oscPos=0,this._oscInc=0,this._oscState=1,this._oscOut=0,this._duty=0,this._prevOut=0,this.generate=this._generatePulse}(t.exports=a).prototype.reset=function(){this._oscPos=0,this._oscState=1,this._oscOut=0,this._prevOut=0},a.prototype.setStep=function(t,e){var i=t.pmin+(t.pmax-t.pmin-20)*e.pitch/93;switch(i=20+90*i/107,t.snap&&(i=Math.round(i)),this._oscInc=r.noteToFreq(i)/o,this._amp=e.volume/63,e.wave){case 0:this.generate=this._generatePulse,this._duty=.06;break;case 1:this.generate=this._generatePulse,this._duty=.12;break;case 2:this.generate=this._generatePulse,this._duty=.25;break;case 3:this.generate=this._generatePulse,this._duty=.5;break;case 4:this.generate=this._generateTriangle;break;case 5:this.generate=this._generateSine;break;case 6:this.generate=this._generateSaw,this._amp*=2;break;case 7:this.generate=this._generateNoise,this._oscInc=2.9*this._oscInc+.01}},a.prototype._generatePulse=function(t,e,i){for(var r=this._prevOut,o=e;o<i;o++)this._oscPos+=this._oscInc,1<this._oscPos&&(this._oscPos=this._oscPos%1),r=this._oscPos>this._duty?this._amp:-this._amp,t[o]=r;this._prevOut=r},a.prototype._generateTriangle=function(t,e,i){for(var r=this._prevOut,o=e;o<i;o++)this._oscPos+=this._oscInc,1<this._oscPos&&(this._oscPos=this._oscPos%1),r=n[~~(32*this._oscPos)]*this._amp,t[o]=r;this._prevOut=r},a.prototype._generateSine=function(t,e,i){for(var r=this._prevOut,o=e;o<i;o++)this._oscPos+=this._oscInc,1<this._oscPos&&(this._oscPos=this._oscPos%1),r=Math.sin(this._oscPos*s)*this._amp,t[o]=r;this._prevOut=r},a.prototype._generateSaw=function(t,e,i){for(var r=this._prevOut,o=e;o<i;o++)this._oscPos+=this._oscInc,1<this._oscPos&&(this._oscPos=this._oscPos%1),r=(this._oscPos-.5)*this._amp,t[o]=r;this._prevOut=r},a.prototype._generateNoise=function(t,e,i){for(var r=this._prevOut,o=e;o<i;o++){if(this._oscPos+=this._oscInc,1<this._oscPos){this._oscPos=this._oscPos%1;var s=!(16384&this._oscState)^!(8192&this._oscState);this._oscState=32767&(this._oscState<<1|s),this._oscOut=(16384&this._oscState)>>14}r=(this._oscOut-.5)*this._amp,t[o]=r}this._prevOut=r},a.prototype.generateEndDamping=function(t,e,i){for(var r=this._prevOut,o=e;o<i;o++)r*=.98,t[o]=r}},function(t,e){for(var o=[],i=0;i<128;i++)o.push(440*Math.pow(2,(i-69)/12));e.noteToFreqTable=o,e.noteToFreq=function(t){t<0&&(t=0),127<t&&(t=127);var e=~~t,i=t-e,r=o[e];return r+i*(o[1+e]-r)}}],o.c=r,o.d=function(t,e,i){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==s(e)&&e&&e.__esModule)return e;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(i,r,function(t){return e[t]}.bind(null,r));return i},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=2);function o(t){if(r[t])return r[t].exports;var e=r[t]={i:t,l:!1,exports:{}};return i[t].call(e.exports,e,e.exports,o),e.l=!0,e.exports}var i,r},"object"==(void 0===i?"undefined":s(i))&&"object"==(void 0===e?"undefined":s(e))?e.exports=o():"function"==typeof define&&define.amd?define([],o):"object"==(void 0===i?"undefined":s(i))?i.bleeper=o():r.bleeper=o()},{}],72:[function(t,e,i){"use strict";e.exports=function(t,e){var i=document.createElement("canvas");return i.width=t,i.height=e,i}},{}],73:[function(t,e,i){"use strict";var c=["A","B","X","Y","lb","rb","lt","rt","back","start","lp","rp","up","down","left","right"],r=!(!navigator||!navigator.getGamepads),u=!1,f=.2;function o(){this.available=!1,this.btn={},this.btnp={},this.btnr={},this.x=0,this.y=0,this.z=0,this.w=0,this.lt=0,this.rt=0,this._setupButtons()}o.prototype._setupButtons=function(){for(var t=0;t<c.length;t++){var e=c[t];this.btn[e]=!1,this.btnp[e]=!1,this.btnr[e]=!1}};var d=[new o,new o,new o,new o,window],s=new o;var n=r?function(){for(var t=navigator.getGamepads(),e=0;e<4;e++){var i=t[e],r=d[e];if(i){var o,s,n,a;r.available=!0,u&&(o=r.btn.right,s=r.btn.left,a=r.btn.down,n=r.btn.up);for(var l=0;l<c.length;l++){var p=c[l],h=i.buttons[l].pressed;r.btnp[p]=!r.btn[p]&&h,r.btnr[p]=r.btn[p]&&!h,r.btn[p]=h}r.x=i.axes[0],r.y=i.axes[1],r.z=i.axes[2],r.w=i.axes[3],r.lt=i.buttons[6].value,r.rt=i.buttons[7].value,u&&(r.btn.right=r.btn.right||r.x>f,r.btn.left=r.btn.left||r.x<-f,r.btn.down=r.btn.down||r.y>f,r.btn.up=r.btn.up||r.y<-f,r.btnp.right=r.btn.right&&!o,r.btnp.left=r.btn.left&&!s,r.btnp.down=r.btn.down&&!a,r.btnp.up=r.btn.up&&!n,r.btnr.right=!r.btn.right&&o,r.btnr.left=!r.btn.left&&s,r.btnr.down=!r.btn.down&&a,r.btnr.up=!r.btn.up&&n)}else r.available=!1}return d}:function(){return d};i.mapAnalogStickToDpad=function(t){u=!0,f=void 0===t?.3:t},i.update=function(){window.gamepads=n(),window.gamepad=function(){for(var t=0;t<c.length;t++){var e=c[t];s.btnp[e]=btnp[e]||d[0].btnp[e]||d[1].btnp[e]||d[2].btnp[e]||d[3].btnp[e],s.btnr[e]=btnr[e]||d[0].btnr[e]||d[1].btnr[e]||d[2].btnr[e]||d[3].btnr[e],s.btn[e]=btn[e]||d[0].btn[e]||d[1].btn[e]||d[2].btn[e]||d[3].btn[e]}return s.btn.up&&s.btn.down&&(s.btn.down=!1),s.btn.right&&s.btn.left&&(s.btn.left=!1),s}()}},{}],74:[function(t,e,i){"use strict";e.exports={}},{}],75:[function(t,e,i){"use strict";e.exports=function(t,e){t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}},{}],76:[function(t,e,i){"use strict";var p=null;!function o(s,n,a){function l(e,t){if(!n[e]){if(!s[e]){if(p)return p(e,!0);var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}var r=n[e]={exports:{}};s[e][0].call(r.exports,function(t){return l(s[e][1][t]||t)},r,r.exports,o,s,n,a)}return n[e].exports}for(var p=null,t=0;t<a.length;t++)l(a[t]);return l}({1:[function(t,e,i){e.exports=function(t,e){t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}},{}],2:[function(t,e,i){function r(t){this.color=0,this.steps=[],this.frozen=!1;for(var e=0;e<t;e++){var i=new o(e);this.steps.push(i)}}var o=t("./Step"),s=(e.exports=r).prototype;s.$15=function(){for(var t=null,e=this.steps.length-1;0<=e;e--){var i=this.steps[e];if(i.$1i){var r=new o(i.index);r.note=-1,r.$1g=i.$1i,r.next=t,i.next=r}else i.next=t;i.$26||(t=i)}},s.$14=function(t){this.color=t.c||0;for(var e=t.s,i=0,r=0;r<this.steps.length;r++)i=this.steps[r].$14(e,i);this.$15()}},{"./Step":4}],3:[function(t,e,i){function r(t,e){this.album=t,this.index=e,this.name="untitled",this.author="",this.infos="",this.bpm=130,this.$k=32,this.speed=4,this.groove=[],this.highlight=16,this.loop=0,this.length=0,this.tracks=[],this.effects=[],this.$t=null;for(var i=t.trackCount,r=0;r<i;r++){var o=new s(this,r);this.tracks.push(o)}}var n=t("./Pattern"),s=t("./Track");(e.exports=r).prototype.$14=function(t){this.name=t.n||"",this.author=t.a||"",this.infos=t.i||"",this.bpm=t.b,this.$k=t.l,this.speed=t.s,this.groove=t.g,this.highlight=t.h,this.loop=t.o||0,this.$t=new n(this.$k),this.$t.frozen=!0;for(var e=t.t,i=this.length=0;i<e.length;i++){var r=this.tracks[i];r.$14(e[i]),this.length=Math.max(this.length,r.sequence.length)}var o=t.e||[];this.effects=[];for(i=0;i<4;i++){var s=o[i];s?this.effects.push({id:s.i||0,params:s.p||{}}):this.effects.push(null)}}},{"./Pattern":2,"./Track":5}],4:[function(t,e,i){function l(t,e){return h[t]*a.length+h[e]}function p(t,e,i,r){var o=l(t,e);i["fx"+r]=o%c,i["fv"+r]=~~(o/c)}function r(t,e,i,r){this.id=t,this.value=e,this.x=i,this.y=r}function o(t){this.index=t,this.$26=!0,this.next=null,this.note=null,this.inst=null,this.vol=null,this.fx1=null,this.fx2=null,this.fv1=0,this.fv2=0,this.$2n=[],this.$2o=[],this.$1g=0,this.$1i=0}var s=t("../constants").$1s,n=t("./encoding"),a=n.$1v,h=n.$25,c=n.$i,u=(e.exports=o).prototype;u.$x=function(t,e){if(t!==s.$1c)if(t!==s.$1d){var i=new r(t,e,e>>4,15&e);t===s.$2s?this.$2n.push(i):this.$2o.push(i)}else this.$1i=e/256;else this.$1g=e/256},u.$1e=function(){this.$26=!(null!==this.note||null!==this.inst||null!==this.vol||null!==this.fx1||null!==this.fx2),this.$2n=[],this.$2o=[],this.$1g=0,this.$1i=0,null!==this.fx2&&this.$x(this.fx2,this.fv2),null!==this.fx1&&this.$x(this.fx1,this.fv1)},u.$14=function(t,e){this.note=null,this.inst=null,this.vol=null,this.fx1=null,this.fx2=null;var i=h[t[e++]],r=i>>1&1,o=i>>2&1,s=i>>3&1,n=i>>4&1;if(1&i){var a=i>>5&1;this.note=a?-1:l(t[e++],t[e++])}return r&&(this.inst=h[t[e++]]),o&&(this.vol=h[t[e++]]),s&&p(t[e++],t[e++],this,1),n&&p(t[e++],t[e++],this,2),this.$1e(),e}},{"../constants":13,"./encoding":6}],5:[function(t,e,i){function r(t,e){this.index=e,this.song=t,this.synthId=0,this.patterns=[],this.sequence=[]}var s=t("./Pattern"),o=(e.exports=r).prototype;o.$2=function(t){var e=this.song.length;if(e<=t){var i=this.song.loop;t=(t-i)%(e-i)+i}if(t>this.sequence.length)return this.song.$t;var r=this.sequence[t];return-1===r?this.song.$t:this.patterns[r]},o.$js=function(){return this.song.album.instruments[this.synthId]},o.$14=function(t){this.synthId=t.y||0,this.sequence=t.s,this.patterns=[];for(var e=t.p,i=this.song.$k,r=0;r<e.length;r++){var o=new s(i);o.$14(e[r]),this.patterns.push(o)}}},{"./Pattern":2}],6:[function(t,e,i){for(var r="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ#$%&'()*+,-~/:;<=>?@[]^_`{|}. !",o={},s=0;s<r.length;s++)o[r[s]]=s;i.$1v=r,i.$25=o,i.$i=32},{}],7:[function(t,e,i){function r(){this.version=0,this.trackCount=8,this.instruments={},this.songs=[],this.samples=[],this.path=""}var s=t("./Song");(e.exports=r).prototype.$14=function(t){var e=t.v||0,i=t.s||[];this.version=e,this.trackCount=t.t,this.songs=[],this.instruments=t.i,this.samples=t.a;for(var r=0;r<i.length;r++){var o=new s(this,r);o.$14(i[r]),this.songs.push(o)}}},{"./Song":3}],8:[function(t,e,i){function r(t,e){this.index=t,this.sequencer=e,this.effector=null,this.params=null,this.buffL=new Float32Array(n),this.buffR=new Float32Array(n)}var o=t("../constants"),s=t("../synths").getEffector,n=o.$h,a=(e.exports=r).prototype;a.loadEffect=function(t){if(t){this.effector=s(t.id,this.sequencer);var e=t.params;for(var i in e)this.effector[i]=e[i]}else this.effector=null},a.clearBuffer=function(){if(this.effector)for(var t=0;t<n;t++)this.buffL[t]=0,this.buffR[t]=0},a.process=function(t){this.effector&&this.effector.process(this.buffL,this.buffR,this.sequencer.buffL,this.sequencer.buffR,t)}},{"../constants":13,"../synths":27}],9:[function(t,e,i){function r(t,e){this.index=t,this.sequencer=e,this.muted=!1,this.synth=null,this.data=null,this.$u=0,this.$1w=null,this.$1f=0,this.output=this.sequencer}var o=t("../synths").getSynth,s=t("../constants").$1s,n=(e.exports=r).prototype;n.restart=function(t){this.synth&&(this.synth.$27(),this.$u=t||0,this.$1w=this.data.$2(this.$u).steps[0],this.$3())},n.loadData=function(t){this.data=t,this.synth=o(t.synthId,this.sequencer),this.output=this.sequencer,this.restart()},n.$y=function(t){if(t){null!==t.vol&&this.synth.$1q(t.vol),null!==t.inst&&this.synth.$n(this.sequencer.$j(this.index,t.inst));for(var e=0;e<t.$2n.length;e++){var i=t.$2n[e];this.synth.$2t(i.id,i.value,i.x,i.y)}null!==t.note&&(-1===t.note?this.synth.$27():this.synth.$2m(t.note));for(e=0;e<t.$2o.length;e++){(i=t.$2o[e]).id===s.$12?this.output=this.sequencer.effects[i.value]||this.sequencer:this.synth.$2t(i.id,i.value,i.x,i.y)}}},n.$3=function(){var t=this.sequencer,e=this.$1w,i=t.$w[e.index%t.$w.length];this.$1f=this.$u*t.$1y+(e.index+e.$1g)*t.$1z+i},n.$b=function(){this.$1w=this.$1w.next,this.$1w||(this.$u+=1,this.$1w=this.data.$2(this.$u).steps[0]),this.$3()},n.$1x=function(t){if(this.synth&&!this.muted){var e=this.sequencer.t;this.$1f<=e&&(this.$y(this.$1w),this.$b());for(var i=0,r=e+t;this.$1f<r;){var o=~~(this.$1f-e);o<0&&(o=0),this.synth.$1x(this.output.buffL,this.output.buffR,i,o),i=o,this.$y(this.$1w),this.$b()}this.synth.$1x(this.output.buffL,this.output.buffR,i,t)}}},{"../constants":13,"../synths":27}],10:[function(t,e,i){function r(){this.tracks=[],this.effects=[],this.buffers=[],this.album=null,this.song=null,this.$1z=0,this.$1y=0,this.$w=[0],this.synth=null,this.t=0,this.stopped=!0,this.$1r=null,this.$16=null,this.$2kLength=0,this.buffL=null,this.buffR=null,this.effects.push(this);for(var t=0;t<4;t++)this.effects.push(new l(t,this));this.$4=[]}var o=t("./loadAudioBuffer"),s=t("../constants"),n=t("../audioContext"),a=t("./Track"),l=t("./Effect"),p=s.$11,h=(e.exports=r).prototype;h.$e=function(){this.$16||(this.$1r=n.createGain(),this.$1r.connect(n.destination),this.$1r.gain.value=.5,this.createScriptProcessor())},r.prototype.createScriptProcessor=function(){if(this.$2kLength!==s.$h){this.$2kLength=s.$h,this.$16&&this.$16.disconnect(this.$1r);var t=n.createScriptProcessor(s.$h,0,2);t.onaudioprocess=this.onAudioProcess.bind(this),t.connect(this.$1r),this.$16=t}},h.onAudioProcess=function(t){var e,i=t.outputBuffer,r=this.buffL=i.getChannelData(0),o=this.buffR=i.getChannelData(1);for(e=0;e<s.$h;e++)r[e]=0,o[e]=0;for(e=0;e<this.$4.length;e++)this.$4[e].clearBuffer();if(!this.stopped){for(e=0;e<this.tracks.length;e++)this.tracks[e].$1x(s.$h);for(e=0;e<this.$4.length;e++)this.$4[e].process(s.$h);this.t+=s.$h}},h.$13=function(){for(var t=0;t<this.tracks.length;t++){var e=this.tracks[t].synth;e&&e.reset()}},h.play=function(){this.$q(0)},h.$q=function(t){if(this.song){this.t=t*this.$1y;for(var e=0;e<this.tracks.length;e++)this.tracks[e].restart(t);this.stopped=!1}},h.stop=function(){this.stopped=!0,this.$13()},h.$j=function(t,e){var i=this.song.tracks[t].synthId,r=this.album.instruments[i];return r[e%r.length]},h.loadAlbum=function(t,e){this.stop(),this.album=t,this.song=null,this.tracks=[];for(var i=t.trackCount,r=0;r<i;r++){var o=new a(r,this);this.tracks.push(o)}this.loadAudioBuffers(e)},h.loadAudioBuffers=function(t){var e=this.album.samples;this.buffers=[];for(var i=0;i<e.length;i++)this.buffers.push(null),this.loadAudioBufferInIndex(e[i],i)},h.loadAudioBufferInIndex=function(t,i){var r=this.buffers;o(t,function(t,e){return t?void console.error(t):void(r[i]=e.getChannelData(0))},this.album.path)},h.$d=function(t){if(!this.album)return console.error("No album loaded");var e=this.album.songs[t];if(!e)return console.error("No song at index");this.song=e,this.$1b();for(var i=0;i<this.tracks.length;i++){this.tracks[i].loadData(e.tracks[i])}for(i=1;i<this.effects.length;i++){this.effects[i].loadEffect(e.effects[i-1])}this.$p(),this.synth=this.tracks[0].synth,this.$13()},h.$p=function(){this.$4=[];for(var t=1;t<this.effects.length;t++){var e=this.effects[t];e.effector&&this.$4.push(e)}},h.$1b=function(){this.$1z=60*p/this.song.bpm/this.song.speed,this.$1y=this.$1z*this.song.$k,this.$v()},h.$v=function(){this.$w=[0];var t=this.song.groove;if(t&&!(t.length<2)){for(var e=0,i=0;i<t.length;i++)e+=t[i];var r=e/t.length,o=t[0];for(i=1;i<t.length;i++){var s=(o-r*i)/r*this.$1z;this.$w.push(s),o+=t[i]}}}},{"../audioContext":12,"../constants":13,"./Effect":8,"./Track":9,"./loadAudioBuffer":11}],11:[function(t,e,i){function o(t,e){this.uri=t,this.buffer=null,this.error=null,this.loading=!1,this.onLoad=[],this.albumPath=e}var r=t("../audioContext"),s={};o.prototype.load=function(t){return this.error||this.buffer?t(this.error,this.buffer):(this.onLoad.push(t),void(this.loading||this.initiateLoad()))},o.prototype.initiateLoad=function(){this.loading=!0;var t,e=this;(t=new XMLHttpRequest).responseType="arraybuffer",t.onreadystatechange=function(){if(4==~~t.readyState)return 200!=~~t.status&&0!=~~t.status?e.completeLoad("xhrError:"+t.status):void r.decodeAudioData(t.response,function(t){return e.completeLoad(null,t)},e.completeLoad.bind(e))},t.open("GET",this.uri,!0),t.send()},o.prototype.completeLoad=function(t,e){this.buffer=e,this.error=t;for(var i=0;i<this.onLoad.length;i++)this.onLoad[i](t,e);this.onLoad=[]},e.exports=function(t,e,i){var r=s[t];(r=r||(s[t]=new o(t,i))).load(e)}},{"../audioContext":12}],12:[function(t,e,i){var r=t("./constants"),o=new window.AudioContext({sampleRate:r.$11});e.exports=o},{"./constants":13}],13:[function(t,e,i){i.$h=1024,i.$11=44100,i.$r=i.$11/64,i.$1s={$1t:0,$23:1,$24:2,$2v:3,$2s:4,$8:5,$g:6,$1c:7,$1d:8,$12:9,PANORAMIC:10},i.$1u=1,i.$5=2,i.$9=32,i.$6=4,i.TAU=2*Math.PI},{}],14:[function(t,e,i){for(var o=[],r=0;r<128;r++)o.push((s=r,440*Math.pow(2,(s-69)/12)));var s;i.$a=o,i.$1h=function(t){t<0&&(t=0),127<t&&(t=127);var e=~~t,i=t-e,r=o[e];return r+i*(o[1+e]-r)}},{}],15:[function(t,e,i){var r=t("./audioContext"),o=t("./Album"),s=t("./Sequencer"),n=new o,a=new s;a.$e();var l={};p={context:r,output:a.$1r,loadData:function(t){n.$14(t),a.loadAlbum(n),l={};for(var e=0;e<n.songs.length;e++){var i=n.songs[e];l[i.name]=e}},playSong:function(t){l[t]&&(t=l[t]),a.$d(~~t),a.play()},stop:function(){a.stop()},$1q:function(t){a.$1r.gain.value=Math.max(0,Math.min(t,1))}}},{"./Album":7,"./Sequencer":10,"./audioContext":12}],16:[function(t,e,i){function r(){this._time=11025,this.f=.4,this.c=.6,this.$2kL=new Float32Array(l),this.$2kR=new Float32Array(l),this.$21=0,this._filterStateL=0,this._filterStateR=0}var l=44100,o=(e.exports=r).prototype;r.getDefaultParams=function(){return{t:.25,f:.4,c:.6,p:!1}},o.process=function(t,e,i,r,o){for(var s=0;s<o;s++){var n=this.$2kR[this.$21]*this.f,a=this.$2kL[this.$21]*this.f;this._filterStateL=a*this.c+this._filterStateL*(1-this.c),a=t[s]+this._filterStateL,this._filterStateR=n*this.c+this._filterStateR*(1-this.c),n=e[s]+this._filterStateR,this.p?(this.$2kR[(this.$21+this._time)%l]=a,this.$2kL[(this.$21+this._time)%l]=n):(this.$2kL[(this.$21+this._time)%l]=a,this.$2kR[(this.$21+this._time)%l]=n),this.$21+=1,this.$21>=l&&(this.$21=0),i[s]+=a,r[s]+=n}},Object.defineProperty(o,"t",{set:function(t){this._time=Math.max(100,~~(t*l))}})},{}],17:[function(t,e,i){function r(t){this.synth=t,this.$2p=0,this.$2l=d,this.$2c=0,this.out=0,this.instrument=null}function o(){this.note=0,this.volume=0,this.playing=!1,this.$2q=0,this.$m=0,this.instrument=null,this.$2w=0,this._panL=1,this._panR=1,this.$2wL=this.$2w,this.$2wR=this.$2w,this.$1m=null,this.$1p=0,this.$1n=0,this.$1o=0,this.$2e=0,this.$2f=0,this.$2g=0,this.$2j=0,this.$2h=0,this.$2i=0,this.$19=!1,this.$2d=0,this.$1l=null,this.$20=0,this._damping=!1,this._dampVal=0,this._lastOut=0,this.$1j=[new r(this),new r(this),new r(this),new r(this)],this.$n(this.$1())}var s=t("../constants"),n=t("../noteUtils"),a=s.$1s,l=s.$11,p=l/60,h=(s.$1u,s.TAU),c=s.$5,u=s.$6,f=s.$9,d=0,y=r.prototype;y.$n=function(t){this.instrument=t},y.$28=function(){this.$2c=0,this.$2l=4,this.$2p=0},y.$1x=function(){switch(this.$2l){case d:return;case 2:break;case 4:this.$2c+=this.instrument.a/64,1<=this.$2c&&(this.$2c=1,this.$2l=3);break;case 3:this.$2c-=this.instrument.d/64,this.$2c<=this.instrument.s&&(this.$2c=this.instrument.s,1===this.synth.instrument.c?this.$2l=1:this.$2l=2);break;case 1:this.$2c-=this.instrument.r/64,this.$2c<=0&&(this.$2c=0,this.$2l=d,this.out=0)}var t=this.synth.$1j,e=this.instrument.c,i=0;i+=e[0]*t[0].out,i+=e[1]*t[1].out,i+=e[2]*t[2].out,i+=e[3]*t[3].out,this.$2p+=this.synth.$2q*this.instrument.m,1<=this.$2p&&(this.$2p=this.$2p%1),this.out=this.$2c*Math.sin(h*(this.$2p+i))};var g=(e.exports=o).prototype;g.$1=function(){return{n:"",l:{},p:0,c:1,o:[{m:1,a:.25,d:.00225,s:.5,r:.00225,c:[0,0,0,0],v:0},{m:1,a:.25,d:.00225,s:.5,r:.00225,c:[0,0,0,0],v:0},{m:1,a:.25,d:.00225,s:.5,r:.00225,c:[0,0,0,0],v:0},{m:1,a:.25,d:.00225,s:.5,r:.00225,c:[0,0,0,0],v:1}]}},g.$n=function(t){this.instrument=t,this.$1j[0].$n(t.o[0]),this.$1j[1].$n(t.o[1]),this.$1j[2].$n(t.o[2]),this.$1j[3].$n(t.o[3])},g.reset=function(){this.$27(),this.$1q(15),this.$19=!1,this.$1l=null,this.$20=0,this.$2g=0,this.$2i=0,this.$17(),this.$18()},g.$2m=function(t){null!==this.$1m?(this.note+=this.$1n,this.$1o=0,this.$1n=t-this.note,this.$1p=this.$1n/(this.$1m+1)/c,this.$1m=null):(this.note=t,this.$1n=0,this.$1p=0,this.$1o=0),this.playing=!0,this.$m=0,this.$2d=0,this.$1j[0].$28(),this.$1j[1].$28(),this.$1j[2].$28(),this.$1j[3].$28(),this.$17(),this._damping=!1},g.$27=function(){this.playing&&(0===this.instrument.c?(this.$1j[0].$2l=1,this.$1j[1].$2l=1,this.$1j[2].$2l=1,this.$1j[3].$2l=1):(this.playing=!1,this._damping=!0,this._dampVal=this._lastOut))},g.$17=function(){var t=0;0<this.$2f&&(t=this.$2g*Math.sin(this.$2e*h));var e=this.note+this.instrument.p+this.$20+this.$1o+t;this.$2q=n.$1h(e)/l},g._updatePannoramic=function(t,e){this._panL=t/15,this._panR=e/15,this.$2wL=this.$2w*this._panL,this.$2wR=this.$2w*this._panR},g.$18=function(){var t=1;0<this.$2h&&(t=1-this.$2i*(Math.sin(this.$2j*h)+1)),this.$2w=this.volume*t,this.$2wL=this.$2w*this._panL,this.$2wR=this.$2w*this._panR},g.$c=function(){var t=!1,e=!1;this.$19&&(this.$2d=(this.$2d+1)%this.$1l.length,this.$20=this.$1l[this.$2d],e=!0),0!==this.$1p&&(this.$1o+=this.$1p,e=!0,(0<this.$1p&&this.$1o>=this.$1n||this.$1p<0&&this.$1o<=this.$1n)&&(this.$1o=this.$1n,this.$1p=0)),0<this.$2f&&(this.$2e+=this.$2f,1<this.$2e&&--this.$2e,e=!0),0<this.$2h&&(this.$2j+=this.$2h,1<this.$2j&&--this.$2j,t=!0),e&&this.$17(),t&&this.$18()},g.$1q=function(t){this.volume=t/40,this.$18()},g.$2t=function(t,e,i,r){var o=!1,s=!1;switch(t){case a.$1t:this.$20=0,(this.$2d=0)===e?(this.$19=!1,o=!(this.$1l=null)):(this.$19=!0,this.$1l=0===r?[0,i]:[0,i,r]);break;case a.$24:this.$2f=i/64,this.$2g=r/16,0===r&&(o=!0);break;case a.$23:this.$2h=i/64,this.$2i=r/f,s=!0;break;case a.$2s:this.$1m=e/u;break;case a.$g:this.note+=this.$1n,this.$1o=0,this.$1n=r,this.$1p=r/(i+1)/c;break;case a.$8:this.note+=this.$1n,this.$1o=0,this.$1n=-r,this.$1p=-r/(i+1)/c;break;case a.PANORAMIC:this._updatePannoramic(i,r)}o&&this.$17(),s&&this.$18()},g.$1x=function(t,e,i,r){if(this._damping){for(var o=i;o<r;o++)if(this._dampVal*=.98,t[o]+=this._dampVal,e[o]+=this._dampVal,-.01<this._dampVal&&this._dampVal<.01)return void(this._damping=!1)}else if(this.playing){for(o=i;o<r;o++){if(++this.$m>=p){if(this.$m-=p,this.$1j[0].$2l===d&&this.$1j[1].$2l===d&&this.$1j[2].$2l===d&&this.$1j[3].$2l===d)return void(this.playing=!1);this.$c()}this.$1j[0].$1x(),this.$1j[1].$1x(),this.$1j[2].$1x(),this.$1j[3].$1x();var s=0;s+=this.$1j[0].instrument.v*this.$1j[0].out,s+=this.$1j[1].instrument.v*this.$1j[1].out,s+=this.$1j[2].instrument.v*this.$1j[2].out,s+=this.$1j[3].instrument.v*this.$1j[3].out,t[o]+=s*this.$2wL,e[o]+=s*this.$2wR}this._lastOut=s}}},{"../constants":13,"../noteUtils":14}],18:[function(t,e,i){function r(t){this.feedback=0,this.$2k=new Float32Array(t),this._bufsize=t,this._index=0,this._filtered=0,this._damp1=0,this._damp2=0}function o(t){this.$2k=new Float32Array(t),this._bufsize=t,this._index=0}function s(){this._roomSize=0,this._roomSize1=0,this._damp=0,this._damp1=0,this._wet=0,this._wet1=0,this._wet2=0,this._dry=0,this._width=0,this.combL=[],this.combR=[],this.allpassL=[],this.allpassR=[];for(var t=0;t<8;t++)this.combL.push(new r(l[t])),this.combR.push(new r(l[t]+23));for(var e=0;e<4;e++)this.allpassL.push(new o(p[e])),this.allpassR.push(new o(p[e]+23))}var n=r.prototype;n.setDamp=function(t){this._damp1=t,this._damp2=1-t},n.mute=function(){for(var t=0;t<this._bufsize;t++)this.$2k[t]=0},n.process=function(t){var e=this.$2k[this._index];return this._filtered=e*this._damp2+this._filtered*this._damp1,this.$2k[this._index]=t+this._filtered*this.feedback,++this._index>=this._bufsize&&(this._index=0),e};var a=o.prototype;a.mute=function(){for(var t=0;t<this._bufsize;t++)this.$2k[t]=0},a.process=function(t){var e=this.$2k[this._index];return this.$2k[this._index]=t+.5*e,++this._index>=this._bufsize&&(this._index=0),e-t};var l=[1116,1188,1277,1356,1422,1491,1557,1617],p=[556,441,341,225],h=(e.exports=s).prototype;s.getDefaultParams=function(){return{d:.8,w:.3,z:.8,a:.5,i:.8}},h.process=function(t,e,i,r,o){for(var s,n=0;n<o;n++){var a=0,l=0;for(s=0;s<8;s++)a+=this.combL[s].process(t[n]),l+=this.combR[s].process(e[n]);for(s=0;s<4;s++)a=this.allpassL[s].process(a),l=this.allpassR[s].process(l);i[n]+=a*this._wet1+l*this._wet2+t[n]*this._dry,r[n]+=l*this._wet1+a*this._wet2+e[n]*this._dry}},h.mute=function(){for(var t=0;t<8;t++)this.combL[t].mute(),this.combR[t].mute();for(t=0;t<4;t++)this.allpassL[t].mute(),this.allpassR[t].mute()},h.update=function(){this._wet1=this._wet*(this._width/2+.5),this._wet2=this._wet*((1-this._width)/2),this._roomSize1=this._roomSize,this._damp1=this._damp;for(var t=0;t<8;t++)this.combL[t].feedback=this._roomSize1,this.combR[t].feedback=this._roomSize1,this.combL[t].setDamp(this._damp1),this.combR[t].setDamp(this._damp1)},Object.defineProperty(h,"d",{set:function(t){this._dry=+t}}),Object.defineProperty(h,"w",{set:function(t){this._wet=.06*t,this.update()}}),Object.defineProperty(h,"z",{set:function(t){this._roomSize=.28*t+.7,this.update()}}),Object.defineProperty(h,"a",{set:function(t){this._damp=.4*t,this.update()}}),Object.defineProperty(h,"i",{set:function(t){this._width=t,this.update()}})},{}],19:[function(t,e,i){function r(){this.note=0,this.volume=0,this.playing=!1,this.$m=0,this.$2w=1.4,this._panL=1,this._panR=1,this.$2wL=this.$2w,this.$2wR=this.$2w,this.$29=0,this.$2a=0,this.$1k=1,this.$2b=0,this.$2u=h[0],this.$2j=0,this.$2h=0,this.$2i=0,this.$1a=new s(1,15),this.$o=new s(0,1),this.$10=new s(0,1)}var o=t("../constants"),s=t("./TableEnvelope"),n=o.$1s,a=o.$11/60,l=2*Math.PI,p=[.01,.02,.04,.053,.08,.105,.15,.2,.25,.3,.35,.4,.45,.5,.7,.9],h=[8192,256,6144,4480],c=(e.exports=r).prototype;c.$1=function(){return{n:""}},c.$n=function(t){this.$1a.set(t.a),this.$o.set(t.p),this.$10.set(t.d)},c.reset=function(){this.$27(),this.$1q(15),this.$29=0,this.$2i=0,this.$17(),this.$18()},c.$2m=function(t){this.note=t,this.$m=0,this.$1a.$2r(),this.$o.$2r(),this.$10.$2r(),this.$17(),this.$18(),this.playing=!0},c.$27=function(){this.playing=!1},c.$1q=function(t){this.volume=t/30,this.$18()},c.$2t=function(t,e,i,r){var o=!1;switch(t){case n.$23:this.$2h=i/64,this.$2i=r/32,o=!0;break;case n.$2v:this.$2u=h[e%h.length];break;case n.PANORAMIC:this._updatePannoramic(i,r)}o&&this.$18()},c._updatePannoramic=function(t,e){this._panL=t/15,this._panR=e/15,this.$2wL=this.$2w*this._panL,this.$2wR=this.$2w*this._panR},c.$18=function(){var t=1;0<this.$2h&&(t=1-this.$2i*(Math.sin(this.$2j*l)+1)),this.$2w=1.4*this.volume*t,this.$2w*=this.$1a.value,this.$2wL=this.$2w*this._panL,this.$2wR=this.$2w*this._panR},c.$17=function(){var t=~~(this.note+this.$o.value);this.$2a=p[t%16]},c.$c=function(){var t=!1,e=!1;0<this.$2h&&(this.$2j+=this.$2h,1<this.$2j&&--this.$2j,t=!0),this.$1a.enabled&&this.$1a.clock()&&(t=!0),this.$o.enabled&&this.$o.clock()&&(e=!0),this.$10.enabled&&this.$10.clock()&&(this.$2u=h[~~this.$10.value%h.length]),e&&this.$17(),t&&this.$18()},c.$1x=function(t,e,i,r){if(this.playing)for(var o=i;o<r;o++){if(++this.$m>=a&&(this.$m-=a,this.$c()),this.$29+=this.$2a,1<this.$29){this.$29=this.$29%1;var s=!(16384&this.$1k)^!(this.$1k&this.$2u);this.$1k=32767&(this.$1k<<1|s),this.$2b=(16384&this.$1k)>>14}var n=this.$2b-.5;t[o]+=n*this.$2wL,e[o]+=n*this.$2wR}}},{"../constants":13,"./TableEnvelope":25}],20:[function(t,e,i){function r(){n.call(this),this.$2w=.25,this.$2u=.25,this.$10=new s(0,1)}for(var o=t("../constants"),s=t("./TableEnvelope"),n=t("./SimpleOscillator"),a=t("pixelbox/inherits"),l=o.$11/60,p=[1/8,.25,.5,.75],h=1;h<63;h++)p.push(h/64);a(r,n);var c=(e.exports=r).prototype;c.$n=function(t){n.prototype.$n.call(this,t),this.$10.set(t.d)},c.$2m=function(t){n.prototype.$2m.call(this,t),this.$10.$2r()},c.$1q=function(t){this.volume=t/60,this.$18()},c._updateDuty=function(t){this.$2u=p[t%p.length]},c.$c=function(){n.prototype.$c.call(this),this.$10.enabled&&this.$10.clock()&&(this.$2u=p[~~this.$10.value])},c.$1x=function(t,e,i,r){if(this.playing)for(var o=i;o<r;o++){++this.$m>=l&&(this.$m-=l,this.$c()),this.$29+=this.$2a,1<this.$29&&(this.$29=this.$29%1);var s=this.$29>this.$2u?1:-1;t[o]+=s*this.$2wL,e[o]+=s*this.$2wR}}},{"../constants":13,"./SimpleOscillator":24,"./TableEnvelope":25,"pixelbox/inherits":1}],21:[function(t,e,i){function r(){o.call(this),this._damping=!1,this._dampVal=0}var o=t("./SimpleOscillator"),s=t("../constants"),n=t("pixelbox/inherits"),a=s.$11/60,l=[0,.12,.25,.37,.5,.62,.75,.87,.87,.75,.62,.5,.37,.25,.12,0,-.12,-.25,-.37,-.5,-.62,-.75,-.87,-1,-1,-.87,-.75,-.62,-.5,-.37,-.25,-.12];n(r,o);var p=(e.exports=r).prototype;p.$2m=function(t){o.prototype.$2m.call(this,t),this._damping=!1},p.$27=function(){this.playing&&(this._damping=!0,this._dampVal=l[~~(32*this.$29)]),this.playing=!1},p.$1x=function(t,e,i,r){if(this._damping){for(var o=i;o<r;o++)if(this._dampVal*=.98,t[o]+=this._dampVal*this.$2wL,e[o]+=this._dampVal*this.$2wR,-.01<this._dampVal&&this._dampVal<.01)return this._damping=!1,void(this.$29=0)}else if(this.playing)for(o=i;o<r;o++){++this.$m>=a&&(this.$m-=a,this.$c()),this.$29+=this.$2a,1<this.$29&&(this.$29=this.$29%1);var s=l[~~(32*this.$29)];t[o]+=s*this.$2wL,e[o]+=s*this.$2wR}}},{"../constants":13,"./SimpleOscillator":24,"pixelbox/inherits":1}],22:[function(t,e,i){function r(t){this._sequencer=t,this.$2k=null,this._instrument=this.$1(),this.note=0,this.volume=0,this.playing=!1,this.$21=0,this.$22=0,this.$f=0,this.$m=0,this.$2w=1,this._panL=1,this._panR=1,this.$2wL=this.$2w,this.$2wR=this.$2w,this.$1m=null,this.$1p=0,this.$1n=0,this.$1o=0,this.$2e=0,this.$2f=0,this.$2g=0,this.$2j=0,this.$2h=0,this.$2i=0,this.$2l=0,this.$2c=0}var o=t("../constants"),s=t("../noteUtils"),n=(o.$1u,o.$1s),a=o.$11/60,l=s.$a[60],p=o.TAU,h=o.$5,c=o.$6,u=o.$9,f=(e.exports=r).prototype;f.$1=function(){return{n:"",a:0,s:0,e:0,l:0,p:0,v:[1,1,1,1,0]}},f.$n=function(t){var e=(this._instrument=t).a||0;this.$2k=this._sequencer.buffers[e],this.$21=t.s},f.reset=function(){this.playing=!1,this.$1q(15),this.$17(),this.$18()},f.$2m=function(t){null!==this.$1m?(this.note+=this.$1n,this.$1o=0,this.$1n=t-this.note,this.$1p=this.$1n/(this.$1m+1)/h,this.$1m=null):(this.note=t,this.$1n=0,this.$1p=0,this.$1o=0),this.$m=0,this.$21=this._instrument.s,this.$17(),this.$18(),this.$2c=0,this.$2l=4,this.$2k&&(this.playing=!0)},f.$27=function(){0===this._instrument.v[4]?this.$2l=1:this.playing=!1},f.$1q=function(t){this.volume=t/20,this.$18()},f.$2t=function(t,e,i,r){var o=!1,s=!1;switch(t){case n.$24:this.$2f=i/64,this.$2g=r/16,0===r&&(o=!0);break;case n.$23:this.$2h=i/64,this.$2i=r/u,s=!0;break;case n.$2s:this.$1m=e/c;break;case n.$g:this.note+=this.$1n,this.$1o=0,this.$1n=r,this.$1p=r/(i+1)/h;break;case n.$8:this.note+=this.$1n,this.$1o=0,this.$1n=-r,this.$1p=-r/(i+1)/h;break;case n.PANORAMIC:this._updatePannoramic(i,r)}o&&this.$17(),s&&this.$18()},f._updatePannoramic=function(t,e){this._panL=t/15,this._panR=e/15,this.$2wL=this.$2w*this._panL,this.$2wR=this.$2w*this._panR},f.$18=function(){var t=1;0<this.$2h&&(t=1-this.$2i*(Math.sin(this.$2j*p)+1)),this.$2w=this.volume*t,this.$2wL=this.$2w*this._panL,this.$2wR=this.$2w*this._panR},f.$17=function(){var t=0;0<this.$2f&&(t=this.$2g*Math.sin(this.$2e*p));var e=this.note+this._instrument.p+this.$1o+t;this.$22=s.$1h(e)/l},f.$c=function(){var t=!1,e=!1;0!==this.$1p&&(this.$1o+=this.$1p,e=!0,(0<this.$1p&&this.$1o>=this.$1n||this.$1p<0&&this.$1o<=this.$1n)&&(this.$1o=this.$1n,this.$1p=0)),0<this.$2f&&(this.$2e+=this.$2f,1<this.$2e&&--this.$2e,e=!0),0<this.$2h&&(this.$2j+=this.$2h,1<this.$2j&&--this.$2j,t=!0),e&&this.$17(),t&&this.$18()},f.$7=function(){if(0!==this.$2l){var t=this._instrument.v;switch(this.$2l){case 2:break;case 4:this.$2c+=t[0],1<=this.$2c&&(this.$2c=1,this.$2l=3);break;case 3:this.$2c-=t[1],this.$2c<=t[2]&&(this.$2c=t[2],1===t[4]?this.$2l=1:this.$2l=2);break;case 1:this.$2c-=t[3],this.$2c<=0&&(this.$2c=0,this.$2l=0,this.playing=!1)}}},f.$1x=function(t,e,i,r){if(this.playing)for(var o=i;o<r;o++){if(64<=++this.$f&&(this.$f=0,this.$7()),++this.$m>=a&&(this.$m-=a,this.$c()),this.$21+=this.$22,this.$21>=this._instrument.e){if(0===this._instrument.l)return void(this.playing=!1);this.$21-=this._instrument.l}var s=this.$2k[~~this.$21]*this.$2c;t[o]+=s*this.$2wL,e[o]+=s*this.$2wR}}},{"../constants":13,"../noteUtils":14}],23:[function(t,e,i){function r(){o.call(this)}var o=t("./SimpleOscillator"),s=t("../constants"),n=t("pixelbox/inherits"),a=s.$11/60;n(r,o),(e.exports=r).prototype.$1x=function(t,e,i,r){if(this.playing)for(var o=i;o<r;o++){++this.$m>=a&&(this.$m-=a,this.$c()),this.$29+=this.$2a,1<this.$29&&(this.$29=this.$29%1);var s=this.$29-.5;t[o]+=s*this.$2wL,e[o]+=s*this.$2wR}}},{"../constants":13,"./SimpleOscillator":24,"pixelbox/inherits":1}],24:[function(t,e,i){function r(){this._instrument=null,this.note=0,this.volume=0,this.playing=!1,this.$m=0,this.$2w=h,this._panL=1,this._panR=1,this.$2wL=this.$2w,this.$2wR=this.$2w,this.$29=0,this.$2a=0,this.$1m=null,this.$1p=0,this.$1n=0,this.$1o=0,this.$2e=0,this.$2f=0,this.$2g=0,this.$2j=0,this.$2h=0,this.$2i=0,this.$19=!1,this.$2d=0,this.$1l=null,this.$20=0,this.$1a=new n(1,15),this.$o=new n(0,1),this.$z=new n(0,16)}var o=t("../constants"),s=t("../noteUtils"),n=t("./TableEnvelope"),a=o.$1s,l=o.$11,p=o.TAU,h=o.$1u,c=o.$5,u=o.$6,f=o.$9,d=(e.exports=r).prototype;d.$1=function(){return{n:""}},d.$n=function(t){this._instrument=t,this.$1a.set(t.a),this.$o.set(t.p),this.$z.set(t.t)},d.reset=function(){this.$27(),this.$1q(15),this.$19=!1,this.$1l=null,this.$20=0,this.$2g=0,this.$2i=0,this.$17(),this.$18()},d.$2m=function(t){null!==this.$1m?(this.note+=this.$1n,this.$1o=0,this.$1n=t-this.note,this.$1p=this.$1n/(this.$1m+1)/c,this.$1m=null):(this.note=t,this.$1n=0,this.$1p=0,this.$1o=0),this.$m=0,this.$2d=0,this.$1a.$2r(),this.$o.$2r(),this.$z.$2r(),this.$17(),this.$18(),this.playing=!0},d.$27=function(){this.playing=!1,this.$1m=null},d.$1q=function(t){this.volume=t/30,this.$18()},d.$2t=function(t,e,i,r){var o=!1,s=!1;switch(t){case a.$1t:this.$20=0,(this.$2d=0)===e?(this.$19=!1,o=!(this.$1l=null)):(this.$19=!0,this.$1l=0===r?[0,i]:[0,i,r]);break;case a.$24:this.$2f=i/64,this.$2g=r/16,0===r&&(o=!0);break;case a.$23:this.$2h=i/64,this.$2i=r/f,s=!0;break;case a.$2s:this.$1m=e/u;break;case a.$g:this.note+=this.$1n,this.$1o=0,this.$1n=r,this.$1p=r/(i+1)/c;break;case a.$8:this.note+=this.$1n,this.$1o=0,this.$1n=-r,this.$1p=-r/(i+1)/c;break;case a.$2v:this._updateDuty(e);break;case a.PANORAMIC:this._updatePannoramic(i,r)}o&&this.$17(),s&&this.$18()},d._updateDuty=function(t){},d._updatePannoramic=function(t,e){this._panL=t/15,this._panR=e/15,this.$2wL=this.$2w*this._panL,this.$2wR=this.$2w*this._panR},d.$18=function(){var t=1;0<this.$2h&&(t=1-this.$2i*(Math.sin(this.$2j*p)+1)),this.$2w=h*this.volume*t,this.$2w*=this.$1a.value,this.$2wL=this.$2w*this._panL,this.$2wR=this.$2w*this._panR},d.$17=function(){var t=0;0<this.$2f&&(t=this.$2g*Math.sin(this.$2e*p));var e=this.note+this.$20+this.$1o+this.$o.value+this.$z.value+t;this.$2a=s.$1h(e)/l},d.$c=function(){var t=!1,e=!1;this.$19&&(this.$2d=(this.$2d+1)%this.$1l.length,this.$20=this.$1l[this.$2d],e=!0),0!==this.$1p&&(this.$1o+=this.$1p,e=!0,(0<this.$1p&&this.$1o>=this.$1n||this.$1p<0&&this.$1o<=this.$1n)&&(this.$1o=this.$1n,this.$1p=0)),0<this.$2f&&(this.$2e+=this.$2f,1<this.$2e&&--this.$2e,e=!0),0<this.$2h&&(this.$2j+=this.$2h,1<this.$2j&&--this.$2j,t=!0),this.$1a.enabled&&this.$1a.clock()&&(t=!0),this.$o.enabled&&this.$o.clock()&&(e=!0),this.$z.enabled&&this.$z.clock()&&(e=!0),e&&this.$17(),t&&this.$18()},d.$1x=function(t,e,i,r){}},{"../constants":13,"../noteUtils":14,"./TableEnvelope":25}],25:[function(t,e,i){function r(t,e){this._playing=!1,this._pos=0,this.min=t,this.max=e,this.data=null,this.table=null,this.enabled=!1,this.value=this.min}var o=(e.exports=r).prototype;o.set=function(t){if(!t)return this.enabled=!1,this.data=null,this.table=null,void(this.value=this.min);var e=t.t||null;this.data=t,this.enabled=e&&e.length&&!0,this.table=e,this.value=e?e[0]/this.max:this.min},o.clock=function(){return!!this._playing&&(this._pos+=1,this._pos>=this.table.length&&(0===this.data.l?(this._pos=this.table.length-1,this._playing=!1):this._pos-=this.data.l),this.value=this.table[this._pos]/this.max,!0)},o.$2r=function(){this.enabled&&(this._playing=!0,this._pos=0,this.value=this.table[0]/this.max)}},{}],26:[function(t,e,i){function r(){o.call(this),this._damping=!1,this._dampVal=0,this.$n(this.$1())}var o=t("./SimpleOscillator"),s=t("../constants"),n=t("pixelbox/inherits"),a=s.$11/60;n(r,o);var l=(e.exports=r).prototype;l.$1=function(){return{n:"",w:{t:[0,1,2,3,4,5,6,7,8,7,6,5,4,3,2,1,0,-1,-2,-3,-4,-5,-6,-7,-8,-7,-6,-5,-4,-3,-2,-1]}}},l.$2m=function(t){o.prototype.$2m.call(this,t),this._damping=!1},l.$27=function(){this.playing&&(this._damping=!0,this._dampVal=this._instrument.w.t[~~(32*this.$29)]),this.playing=!1},l.$1q=function(t){this.volume=t/256,this.$18()},l.$1x=function(t,e,i,r){if(this._damping){for(var o=i;o<r;o++)if(this._dampVal*=.98,t[o]+=this._dampVal*this.$2wL,e[o]+=this._dampVal*this.$2wR,-.01<this._dampVal&&this._dampVal<.01)return this._damping=!1,void(this.$29=0)}else if(this.playing)for(o=i;o<r;o++){++this.$m>=a&&(this.$m-=a,this.$c()),this.$29+=this.$2a,1<this.$29&&(this.$29=this.$29%1);var s=this._instrument.w.t[~~(32*this.$29)];t[o]+=s*this.$2wL,e[o]+=s*this.$2wR}}},{"../constants":13,"./SimpleOscillator":24,"pixelbox/inherits":1}],27:[function(t,e,i){var r=t("./NesPulse"),o=t("./NesNoise"),s=t("./NesTriangle"),n=t("./Wavetable"),a=t("./Sawtooth"),l=t("./Sampler"),p=t("./FM"),h=t("./FreeVerb"),c=t("./Delay"),u=[null,r,s,o,a,n,l,p,null,null],f=[null,h,c];i.getSynth=function(t,e){if(!t)return null;var i=u[t];return i?new i(e):null},i.getEffector=function(t,e){if(!t)return null;var i=f[t];return i?new i:null},i.$s=f},{"./Delay":16,"./FM":17,"./FreeVerb":18,"./NesNoise":19,"./NesPulse":20,"./NesTriangle":21,"./Sampler":22,"./Sawtooth":23,"./Wavetable":26}]},{},[15]),e.exports=p},{}],77:[function(t,e,i){"use strict";var a,l,r=t(".."),o=r.settings,p=~~o.screen.pixelSize.width,h=~~o.screen.pixelSize.height,s=r.$screen.canvas,c=!0;if(o.screen.fullscreen){var n=function(){d=null;var t=s.getBoundingClientRect();p=t.width/u,h=t.height/f},u=o.screen.width,f=o.screen.height,d=null;window.onresize=function(){d&&window.clearTimeout(d),d=window.setTimeout(n,300)},n()}var y={x:0,y:0,pressed:!1},g=null,v=null,m=null,b=null,S=null,x=0,R=s.getBoundingClientRect();a=R.left,l=R.top;var A=o.touchEvent||{};A.disableContextMenu&&(s.oncontextmenu=function(){return!1}),A.hideMousePointer&&(s.style.cursor="none"),A.multiTouch&&(c=!1),s.addEventListener("mousedown",function(t){t.preventDefault(),window.focus(),y.pressed=!0,y.x=~~(t.layerX/p),y.y=~~(t.layerY/h),g&&g(y.x,y.y,0,t)}),s.addEventListener("mousemove",function(t){t.preventDefault(),y.x=~~(t.layerX/p),y.y=~~(t.layerY/h),v&&v(y.x,y.y,0,t)}),window.addEventListener("mouseup",function(t){t.preventDefault(),y.pressed&&(y.pressed=!1,y.x=~~(t.layerX/p),y.y=~~(t.layerY/h),m&&m(y.x,y.y,0,t))}),document.addEventListener("mouseleave",function(t){y.pressed&&(y.pressed=!1,b?b(0,t):m&&m(y.x,y.y,0,t))}),s.addEventListener("touchstart",function(t){if(t.preventDefault(),g){var e=t.changedTouches;if(c){var i=e[0];return x=i.identifier,y.pressed=!0,y.x=~~((i.clientX-a)/p),y.y=~~((i.clientY-l)/h),void g(y.x,y.y,i.identifier,i)}for(var r=0;r<e.length;r++){var o=~~(((i=e[r]).clientX-a)/p),s=~~((i.clientY-l)/h);g(o,s,i.identifier,i)}}}),s.addEventListener("touchmove",function(t){if(t.preventDefault(),v)for(var e=t.changedTouches,i=0;i<e.length;i++){var r=e[i],o=r.identifier;if(c){if(o!==x)continue;return y.x=~~((r.clientX-a)/p),y.y=~~((r.clientY-l)/h),void v(y.x,y.y,r.identifier,r)}var s=~~((r.clientX-a)/p),n=~~((r.clientY-l)/h);v(s,n,r.identifier,r)}}),s.addEventListener("touchend",function(t){if(t.preventDefault(),m)for(var e=t.changedTouches,i=0;i<e.length;i++){var r=e[i],o=r.identifier;if(c){if(o!==x)continue;return y.pressed=!1,y.x=~~((r.clientX-a)/p),y.y=~~((r.clientY-l)/h),void m(y.x,y.y,r.identifier,r)}var s=~~((r.clientX-a)/p),n=~~((r.clientY-l)/h);m(s,n,r.identifier,r)}}),s.addEventListener("touchcancel",function(t){if(t.preventDefault(),b)for(var e=t.changedTouches,i=0;i<e.length;i++){var r=e[i],o=r.identifier;if(c){if(o!==x)continue;return y.pressed=!1,void b(r.identifier,r)}b(r.identifier,r)}}),s.addEventListener("wheel",function(t){t.preventDefault();var e=t.wheelDeltaY;0!==e&&S&&S(e,t)}),i.onPress=function(t){g=t},i.onRelease=function(t){m=t},i.onMove=function(t){v=t},i.onCancel=function(t){b=t},i.onScroll=function(t){S=t},i.pointer=y},{"..":74}],78:[function(t,e,i){"use strict";var c=t("./Scalar");function r(){}(e.exports=r).lineInt=function(t,e,i){i=i||0;var r,o,s,n,a,l,p,h=[0,0];return r=t[1][1]-t[0][1],o=t[0][0]-t[1][0],s=r*t[0][0]+o*t[0][1],n=e[1][1]-e[0][1],a=e[0][0]-e[1][0],l=n*e[0][0]+a*e[0][1],p=r*a-n*o,c.eq(p,0,i)||(h[0]=(a*s-o*l)/p,h[1]=(r*l-n*s)/p),h},r.segmentsIntersect=function(t,e,i,r){var o=e[0]-t[0],s=e[1]-t[1],n=r[0]-i[0],a=r[1]-i[1];if(n*s-a*o==0)return!1;var l=(o*(i[1]-t[1])+s*(t[0]-i[0]))/(n*s-a*o),p=(n*(t[1]-i[1])+a*(i[0]-t[0]))/(a*o-n*s);return 0<=l&&l<=1&&0<=p&&p<=1}},{"./Scalar":81}],79:[function(t,e,i){"use strict";function p(){}(e.exports=p).area=function(t,e,i){return(e[0]-t[0])*(i[1]-t[1])-(i[0]-t[0])*(e[1]-t[1])},p.left=function(t,e,i){return 0<p.area(t,e,i)},p.leftOn=function(t,e,i){return 0<=p.area(t,e,i)},p.right=function(t,e,i){return p.area(t,e,i)<0},p.rightOn=function(t,e,i){return p.area(t,e,i)<=0};var h=[],c=[];p.collinear=function(t,e,i,r){if(r){var o=h,s=c;o[0]=e[0]-t[0],o[1]=e[1]-t[1],s[0]=i[0]-e[0],s[1]=i[1]-e[1];var n=o[0]*s[0]+o[1]*s[1],a=Math.sqrt(o[0]*o[0]+o[1]*o[1]),l=Math.sqrt(s[0]*s[0]+s[1]*s[1]);return Math.acos(n/(a*l))<r}return 0==p.area(t,e,i)},p.sqdist=function(t,e){var i=e[0]-t[0],r=e[1]-t[1];return i*i+r*r}},{}],80:[function(t,e,i){"use strict";var a=t("./Line"),R=t("./Point"),u=t("./Scalar");function A(){this.vertices=[]}(e.exports=A).prototype.at=function(t){var e=this.vertices,i=e.length;return e[t<0?t%i+i:t%i]},A.prototype.first=function(){return this.vertices[0]},A.prototype.last=function(){return this.vertices[this.vertices.length-1]},A.prototype.clear=function(){this.vertices.length=0},A.prototype.append=function(t,e,i){if(void 0===e)throw new Error("From is not given!");if(void 0===i)throw new Error("To is not given!");if(i-1<e)throw new Error("lol1");if(i>t.vertices.length)throw new Error("lol2");if(e<0)throw new Error("lol3");for(var r=e;r<i;r++)this.vertices.push(t.vertices[r])},A.prototype.makeCCW=function(){for(var t=0,e=this.vertices,i=1;i<this.vertices.length;++i)(e[i][1]<e[t][1]||e[i][1]==e[t][1]&&e[i][0]>e[t][0])&&(t=i);R.left(this.at(t-1),this.at(t),this.at(t+1))||this.reverse()},A.prototype.reverse=function(){for(var t=[],e=0,i=this.vertices.length;e!==i;e++)t.push(this.vertices.pop());this.vertices=t},A.prototype.isReflex=function(t){return R.right(this.at(t-1),this.at(t),this.at(t+1))};var l=[],p=[];function D(t,e,i,r,o){o=o||0;var s=e[1]-t[1],n=t[0]-e[0],a=s*t[0]+n*t[1],l=r[1]-i[1],p=i[0]-r[0],h=l*i[0]+p*i[1],c=s*p-l*n;return u.eq(c,0,o)?[0,0]:[(p*a-n*h)/c,(s*h-l*a)/c]}A.prototype.canSee=function(t,e){var i,r,o=l,s=p;if(R.leftOn(this.at(t+1),this.at(t),this.at(e))&&R.rightOn(this.at(t-1),this.at(t),this.at(e)))return!1;r=R.sqdist(this.at(t),this.at(e));for(var n=0;n!==this.vertices.length;++n)if((n+1)%this.vertices.length!==t&&n!==t&&R.leftOn(this.at(t),this.at(e),this.at(n+1))&&R.rightOn(this.at(t),this.at(e),this.at(n))&&(o[0]=this.at(t),o[1]=this.at(e),s[0]=this.at(n),s[1]=this.at(n+1),i=a.lineInt(o,s),R.sqdist(this.at(t),i)<r))return!1;return!0},A.prototype.copy=function(t,e,i){var r=i||new A;if(r.clear(),t<e)for(var o=t;o<=e;o++)r.vertices.push(this.vertices[o]);else{for(o=0;o<=e;o++)r.vertices.push(this.vertices[o]);for(o=t;o<this.vertices.length;o++)r.vertices.push(this.vertices[o])}return r},A.prototype.getCutEdges=function(){for(var t=[],e=[],i=[],r=new A,o=Number.MAX_VALUE,s=0;s<this.vertices.length;++s)if(this.isReflex(s))for(var n=0;n<this.vertices.length;++n)if(this.canSee(s,n)){e=this.copy(s,n,r).getCutEdges(),i=this.copy(n,s,r).getCutEdges();for(var a=0;a<i.length;a++)e.push(i[a]);e.length<o&&(o=(t=e).length,t.push([this.at(s),this.at(n)]))}return t},A.prototype.decomp=function(){var t=this.getCutEdges();return 0<t.length?this.slice(t):[this]},A.prototype.slice=function(t){if(0==t.length)return[this];if(t instanceof Array&&t.length&&t[0]instanceof Array&&2==t[0].length&&t[0][0]instanceof Array){for(var e=[this],i=0;i<t.length;i++)for(var r=t[i],o=0;o<e.length;o++){var s=e[o].slice(r);if(s){e.splice(o,1),e.push(s[0],s[1]);break}}return e}r=t,i=this.vertices.indexOf(r[0]),o=this.vertices.indexOf(r[1]);return-1!=i&&-1!=o&&[this.copy(i,o),this.copy(o,i)]},A.prototype.isSimple=function(){for(var t=this.vertices,e=0;e<t.length-1;e++)for(var i=0;i<e-1;i++)if(a.segmentsIntersect(t[e],t[e+1],t[i],t[i+1]))return!1;for(e=1;e<t.length-2;e++)if(a.segmentsIntersect(t[0],t[t.length-1],t[e],t[e+1]))return!1;return!0},A.prototype.quickDecomp=function(t,e,i,r,o,s){o=o||100,s=s||0,r=r||25,t=void 0!==t?t:[],e=e||[],i=i||[];var n=[0,0],a=[0,0],l=[0,0],p=0,h=0,c=0,u=0,f=0,d=0,y=0,g=new A,v=new A,m=this,b=this.vertices;if(b.length<3)return t;if(o<++s)return console.warn("quickDecomp: max level ("+o+") reached."),t;for(var S=0;S<this.vertices.length;++S)if(m.isReflex(S)){e.push(m.vertices[S]),p=h=Number.MAX_VALUE;for(var x=0;x<this.vertices.length;++x)R.left(m.at(S-1),m.at(S),m.at(x))&&R.rightOn(m.at(S-1),m.at(S),m.at(x-1))&&(l=D(m.at(S-1),m.at(S),m.at(x),m.at(x-1)),R.right(m.at(S+1),m.at(S),l)&&(c=R.sqdist(m.vertices[S],l))<h&&(h=c,a=l,d=x)),R.left(m.at(S+1),m.at(S),m.at(x+1))&&R.rightOn(m.at(S+1),m.at(S),m.at(x))&&(l=D(m.at(S+1),m.at(S),m.at(x),m.at(x+1)),R.left(m.at(S-1),m.at(S),l)&&(c=R.sqdist(m.vertices[S],l))<p&&(p=c,n=l,f=x));if(d==(f+1)%this.vertices.length)l[0]=(a[0]+n[0])/2,l[1]=(a[1]+n[1])/2,i.push(l),S<f?(g.append(m,S,f+1),g.vertices.push(l),v.vertices.push(l),0!=d&&v.append(m,d,m.vertices.length),v.append(m,0,S+1)):(0!=S&&g.append(m,S,m.vertices.length),g.append(m,0,f+1),g.vertices.push(l),v.vertices.push(l),v.append(m,d,S+1));else{if(f<d&&(f+=this.vertices.length),u=Number.MAX_VALUE,f<d)return t;for(x=d;x<=f;++x)R.leftOn(m.at(S-1),m.at(S),m.at(x))&&R.rightOn(m.at(S+1),m.at(S),m.at(x))&&(c=R.sqdist(m.at(S),m.at(x)))<u&&(u=c,y=x%this.vertices.length);S<y?(g.append(m,S,y+1),0!=y&&v.append(m,y,b.length),v.append(m,0,S+1)):(0!=S&&g.append(m,S,b.length),g.append(m,0,y+1),v.append(m,y,S+1))}return g.vertices.length<v.vertices.length?(g.quickDecomp(t,e,i,r,o,s),v.quickDecomp(t,e,i,r,o,s)):(v.quickDecomp(t,e,i,r,o,s),g.quickDecomp(t,e,i,r,o,s)),t}return t.push(this),t},A.prototype.removeCollinearPoints=function(t){for(var e=0,i=this.vertices.length-1;3<this.vertices.length&&0<=i;--i)R.collinear(this.at(i-1),this.at(i),this.at(i+1),t)&&(this.vertices.splice(i%this.vertices.length,1),i--,e++);return e}},{"./Line":78,"./Point":79,"./Scalar":81}],81:[function(t,e,i){"use strict";function r(){}(e.exports=r).eq=function(t,e,i){return i=i||0,Math.abs(t-e)<i}},{}],82:[function(t,e,i){"use strict";e.exports={Polygon:t("./Polygon"),Point:t("./Point")}},{"./Point":79,"./Polygon":80}],83:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r,n=(r=t("./Component"))&&r.__esModule?r:{default:r},a=t("./main");function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function p(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e,i){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=d(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(i):o.value}})(t,e,i||t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(s){return function(){var t,e,i,r=d(s);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return;if(Reflect.construct.sham)return;if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}()){var o=d(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return e=this,!(i=t)||"object"!==l(i)&&"function"!=typeof i?f(e):i}}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var o=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(s,n["default"]);var t,e,i,o=u(s);function s(t,e,i){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),e.flipH=i.flipX,e.flipV=i.flipY,e.flipR=i.flipR,(r=o.call(this,t,e,"POWERED_ALT")).dirMaps=[(0,a.GetAltSwitchDirMapFromDir)(i.dir),(0,a.GetAltSwitchDirMapFromDir)(i.alt)],r.chargesRequired=i.chargesRequired,r.currentMap=0,r.SetBarDirections(i),r.chargeProgress=r.AddProgressBar(r.chargeBarDir,{bg:a.COLOURS.barBg,fg:a.COLOURS.chargeBarFg}),r.decayProgress=r.AddProgressBar(r.decayBarDir,{bg:a.COLOURS.barBg,fg:a.COLOURS.decayBarFg}),r.SetupDecay(i),r.SwitchDirection(0),r.ResetProgressBars(),r.logging=!0,r.logName="ALT SWITCH",a.em.AddUpdate(f(r)),(0,a.consoleLog)("====== ALT SWITCH CONSTRUCTED ====="),(0,a.consoleLog)(f(r)),r}return t=s,(e=[{key:"GetFlippedDirection",value:function(){var t=[0,0],e=this.dirMaps[this.currentMap];return(0,a.consoleLog)("USE D MAP"),(0,a.consoleLog)(e),e.setDir===a.UP?t[1]=1:e.setDir===a.DOWN?t[1]=-1:e.setDir===a.RIGHT?t[0]=1:e.setDir===a.LEFT&&(t[0]=-1),t}},{key:"SwitchDirection",value:function(t){this.currentMap=t,this.spriteInfo.flipX=this.dirMaps[this.currentMap].flipX,this.spriteInfo.flipY=this.dirMaps[this.currentMap].flipY,this.spriteInfo.flipR=this.dirMaps[this.currentMap].flipR}},{key:"Update",value:function(t){h(d(s.prototype),"ChargeDecay",this).call(this,t)}},{key:"Charged",value:function(){var t=(this.currentMap+1)%this.dirMaps.length;t!==this.currentMap&&this.SwitchDirection(t)}}])&&p(t.prototype,e),i&&p(t,i),s}();i.default=o},{"./Component":87,"./main":107}],84:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r=s(t("./Component.js")),o=s(t("./Electron.js")),h=t("./main.js");function s(t){return t&&t.__esModule?t:{default:t}}function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(s){return function(){var t,e,i,r=l(s);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return;if(Reflect.construct.sham)return;if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}()){var o=l(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return e=this,!(i=t)||"object"!==n(i)&&"function"!=typeof i?f(e):i}}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(p,r["default"]);var t,e,i,l=u(p);function p(t,e,i,r,o,s){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p),(n=l.call(this,t,e,"BATTERY")).maxLostElectrons=s||0,n.speedMultiplier=1;var a=(0,h.getGameSpeed)();return n.lostElectrons=0,n.speedMultiplier=a.speed,n.tilePos=t,n.pulseTime=r,n.pulseSpeed=o,n.charges=i,n.pulseCount=0,n.pulseTimer=n.pulseTime,h.em.AddUpdate(f(n)),h.em.AddBattery(f(n)),n}return t=p,(e=[{key:"HasChargesLeft",value:function(){return this.pulseCount<this.charges}},{key:"Pulse",value:function(){var t=(0,h.getGameSpeed)(),e=new o.default({x:(this.tilePos.x+(this.spriteInfo.flipX?0:1.5))*h.PIXEL_SCALE,y:(this.tilePos.y+.5)*h.PIXEL_SCALE},{index:18,unchargedSprite:19,flipX:!1,flipY:!1,flipR:!1},this.pulseSpeed*t.speed);(e.parentBattery=this).pulseCount++,e.SetVelocity({x:t.speed*this.pulseSpeed*(this.spriteInfo.flipX?-1:1),y:0})}},{key:"ElectronLost",value:function(){this.lostElectrons++}},{key:"BatteryDepleted",value:function(){return(0,h.consoleLog)("Check battery depletion"),(0,h.consoleLog)("Max Lost electrons: "+this.maxLostElectrons+", Lost Electrons: "+this.lostElectrons),0<this.maxLostElectrons&&this.lostElectrons>=this.maxLostElectrons}},{key:"Update",value:function(t){this.pulseCount<this.charges&&(this.pulseTimer+=t*this.speedMultiplier,this.pulseTimer>=this.pulseTime&&(this.Pulse(),this.pulseTimer-=this.pulseTime,this.sprite++))}}])&&a(t.prototype,e),i&&a(t,i),p}();i.default=p},{"./Component.js":87,"./Electron.js":91,"./main.js":107}],85:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r,n=(r=t("./Component"))&&r.__esModule?r:{default:r},a=t("./main");function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function p(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e,i){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=d(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(i):o.value}})(t,e,i||t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(s){return function(){var t,e,i,r=d(s);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return;if(Reflect.construct.sham)return;if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}()){var o=d(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return e=this,!(i=t)||"object"!==l(i)&&"function"!=typeof i?f(e):i}}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var o=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(s,n["default"]);var t,e,i,o=u(s);function s(t,e,i){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(r=o.call(this,t,e,"POWERED")).isOn=!1,r.chargesRequired=i.chargesRequired,r.chargedSprite=i.chargedSprite,r.unchargedSprite=e.sprite,r.SetBarDirections(i),r.chargeProgress=r.AddProgressBar(r.chargeBarDir,{bg:a.COLOURS.barBg,fg:a.COLOURS.chargeBarFg}),0<i.chargeDecayTime&&(r.decayProgress=r.AddProgressBar(r.decayBarDir,{bg:a.COLOURS.barBg,fg:a.COLOURS.decayBarFg})),(0,a.consoleLog)("ASSIGN BULB PROG BARS"),(0,a.consoleLog)(r.chargeProgress),(0,a.consoleLog)(r.decayProgress),r.SetupDecay(i),r.ResetProgressBars(),a.em.AddBulb(f(r)),i.chargeDecayTime&&a.em.AddUpdate(f(r)),(0,a.consoleLog)("==== BULB CONSTRUCTED ===="),(0,a.consoleLog)(f(r)),r}return t=s,(e=[{key:"Decay",value:function(){(0,a.consoleLog)("BULB DECAY"),h(d(s.prototype),"Decay",this).call(this),a.em.QueueSound(a.SFX.bulbOff),this.isOn&&(this.isOn=!1,this.spriteInfo.index=this.unchargedSprite)}},{key:"IsLit",value:function(){return this.isOn}},{key:"Charged",value:function(){!1===this.isOn&&a.em.QueueSound(a.SFX.bulbOn),this.spriteInfo.index=this.chargedSprite,this.isOn=!0,a.em.CheckEndGame()}},{key:"Update",value:function(t){h(d(s.prototype),"ChargeDecay",this).call(this,t)}}])&&p(t.prototype,e),i&&p(t,i),s}();i.default=o},{"./Component":87,"./main":107}],86:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r,s=(r=t("./Label"))&&r.__esModule?r:{default:r},n=t("./main");function a(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=function(){function o(t,e,i,r){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),this.tileRect=t,"SIZE_TOGGLE"===i.type)e=(0,n.getGameSize)().name;else if("SPEED_TOGGLE"===i.type){e=(0,n.getGameSpeed)().name}this.label=new s.default(this.GetLabelPos(),e,4),this.options=i,this.colours=r,this.z=190,(this.hover=!1,n.consoleLog)("BUTTON CONSTRUCTED"),(0,n.consoleLog)(this),n.em.AddHover(this),i.endScreen?((0,n.consoleLog)("Add button to end screen"),n.em.AddEndScreenClickable(this)):n.em.AddClickable(this),n.em.AddRender(this)}var t,e,i;return t=o,(e=[{key:"GetLabelPos",value:function(){return{tileX:this.tileRect.x+.25,tileY:this.tileRect.y+.25}}},{key:"SetTileRect",value:function(t){this.tileRect=t,this.label.pos=this.GetLabelPos()}},{key:"Bounds",value:function(){return{x:this.tileRect.x*n.PIXEL_SCALE,y:this.tileRect.y*n.PIXEL_SCALE,w:this.tileRect.w*n.PIXEL_SCALE,h:this.tileRect.h*n.PIXEL_SCALE}}},{key:"Hover",value:function(t){this.GetIsVisible()&&t!==this.hover&&(this.hover=t)}},{key:"GetIsVisible",value:function(){return!this.hide}},{key:"Click",value:function(t){this.GetIsVisible()&&((0,n.consoleLog)("CLICKED BUTTON"),(0,n.consoleLog)(this),0===t&&("LVL"===this.options.type?((0,n.consoleLog)("Load Level: "+this.options.value),(this.hover=!1,n.LoadLevel)(this.options.value)):"SFX_TOGGLE"===this.options.type?n.em.soundControl.Toggle():"SPEED_TOGGLE"===this.options.type?(0,n.ToggleGameSpeed)():"SIZE_TOGGLE"===this.options.type?(0,n.ToggleGameSize)():"MENU_PREV"===this.options.type?this.options.menu.PrevPage():"MENU_NEXT"===this.options.type&&this.options.menu.NextPage()))}},{key:"SetIsVisible",value:function(t){this.hide=!t,this.label.hide=!t}},{key:"Draw",value:function(){paper(this.colours.shadow),rectf(this.tileRect.x*n.PIXEL_SCALE-2,this.tileRect.y*n.PIXEL_SCALE+4,this.tileRect.w*n.PIXEL_SCALE,this.tileRect.h*n.PIXEL_SCALE),paper(this.hover?this.colours.hover:this.colours.top),rectf(this.tileRect.x*n.PIXEL_SCALE,this.tileRect.y*n.PIXEL_SCALE,this.tileRect.w*n.PIXEL_SCALE,this.tileRect.h*n.PIXEL_SCALE)}}])&&a(t.prototype,e),i&&a(t,i),o}();i.default=o},{"./Label":94,"./main":107}],87:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r,s=(r=t("./ProgressBar"))&&r.__esModule?r:{default:r},n=t("./main");function a(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=function(){function o(t,e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),this.tilePos=t,this.spriteInfo=e,this.hide=!1,this.z=10,this.progressBars=[],this.chargeBarDir=n.UP,this.decayBarDir=n.UP,this.chargeProgress=null,this.decayProgress=null,this.decayMultiplier=1;var r=(0,n.getGameSpeed)();this.decayMultiplier=r.speed,this.chargesRequired=0,this.currentCharges=0,this.chargeDecayTime=0,this.chargeDecayTimer=0,this.resetOnFullyCharged=!1,this.decayWhenFull=!1,this.decayToZero=!1,this.chargeResetsDecay=!0,this.overcharge=!1,i&&n.em.AddPhys(this,{mass:1,position:this.GetPhysPosition(),isSensor:!0,tag:i,isKinematic:!0,colliderRect:{width:n.PIXEL_SCALE,height:n.PIXEL_SCALE}}),n.em.AddRender(this),n.em.AddComponent(this)}var t,e,i;return t=o,(e=[{key:"GetPhysPosition",value:function(){return[(this.tilePos.x+.5)*n.PIXEL_SCALE,-(this.tilePos.y+.5)*n.PIXEL_SCALE]}},{key:"SetupDecay",value:function(t){t.chargeDecayTime&&(this.chargeDecayTime=t.chargeDecayTime),t.decayWhenFull&&(this.decayWhenFull=t.decayWhenFull),t.decayToZero&&(this.decayToZero=t.decayToZero),(0,n.consoleLog)("RESET DECAY?"),(0,n.consoleLog)(t.chargeResetsDecay),null!=t.chargeResetsDecay&&(this.chargeResetsDecay=t.chargeResetsDecay),t.overrideDecayColour&&(this.decayProgress.colours.foreground=t.overrideDecayColour)}},{key:"SetBarDirections",value:function(t){t.chargeBarDir&&(this.chargeBarDir=(0,n.GetDirectionFromString)(t.chargeBarDir)),t.decayBarDir&&(this.decayBarDir=(0,n.GetDirectionFromString)(t.decayBarDir))}},{key:"AddProgressBar",value:function(t,e){var i=0;(0,n.consoleLog)("PROG COLOURS"),(0,n.consoleLog)(e);for(var r=0;r<this.progressBars.length;r++)this.progressBars[r].direction===t&&i++;var o=null;return t===n.UP||t===n.DOWN?o=new s.default({base:{x:this.tilePos.x*n.PIXEL_SCALE,y:this.tilePos.y*n.PIXEL_SCALE},x:0,y:(t===n.UP?-.25-3/16*i:1.125+3/16*i)*n.PIXEL_SCALE,w:n.PIXEL_SCALE,h:3},{background:e.bg,foreground:e.fg}):t!==n.LEFT&&t!==n.RIGHT||(o=new s.default({base:{x:this.tilePos.x*n.PIXEL_SCALE,y:this.tilePos.y*n.PIXEL_SCALE},x:(t===n.LEFT?-.25-3/16*i:1.125+3/16*i)*n.PIXEL_SCALE,y:0,w:3,h:n.PIXEL_SCALE,flip:!0},{background:e.bg,foreground:e.fg})),this.progressBars.push({direction:t,bar:o}),(0,n.consoleLog)("RETURN PROG BAR"),(0,n.consoleLog)(o),o}},{key:"ShouldDecay",value:function(){return 0<this.chargeDecayTime&&(this.decayWhenFull&&this.currentCharges>=this.chargesRequired||!1===this.decayWhenFull&&0<this.currentCharges)}},{key:"SetCharge",value:function(t){this.currentCharges=t,null!==this.chargeProgress&&this.chargeProgress.CalculateValue(this.currentCharges,this.chargesRequired)}},{key:"Decay",value:function(){this.decayToZero?this.SetCharge(0):this.SetCharge(this.currentCharges-1)}},{key:"ChargeDecay",value:function(t){!1===n.em.endScreenOn&&0<this.chargeDecayTime&&this.ShouldDecay()&&(this.chargeDecayTimer+=t*this.decayMultiplier,null!==this.decayProgress&&this.decayProgress.CalculateValue(this.chargeDecayTime-this.chargeDecayTimer,this.chargeDecayTime),this.chargeDecayTimer>=this.chargeDecayTime&&(this.Decay(),this.chargeDecayTimer=0))}},{key:"ResetProgressBars",value:function(){null!==this.chargeProgress&&this.chargeProgress.CalculateValue(this.currentCharges,this.chargesRequired),null!==this.decayProgress&&this.decayProgress.CalculateValue(this.chargeDecayTime-this.chargeDecayTimer,this.chargeDecayTime)}},{key:"Charged",value:function(){}},{key:"AddCharge",value:function(){this.logging&&(0,n.consoleLog)("TRY TO ADD CHARGE TO: "+this.logName);var t=!1;return 0<this.chargesRequired&&((this.overcharge||this.currentCharges<this.chargesRequired)&&(this.logging&&((0,n.consoleLog)("overcharge: "+this.overcharge),(0,n.consoleLog)("charges below required: "+(this.currentCharges<this.chargesRequired)),(0,n.consoleLog)("USED CHARGE TO POWER UP!")),this.SetCharge(this.currentCharges+1),t=!0),0<this.chargeDecayTime&&this.chargeResetsDecay&&(this.logging&&(0,n.consoleLog)("USED CHARGE TO RESET DECAY"),t=!(this.chargeDecayTimer=0)),(0,n.consoleLog)("Charges: "+this.currentCharges+"/"+this.chargesRequired),t&&this.currentCharges>=this.chargesRequired&&(this.logging&&(0,n.consoleLog)("Call charge!"),this.Charged(),this.resetOnFullyCharged&&this.SetCharge(0))),this.logging&&(0,n.consoleLog)("Return charged: "+t),t}},{key:"MoveToTile",value:function(t){this.logging&&((0,n.consoleLog)("Move to new tile: "),(0,n.consoleLog)(t)),this.tilePos.x=t.x,this.tilePos.y=t.y,this.logging&&((0,n.consoleLog)("Move progress bars..."),(0,n.consoleLog)(this.progressBars)),this.phys&&(this.phys.position=this.GetPhysPosition());for(var e=0;e<this.progressBars.length;e++)this.progressBars[e].bar.base.x=this.tilePos.x*n.PIXEL_SCALE,this.progressBars[e].bar.base.y=this.tilePos.y*n.PIXEL_SCALE}},{key:"Draw",value:function(){this.hide||(sprite(this.spriteInfo.index,this.tilePos.x*n.PIXEL_SCALE,this.tilePos.y*n.PIXEL_SCALE,this.spriteInfo.flipX,this.spriteInfo.flipY,this.spriteInfo.flipR),null!==this.chargeProgress&&this.chargeProgress.Draw(),null!==this.decayProgress&&this.ShouldDecay()&&this.decayProgress.Draw())}}])&&a(t.prototype,e),i&&a(t,i),o}();i.default=o},{"./ProgressBar":97,"./main":107}],88:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r,s=(r=t("./Component"))&&r.__esModule?r:{default:r},n=t("./main");function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(s){return function(){var t,e,i,r=c(s);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return;if(Reflect.construct.sham)return;if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}()){var o=c(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return e=this,!(i=t)||"object"!==a(i)&&"function"!=typeof i?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):i}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var o=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(o,s["default"]);var t,e,i,r=h(o);function o(t,e){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this,t,e,"DANGER_WIRE")}return t=o,(e=[{key:"ElectronIsSafe",value:function(t){return n.em.ElectronIsSafe(this.tilePos,t)}}])&&l(t.prototype,e),i&&l(t,i),o}();i.default=o},{"./Component":87,"./main":107}],89:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r,s=(r=t("./Component"))&&r.__esModule?r:{default:r},n=t("./main");function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(s){return function(){var t,e,i,r=u(s);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return;if(Reflect.construct.sham)return;if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}()){var o=u(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return e=this,!(i=t)||"object"!==a(i)&&"function"!=typeof i?c(e):i}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var o=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(o,s["default"]);var t,e,i,r=h(o);function o(t,e){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(i=r.call(this,t,e,"DIODE")).direction=(0,n.GetDiodeDirMapFromFlips)(e.flipX,e.flipY,e.flipR).dir,(0,n.consoleLog)("==== DIODE CONSTRUCTED ===="),(0,n.consoleLog)(c(i)),i}return t=o,(e=[{key:"AllowPassage",value:function(t){var e=!1;return(0,n.consoleLog)("Check Diode Passage:"),(0,n.consoleLog)(this.direction),(0,n.consoleLog)(t.phys.velocity),(this.direction===n.UP&&0<t.phys.velocity[1]||this.direction===n.DOWN&&t.phys.velocity[1]<0||this.direction===n.LEFT&&t.phys.velocity[0]<0||this.direction===n.RIGHT&&0<t.phys.velocity[0])&&(e=!0),e}}])&&l(t.prototype,e),i&&l(t,i),o}();i.default=o},{"./Component":87,"./main":107}],90:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r,o=(r=t("./Component"))&&r.__esModule?r:{default:r},l=t("./main");function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(t,e,i){return(p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(i):o.value}})(t,e,i||t)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(s){return function(){var t,e,i,r=f(s);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return;if(Reflect.construct.sham)return;if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}()){var o=f(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return e=this,!(i=t)||"object"!==n(i)&&"function"!=typeof i?u(e):i}}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var a=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(a,o["default"]);var t,e,i,n=c(a);function a(t,e,i,r){var o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(o=n.call(this,t,e,"POINTS")).validDirections=r,o.isControllable=i.isControllable;var s=(0,l.GetArrowDirMapFromName)(i.dir);return o.SetDirectionFromMap(s),(0,l.consoleLog)("DIR SWITCHER CONSTRUCTED"),(0,l.consoleLog)(u(o)),o.hover=!1,o.isControllable&&l.em.AddHover(u(o)),l.em.AddClickable(u(o)),o}return t=a,(e=[{key:"GetFlippedDirection",value:function(){var t=[0,0];return this.currentDirection===l.UP?t[1]=1:this.currentDirection===l.DOWN?t[1]=-1:this.currentDirection===l.RIGHT?t[0]=1:this.currentDirection===l.LEFT&&(t[0]=-1),t}},{key:"Bounds",value:function(){return{x:this.tilePos.x*l.PIXEL_SCALE,y:this.tilePos.y*l.PIXEL_SCALE,w:l.PIXEL_SCALE,h:l.PIXEL_SCALE}}},{key:"SetDirectionFromMap",value:function(t){this.spriteInfo.flipX=t.flipX,this.spriteInfo.flipY=t.flipY,this.spriteInfo.flipR=t.flipR,this.currentDirection=t.dir}},{key:"ChangeDir",value:function(t){var e=(0,l.GetArrowDirMapFromDir)(t);this.SetDirectionFromMap(e),l.em.QueueSound(l.SFX.arrowChange)}},{key:"IsValidDir",value:function(t){for(var e=!1,i=0;i<this.validDirections.length;i++)if(this.validDirections[i].dir===t){e=!0;break}return e}},{key:"Input",value:function(t){this.currentDirection!==t&&(this.IsValidDir(t)?this.ChangeDir(t):l.em.QueueSound(l.SFX.arrowDirectionInvalid))}},{key:"Hover",value:function(t){t!==this.hover&&(this.hover=t,this.hover&&l.em.QueueSound(l.SFX.hoverArrow))}},{key:"Draw",value:function(){p(f(a.prototype),"Draw",this).call(this),this.hover&&sprite(l.HOVER_SPRITE,this.tilePos.x*l.PIXEL_SCALE,this.tilePos.y*l.PIXEL_SCALE)}},{key:"NextValidDirection",value:function(t){for(var e=this.currentDirection,i=1;i<4;i++){var r=(this.currentDirection+i*t+4)%4;if((0,l.consoleLog)("IS "+r+" VALID?"),this.IsValidDir(r)){e=r;break}}return e}},{key:"Click",value:function(t){if(this.isControllable)if(l.em.Selected()!==this)l.em.SetSelected(this),l.em.QueueSound(l.SFX.selectArrow);else{var e=this.NextValidDirection(0===t?1:-1);this.ChangeDir(e)}}},{key:"ElectronIsSafe",value:function(t){return l.em.ElectronIsSafe(this.tilePos,t)}}])&&s(t.prototype,e),i&&s(t,i),a}();i.default=a},{"./Component":87,"./main":107}],91:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var o=t("./main");function s(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var r=function(){function r(t,e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),o.em.AddAnimateFunctions(this),this.parentBattery=null,this.frameTimer=0,this.currentAnimation=null,this.currentFrame=0,this.loopAnimation=!1,this.chargedSprite=e.chargedSprite,this.unchargedSprite=e.unchargedSprite,this.spriteInfo=e,this.isCharged=!0,this.logging=!1,this.speed=i,this.contact=null,this.approach=null,this.z=5,this.velocity={x:0,y:0},this.SetAnimation("ELECTRON_TRAVEL",!0),o.em.AddRender(this),o.em.AddPhys(this,{mass:1,position:[t.x,-t.y],tag:"ELECTRON",colliderRect:{width:o.PIXEL_SCALE/2,height:o.PIXEL_SCALE/2}}),o.em.AddUpdate(this),o.em.AddElectron(this)}var t,e,i;return t=r,(e=[{key:"AnimationFinished",value:function(t){(0,o.consoleLog)("Animation: "+t.name+" Ended!"),t.name.includes("ELECTRON_DESTROY")&&((0,o.consoleLog)("Delete this!"),this.Delete())}},{key:"UpdateFrame",value:function(){var t=this.currentAnimation.frames[this.currentFrame];this.spriteInfo.index=t.sprite,this.spriteInfo.flipX=t.flipX,this.spriteInfo.flipY=t.flipY,this.spriteInfo.flipR=t.flipR}},{key:"CompareCentre",value:function(t,e){var i=!1,r=0;if(this.approach){"X"===this.approach.axis?r=0:"Y"===this.approach.axis&&(r=1);var o=e.phys.position[r]-t.phys.position[r];Math.sign(o)!==this.approach.dir&&(i=!0)}else i=!0;return i}},{key:"GetXDiff",value:function(t,e){return e.phys.position[0]-t.phys.position[0]}},{key:"GetYDiff",value:function(t,e){return e.phys.position[1]-t.phys.position[1]}},{key:"SetContact",value:function(t){this.contact=t;var e=this.GetXDiff(this,t),i=this.GetYDiff(this,t);Math.abs(e)>Math.abs(i)?this.approach={axis:"X",dir:Math.sign(e)}:Math.abs(i)>Math.abs(e)?this.approach={axis:"Y",dir:Math.sign(i)}:(0,o.consoleLog)("Something has gone horribly wrong in Electron.SetContact")}},{key:"SetVelocity",value:function(t){this.velocity=t}},{key:"GetDirectionVector",value:function(){var t={x:0,y:0};return 0<this.phys.velocity[0]?t.x=1:this.phys.velocity[0]<0&&(t.x=-1),0<this.phys.velocity[1]?t.y=-1:this.phys.velocity[1]<0&&(t.y=1),t}},{key:"SnapToContact",value:function(t){this.reSnap=[];for(var e=0;e<t.phys.position.length;e++)this.phys.position[e]=t.phys.position[e],this.reSnap[e]=t.phys.position[e]}},{key:"Delete",value:function(){null!==this.parentBattery&&this.parentBattery.ElectronLost(),o.em.phys.removeBody(this.phys),o.em.RemoveUpdate(this),o.em.RemoveRender(this),o.em.RemoveElectron(this)}},{key:"Destroy",value:function(){(0,o.consoleLog)("ELECTRON DESTROY:");var t=0<Math.abs(this.phys.velocity[0])?"_H":"_V",e=this.isCharged?"CHARGED_ELECTRON_DESTROY":"UNCHARGED_ELECTRON_DESTROY";this.SetAnimation(e+t,!1),(0,o.consoleLog)(this.phys),this.phys.shapes=[],this.isCharged=!0,this.setDeleteSpeed=!0}},{key:"AlreadyDead",value:function(){return this.setDeleteSpeed}},{key:"Charge",value:function(){this.isCharged||(this.isCharged=!0,o.em.QueueSound(o.SFX.electronCharged))}},{key:"ChargeComponent",value:function(t){this.isCharged&&t.AddCharge()&&this.RemoveCharge()}},{key:"RemoveCharge",value:function(){this.isCharged=!1,o.em.QueueSound(o.SFX.chargeSpent)}},{key:"Update",value:function(t){if(this.Animate(t),this.phys.velocity=[this.velocity.x,this.velocity.y],this.contact){if(this.CompareCentre(this,this.contact)){var e=this.contact.GetFlippedDirection(this.phys.velocity);this.phys.setZeroForce(),this.SetVelocity({x:e[0]*this.speed,y:e[1]*this.speed}),this.SnapToContact(this.contact,e),"POWERED_ALT"===this.contact.phys.tag&&this.ChargeComponent(this.contact),this.contact=null}}else this.reSnap?(this.phys.position=this.reSnap,this.reSnap=null):this.setDeleteSpeed&&(this.phys.velocity[0]=.1*this.phys.velocity[0],this.phys.velocity[1]=.1*this.phys.velocity[1])}},{key:"Draw",value:function(){var t={x:this.phys.position[0]-.5*o.PIXEL_SCALE,y:-this.phys.position[1]-.5*o.PIXEL_SCALE};sprite(this.isCharged?this.spriteInfo.index:this.unchargedSprite,t.x,t.y,this.spriteInfo.flipX,this.spriteInfo.flipY,this.spriteInfo.flipR)}}])&&s(t.prototype,e),i&&s(t,i),r}();i.default=r},{"./main":107}],92:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=r(t("./Button")),a=r(t("./Label")),l=t("./main");function r(t){return t&&t.__esModule?t:{default:t}}function s(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=function(){function o(t,e,i,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),this.displayRect=t,this.mainText=e,this.additionalText=i,this.colours=r,(0,l.consoleLog)(this.colours),this.additionalLabels=[],this.levelOverMax=4,this.isWin=!1,this.z=1e3}var t,e,i;return t=o,(e=[{key:"Collapse",value:function(){l.em.RemoveRender(this.mainLabel);for(var t=0;t<this.additionalLabels.length;t++)l.em.RemoveRender(this.additionalLabels[t]);l.em.RemoveRender(this)}},{key:"ShowScreen",value:function(t,e){(0,l.consoleLog)("Electrons Left:"+e),(0,l.consoleLog)("Finished level: "+l.em.lvlNumber+" / "+l.em.maxLevel),this.isWin=t,this.mainLabel=new a.default(this.mainText.pos,t?this.mainText.winText:0===e?this.mainText.loseText:this.mainText.altLose,4),this.mainLabel.z=1010;var i=this.isWin||!1===this.isWin&&0===e?this.levelOverMax:this.additionalText.length;0==this.isWin&&0<e&&((0,l.consoleLog)("Add Tile for extra lines..."),this.displayRect.tileH+=1);for(var r=0;r<i;r++){var o=new a.default(this.additionalText[r].pos,this.additionalText[r].text,4);o.z=1010,this.additionalLabels.push(o)}if(this.isWin&&l.em.lvlNumber<l.em.maxLevel){(0,l.consoleLog)("DISPLAY RECT"),(0,l.consoleLog)(this.displayRect);var s={tileRect:{x:this.displayRect.tileX,y:this.displayRect.tileY+this.displayRect.tileH+.75,w:this.displayRect.tileW,h:1},text:"Next Level (Space)",options:{type:"LVL",value:(0,l.GetNumberedLevelName)(l.em.lvlNumber+1),endScreen:!0},colours:{shadow:3,top:7,hover:15}};(0,l.consoleLog)("Construct button:"),(0,l.consoleLog)(s),this.nextLevelButton=new n.default(s.tileRect,s.text,s.options,s.colours),this.nextLevelButton.SetIsVisible(!0)}l.em.AddRender(this)}},{key:"Draw",value:function(){var t=this.isWin?this.colours.win:this.colours.lose;paper(t.background),rectf((this.displayRect.tileX-.25)*l.PIXEL_SCALE,(this.displayRect.tileY+.5)*l.PIXEL_SCALE,this.displayRect.tileW*l.PIXEL_SCALE,this.displayRect.tileH*l.PIXEL_SCALE),paper(t.foreground),rectf(this.displayRect.tileX*l.PIXEL_SCALE,this.displayRect.tileY*l.PIXEL_SCALE,this.displayRect.tileW*l.PIXEL_SCALE,this.displayRect.tileH*l.PIXEL_SCALE)}}])&&s(t.prototype,e),i&&s(t,i),o}();i.default=o},{"./Button":86,"./Label":94,"./main":107}],93:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var o=r(t("./EndScreen.js")),l=t("./main.js"),s=r(t("./PauseMenu.js"));function r(t){return t&&t.__esModule?t:{default:t}}function n(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.electronLossThreshold=0,this.electronsLost=0,this.canShowEnd="title"!==l.CURRENT_LVL,this.bgColour=1,this.phys=t?null:new l.p2.World({gravity:[0,0]}),this.selector=null,this.map=null,this.renderers=[],this.updates=[],this.allComponents=[],this.menu=null,this.pause=!1,this.continued=!1,this.endScreenOn=!1,this.hovers=[],this.clickables=[],this.endScreenClickables=[],this.electrons=[],this.batteries=[],this.bulbs=[],this.endScreen=null,this.trackMouse=!1,this.selected=null,this.soundQueue=[],this.phys&&this.SetupPhys(),this.soundControl=l.SOUND,"title"===l.CURRENT_LVL&&this.AddRender(this.soundControl),this.AddUpdate(this.soundControl)}var t,i,r;return t=e,(i=[{key:"QueueSound",value:function(t,e){var i=0;e&&(i=e),this.soundQueue.push({sound:t,delay:i})}},{key:"AddComponent",value:function(t){this.allComponents.push(t)}},{key:"GetComponentOnTile",value:function(t){for(var e=null,i=0;i<this.allComponents.length;i++){var r=this.allComponents[i].tilePos;if(r&&r.x===t.x&&r.y===t.y){e=this.allComponents[i];break}}return e}},{key:"Initialise",value:function(){this.CreateNewEndScreenBox(),this.CreatePauseMenu()}},{key:"CreatePauseMenu",value:function(){this.pauseMenu=new s.default({tileX:4,tileY:3,tileW:6,tileH:4.5},[{pos:{tileX:5,tileY:3.1},text:"PAUSED"},{pos:{tileX:5,tileY:4},text:"Press R to"},{pos:{tileX:5.5,tileY:4.5},text:"Restart"},{pos:{tileX:5,tileY:5.25},text:"Press Space to"},{pos:{tileX:5.5,tileY:5.75},text:"Unpause"},{pos:{tileX:5,tileY:6.5},text:"Press Esc to"},{pos:{tileX:5.5,tileY:7},text:"return to menu"}],{background:13,foreground:14})}},{key:"CreateNewEndScreenBox",value:function(){this.endScreen=new o.default({tileX:4,tileY:3,tileW:6,tileH:3.5},{pos:{tileX:5,tileY:3.1},winText:"Congratulations!",loseText:"Game Over!",altLose:"Current too low!"},[{pos:{tileX:5,tileY:4},text:"Press R to"},{pos:{tileX:5,tileY:4.5},text:"Restart Level"},{pos:{tileX:5,tileY:5.25},text:"Press Esc to"},{pos:{tileX:5,tileY:5.75},text:"return to menu"},{pos:{tileX:5,tileY:6.5},text:"Press Space to"},{pos:{tileX:5,tileY:7},text:"Continue Regardless"}],{win:{background:3,foreground:7},lose:{background:12,foreground:9}})}},{key:"AddHover",value:function(t){!1===this.trackMouse&&(this.trackMouse=!0),this.hovers.push(t)}},{key:"Selected",value:function(){return this.selected}},{key:"SetSelected",value:function(t){if(null!==(this.selected=t)){var e=this.selected.Bounds();this.selector.position={x:e.x,y:e.y},this.selector.isActive=!0}else this.selector.isActive=!1}},{key:"Overlap",value:function(t,e,i){var r=t.Bounds(),o=r.x<e&&e<r.x+r.w,s=r.y<i&&i<r.y+r.h;return o&&s}},{key:"Input",value:function(){if(this.endScreenOn||this.pause)btnp.esc?(0,l.LoadLevel)("title"):btnp.reset?(0,l.LoadLevel)(l.CURRENT_LVL,!0):btnp.space&&(this.endScreenOn&&(this.endScreen.isWin?this.endScreen.nextLevelButton?this.endScreen.nextLevelButton.Click(0):(0,l.LoadLevel)("title"):(this.continued=!0,this.endScreen.Collapse(),this.CreateNewEndScreenBox())),this.pause=!1,this.endScreenOn=!1,this.pauseMenu.Show(!1));else{var t=-1;btnp.up||btnp.up_alt?t=l.UP:btnp.right||btnp.right_alt?t=l.RIGHT:btnp.down||btnp.down_alt?t=l.DOWN:(btnp.left||btnp.left_alt)&&(t=l.LEFT),0<=t&&null!==this.selected&&this.selected.Input&&this.selected.Input(t),this.canShowEnd&&(btnp.esc||btnp.reset||btnp.space)&&(this.pause=!0,this.pauseMenu.Show(!0))}}},{key:"MouseMove",value:function(t,e){if(this.trackMouse)for(var i=0;i<this.hovers.length;i++)this.hovers[i].Hover(this.Overlap(this.hovers[i],t,e))}},{key:"MouseClick",value:function(t,e,i){if((0,l.consoleLog)("CLICK! "+t+", "+e+", "+i),this.endScreenOn){for(r=!1,o=0;o<this.endScreenClickables.length;o++)if(!this.endScreenClickables[o].hide&&this.Overlap(this.endScreenClickables[o],t,e)){this.endScreenClickables[o].Click(i),r=!0;break}r||this.SetSelected(null)}else{for(var r=!1,o=0;o<this.clickables.length;o++)if(!this.clickables[o].hide&&this.Overlap(this.clickables[o],t,e)){this.clickables[o].Click(i),r=!0;break}r||this.SetSelected(null)}}},{key:"CompareTags",value:function(t,e,i){return t.bodyA.tag===e&&t.bodyB.tag===i||t.bodyA.tag===i&&t.bodyB.tag===e}},{key:"BodyWithTag",value:function(t,e){var i=null;return t.bodyA.tag===e?i=t.bodyA:t.bodyB.tag===e&&(i=t.bodyB),i}},{key:"CheckElectronLeavingTag",value:function(t,e){var i=!0;if(this.CompareTags(t,"ELECTRON",e)){i=!1;var r=this.BodyWithTag(t,"ELECTRON");if(!r.obj.AlreadyDead()){var o=this.BodyWithTag(t,e);this.ElectronIsSafe(o.obj.tilePos,r.obj)||(console.log("DESTROY ELECTRONS (UNSAFE DANGER WIRE EXIT)"),this.QueueSound(l.SFX.electronLost),r.obj.Destroy())}}return!i}},{key:"SetupPhys",value:function(){var n=this;this.phys.on("beginContact",function(t){if(n.CompareTags(t,"ELECTRON","POINTS")){var e=n.BodyWithTag(t,"ELECTRON"),i=n.BodyWithTag(t,"POINTS");e.obj.SetContact(i.obj)}else if(n.CompareTags(t,"ELECTRON","POWERED")){e=n.BodyWithTag(t,"ELECTRON");var r=n.BodyWithTag(t,"POWERED");e.obj.ChargeComponent(r.obj)}else if(n.CompareTags(t,"ELECTRON","BATTERY")){(e=n.BodyWithTag(t,"ELECTRON")).obj.Charge()}else if(n.CompareTags(t,"ELECTRON","RECHARGE_BATTERY")){var o=n.BodyWithTag(t,"RECHARGE_BATTERY");e=n.BodyWithTag(t,"ELECTRON");o.obj.HasPulses()&&!1===e.obj.isCharged&&o.obj.ChargeWithPulse(e.obj)}else if(n.CompareTags(t,"ELECTRON","POWERED_ALT")){e=n.BodyWithTag(t,"ELECTRON"),r=n.BodyWithTag(t,"POWERED_ALT");e.obj.SetContact(r.obj)}else if(n.CompareTags(t,"ELECTRON","ELECTRON"))n.QueueSound(l.SFX.electronCollision),(0,l.consoleLog)("DESTROY ELECTRONS (COLLISION)"),t.bodyA.obj.Destroy(),t.bodyB.obj.Destroy();else if(n.CompareTags(t,"ELECTRON","WIRE_SWITCH")){if(!(e=n.BodyWithTag(t,"ELECTRON")).obj.AlreadyDead())n.BodyWithTag(t,"WIRE_SWITCH").obj.AllowPassage(e.obj)||(console.log("DESTROY ELECTRONS (SWITCH IN WRONG POSITION)"),n.QueueSound(l.SFX.electronLost),e.obj.Destroy())}else if(n.CompareTags(t,"ELECTRON","DIODE")){e=n.BodyWithTag(t,"ELECTRON");var s=n.BodyWithTag(t,"DIODE");(0,l.consoleLog)("Diode collision!"),s.obj.AllowPassage(e.obj)||((0,l.consoleLog)("Remove electron charge!"),e.obj.RemoveCharge())}}),this.phys.on("endContact",function(t){n.CheckElectronLeavingTag(t,"DANGER_WIRE")||n.CheckElectronLeavingTag(t,"POINTS")||n.CheckElectronLeavingTag(t,"POWERED")||n.CheckElectronLeavingTag(t,"POWERED_ALT")||n.CheckElectronLeavingTag(t,"DIODE")||n.CheckElectronLeavingTag(t,"BATTERY")||n.CheckElectronLeavingTag(t,"RECHARGE_BATTERY")||n.CheckElectronLeavingTag(t,"WIRED_SWITCH")}),this.phys.on("postStep",function(t){n.UpdateLoop(n.deltaTime)})}},{key:"AddClickable",value:function(t){this.clickables.push(t)}},{key:"AddEndScreenClickable",value:function(t){this.endScreenClickables.push(t)}},{key:"AddPhys",value:function(t,e){t.phys=new l.p2.Body({mass:e.mass,position:e.position,fixedRotation:!0}),t.phys.obj=t,e.tag&&(t.phys.tag=e.tag),e.isKinematic&&(t.phys.type=l.p2.Body.KINEMATIC);var i=new l.p2.Box(e.colliderRect);i.friction=0,e.isSensor&&(i.sensor=e.isSensor),t.phys.addShape(i),this.phys.addBody(t.phys)}},{key:"AddBulb",value:function(t){this.bulbs.push(t)}},{key:"AddElectron",value:function(t){this.electrons.push(t)}},{key:"RemoveElectron",value:function(t){for(var e=0;e<this.electrons.length;e++)if(this.electrons[e]===t){this.electrons.splice(e,1),this.electronsLost++;break}this.CheckEndGame()}},{key:"CheckEndGame",value:function(){if((0,l.consoleLog)("===== ENDGAME CHECK ====="),this.canShowEnd&&!1===this.endScreenOn){var t=0<this.electronLossThreshold&&this.electronsLost>=this.electronLossThreshold;(0,l.consoleLog)("");for(var e=!1,i=!1,r=0;r<this.batteries.length;r++)if(this.batteries[r].BatteryDepleted()){i=e=!0;break}if(!i&&(0===this.electrons.length||t&&!1===this.continued)){var o=!1;for(r=0;r<this.batteries.length;r++)if(this.batteries[r].HasChargesLeft()){o=!0;break}(0,l.consoleLog)("Charge remaining: "+o),(0,l.consoleLog)("Electron Threshold: "+t),(0,l.consoleLog)("Any battery depleted: "+e),(!o||t&&!1===this.continued)&&(i=!0)}i?(this.pause=!0,(0,l.consoleLog)("Game over!"),this.QueueSound(l.SFX.defeat,.5),this.endScreen.ShowScreen(!1,e?0:this.electrons.length),this.endScreenOn=!0):this.AllBulbsLit()&&((0,l.consoleLog)("You Win!"),this.QueueSound(l.SFX.victory,.5),this.endScreen.ShowScreen(!0),this.endScreenOn=!0)}}},{key:"AllBulbsLit",value:function(){for(var t=!0,e=0;e<this.bulbs.length;e++)if(!this.bulbs[e].IsLit()){t=!1;break}return t}},{key:"AddBattery",value:function(t){this.batteries.push(t)}},{key:"SortRenders",value:function(){this.renderers.sort(function(t,e){return t.z-e.z})}},{key:"AddRender",value:function(t){this.renderers.push(t),this.SortRenders()}},{key:"RemoveRender",value:function(t,e){for(var i=0;i<this.renderers.length;i++)if(this.renderers[i]===t){this.renderers.splice(i,1),e&&((0,l.consoleLog)("Renderer removed!"),(0,l.consoleLog)(t));break}this.SortRenders()}},{key:"AddUpdate",value:function(t){this.updates.push(t)}},{key:"RemoveUpdate",value:function(t){for(var e=0;e<this.updates.length;e++)if(this.updates[e]===t){this.updates.splice(e,1);break}}},{key:"AddAnimateFunctions",value:function(i){i.Animate=function(t){i.currentAnimation&&(i.frameTimer+=t,i.frameTimer>=i.currentAnimation.frameTime&&(i.frameTimer-=i.currentAnimation.frameTime,i.currentFrame=(i.currentFrame+1)%i.currentAnimation.frames.length,0===i.currentFrame&&!1===i.loopAnimation?i.AnimationFinished(i.currentAnimation):i.UpdateFrame()))},i.SetAnimation=function(t,e){i.loopAnimation=e,i.currentAnimation=(0,l.getAnimation)(t),i.currentFrame=0,i.frameTimer=0,i.UpdateFrame()}}},{key:"Render",value:function(){paper(this.bgColour),cls(),this.map&&this.map.draw(0,0);for(var t=0;t<this.renderers.length;t++)this.renderers[t].hide||this.renderers[t].Draw()}},{key:"UpdateLoop",value:function(t){for(var e=0;e<this.updates.length;e++)this.updates[e].Update(t)}},{key:"Update",value:function(t){this.pause||(this.deltaTime=t,this.phys?this.phys.step(t,t,20):this.UpdateLoop(t)),0<this.soundQueue.length&&(this.soundQueue[0].delay-=t,this.soundQueue[0].delay<=0&&(sfx(this.soundQueue[0].sound),this.soundQueue.splice(0,1)))}},{key:"CheckSafeTileDirection",value:function(t,e,i){for(var r=!1,o=0;o<l.ALL_DIR_SAFE_TILES.length;o++)l.ALL_DIR_SAFE_TILES[o]===t&&(r=!0);if(!r)for(o=0;o<l.SAFE_TILES.length;o++)if(l.SAFE_TILES[o]===t){var s=(0,l.GetTileSafePoints)(t,e);0===s.length&&(r=!0),(0<i.x&&s.includes("L")||i.x<0&&s.includes("R")||i.y<0&&s.includes("D")||0<i.y&&s.includes("U"))&&(r=!0);break}return r||(0,l.consoleLog)(" !!!!! NOT SAFE DESTINATION !!!!!"),r}},{key:"ElectronIsSafe",value:function(t,e){var i=!1,r=e.GetDirectionVector(),o={x:t.x+r.x,y:t.y+r.y},s=this.GetComponentOnTile(o);if(s)i=this.CheckSafeTileDirection(s.spriteInfo.index,s.spriteInfo,r);else{var n=this.map.get(o.x,o.y);if(n){var a=(0,l.GetSpriteInfoFromTile)(n.sprite,n);i=this.CheckSafeTileDirection(a.index,a,r)}}return i}}])&&n(t.prototype,i),r&&n(t,r),e}();i.default=a},{"./EndScreen.js":92,"./PauseMenu.js":96,"./main.js":107}],94:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var o=t("./main");function s(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var r=function(){function r(t,e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),this.pos=t,this.text=e,this.colour=i,this.z=200,o.em.AddRender(this)}var t,e,i;return t=r,(e=[{key:"Draw",value:function(){locate(0,0),pen(this.colour),print(this.text,this.pos.tileX*o.PIXEL_SCALE,this.pos.tileY*o.PIXEL_SCALE)}}])&&s(t.prototype,e),i&&s(t,i),r}();i.default=r},{"./main":107}],95:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a=r(t("./Button")),l=r(t("./Label")),p=t("./main");function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var s=function(){function n(t,e,i,r,o,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),this.position=t,this.currentPage=0,this.pageLength=e,this.buttonOptions=i,(0,p.consoleLog)(r),this.pagesLabel=new l.default({tileX:r.tileX,tileY:r.tileY},"NULL",r.colour),this.prevButton=new a.default(o.tileRect,o.text,{type:"MENU_PREV",menu:this},o.colours),this.nextButton=new a.default(s.tileRect,s.text,{type:"MENU_NEXT",menu:this},s.colours),this.buttons=[],(0,p.consoleLog)("MENU CONSTRUCTED"),(0,p.consoleLog)(this)}var t,e,i;return t=n,(e=[{key:"AddButton",value:function(t){var e=this.buttons.length,i=e%this.pageLength;(0,p.consoleLog)("Adding button: "+e),(0,p.consoleLog)("Position on page: "+i),t.SetTileRect({x:this.position.tileX,y:this.position.tileY+i*this.buttonOptions.ySpacing,w:this.buttonOptions.w,h:this.buttonOptions.h}),(0,p.consoleLog)("New tileRect: "),(0,p.consoleLog)(t.tileRect),this.buttons.push(t),this.totalPages=Math.ceil(this.buttons.length/this.pageLength)}},{key:"NextPage",value:function(){this.OpenPage(this.currentPage+1)}},{key:"PrevPage",value:function(){this.OpenPage(this.currentPage-1)}},{key:"OpenPage",value:function(t){this.currentPage=clamp(t,0,this.totalPages);for(var e=this.currentPage*this.pageLength,i=e+this.pageLength,r=0;r<this.buttons.length;r++){var o=e<=r&&r<i;this.buttons[r].SetIsVisible(o)}this.prevButton.SetIsVisible(0<this.currentPage),this.nextButton.SetIsVisible(this.currentPage<this.totalPages-1),this.pagesLabel.text=this.currentPage+1+" / "+this.totalPages}}])&&o(t.prototype,e),i&&o(t,i),n}();i.default=s},{"./Button":86,"./Label":94,"./main":107}],96:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r,n=(r=t("./Label.js"))&&r.__esModule?r:{default:r},a=t("./main.js");function o(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var s=function(){function s(t,e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),this.displayRect=t,this.textLines=e,this.colours=i,this.labels=[];for(var r=0;r<this.textLines.length;r++){var o=new n.default(this.textLines[r].pos,this.textLines[r].text,4);o.z=1010,this.labels.push(o)}a.em.AddRender(this),this.Hide(),this.z=1e3}var t,e,i;return t=s,(e=[{key:"Show",value:function(t){null==t&&(t=!0);for(var e=0;e<this.labels.length;e++)this.labels[e].hide=!t;this.hide=!t}},{key:"Hide",value:function(){this.Show(!1)}},{key:"Draw",value:function(){paper(this.colours.background),rectf((this.displayRect.tileX-.25)*a.PIXEL_SCALE,(this.displayRect.tileY+.5)*a.PIXEL_SCALE,this.displayRect.tileW*a.PIXEL_SCALE,this.displayRect.tileH*a.PIXEL_SCALE),paper(this.colours.foreground),rectf(this.displayRect.tileX*a.PIXEL_SCALE,this.displayRect.tileY*a.PIXEL_SCALE,this.displayRect.tileW*a.PIXEL_SCALE,this.displayRect.tileH*a.PIXEL_SCALE)}}])&&o(t.prototype,e),i&&o(t,i),s}();i.default=s},{"./Label.js":94,"./main.js":107}],97:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var o=t("./main");function s(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var r=function(){function i(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),t.base?this.base=t.base:this.base={x:0,y:0},this.rect=t,this.colours=e,this.SetValue(.5),this.flip=!1,t.flip&&(this.flip=t.flip),(0,o.consoleLog)("PROGRESS BAR CONSTRUCTED"),(0,o.consoleLog)(this)}var t,e,r;return t=i,(e=[{key:"SetValue",value:function(t){if(this.value!==t){this.value=t;var e=this.flip?this.rect.h:this.rect.w;this.filledWidth=clamp(e*this.value,0,e)}}},{key:"CalculateValue",value:function(t,e){0!==e?this.SetValue(t/e):(0,o.consoleLog)("Progress Bar Went wrong: "+t+" / "+e)}},{key:"DrawX",value:function(){return this.base.x+this.rect.x}},{key:"DrawY",value:function(){return this.base.y+this.rect.y}},{key:"Draw",value:function(){paper(this.colours.background),rectf(this.DrawX(),this.DrawY(),this.rect.w,this.rect.h),0<this.value&&(paper(this.colours.foreground),this.flip?rectf(this.DrawX(),Math.floor(this.DrawY()+this.rect.h-this.filledWidth),this.rect.w,Math.ceil(this.filledWidth)):rectf(this.DrawX(),this.DrawY(),this.filledWidth,this.rect.h))}}])&&s(t.prototype,e),r&&s(t,r),i}();i.default=r},{"./main":107}],98:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var o=t("./main");function s(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var r=function(){function i(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),this.tilePos=t,this.dirMap=e,this.z=2,o.em.AddPhys(this,{mass:1,position:[(this.tilePos.x+.5)*o.PIXEL_SCALE,-(this.tilePos.y+.5)*o.PIXEL_SCALE],isSensor:!0,tag:"POINTS",isKinematic:!0,colliderRect:{width:o.PIXEL_SCALE,height:o.PIXEL_SCALE}})}var t,e,r;return t=i,(e=[{key:"ElectronIsSafe",value:function(t){return o.em.ElectronIsSafe(this.tilePos,t)}},{key:"GetVert",value:function(){for(var t="",e=0;e<this.dirMap.dir.length;e++)if("U"===this.dirMap.dir[e]||"D"===this.dirMap.dir[e]){t=this.dirMap.dir[e];break}return t}},{key:"GetHoriz",value:function(){for(var t="",e=0;e<this.dirMap.dir.length;e++)if("L"===this.dirMap.dir[e]||"R"===this.dirMap.dir[e]){t=this.dirMap.dir[e];break}return t}},{key:"GetFlippedDirection",value:function(t){var e=this.GetHoriz(),i=this.GetVert();return Math.abs(t[0])>Math.abs(t[1])?(0<t[0]&&"L"===e||t[0]<0&&"R"===e?t[1]="U"===i?1:-1:(0<t[0]&&"R"===e||t[0]<0&&"L"===e)&&(t[1]="U"===i?-1:1),t[0]=0):Math.abs(t[1])>Math.abs(t[0])&&(0<t[1]&&"D"===i||t[1]<0&&"U"===i?t[0]="R"===e?1:-1:0<t[1]&&"U"===i||t[1]<0&&"D"===i?t[0]="R"===e?-1:1:(0,o.consoleLog)("X NOT SET!"),t[1]=0),t}}])&&s(t.prototype,e),r&&s(t,r),i}();i.default=r},{"./main":107}],99:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r=o(t("./Component")),n=o(t("./Electron.js")),a=t("./main");function o(t){return t&&t.__esModule?t:{default:t}}function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function p(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e,i){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=d(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(i):o.value}})(t,e,i||t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(s){return function(){var t,e,i,r=d(s);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return;if(Reflect.construct.sham)return;if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}()){var o=d(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return e=this,!(i=t)||"object"!==l(i)&&"function"!=typeof i?f(e):i}}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var s=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(s,r["default"]);var t,e,i,o=u(s);function s(t,e,i){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(r=o.call(this,t,e,"RECHARGE_BATTERY")).overcharge=!0,r.chargesRequired=i.chargesRequired,r.pulseSpeed=i.pulseSpeed,r.chargedSprite=49,r.unchargedSprite=48,r.blinkTime=i.blinkTime,r.blinkTimer=0,r.pulseCount=0,r.maxPulses=i.maxPulses,r.SetupDecay(i),r.decayWhenFull=!0,r.chargeResetsDecay=!1,r.chargeProgress=r.AddProgressBar((0,a.GetDirectionFromString)(i.chargeBarDir),{bg:a.COLOURS.barBg,fg:a.COLOURS.chargeBarFg}),r.pulsesBar=r.AddProgressBar((0,a.GetDirectionFromString)(i.pulseBarDir),{bg:a.COLOURS.barBg,fg:7}),r.decayProgress=r.AddProgressBar((0,a.GetDirectionFromString)(i.decayBarDir),{bg:a.COLOURS.barBg,fg:a.COLOURS.decayBarFg}),r.ResetProgressBars(),(0,a.consoleLog)("RECHARGE BATTERY CONSTRUCTED!"),(0,a.consoleLog)(f(r)),a.em.AddUpdate(f(r)),r}return t=s,(e=[{key:"ResetProgressBars",value:function(){h(d(s.prototype),"ResetProgressBars",this).call(this),this.pulsesBar.CalculateValue(this.pulseCount,this.maxPulses)}},{key:"Charged",value:function(){(0,a.consoleLog)("BATTERY CHARGED!!!!!"),this.spriteInfo.index=this.chargedSprite,this.pulseCount=this.pulseCount+1,this.pulseCount>this.maxPulses&&(this.pulseCount=this.maxPulses),this.UpdatePulseBar()}},{key:"UpdatePulseBar",value:function(){this.pulsesBar.CalculateValue(this.pulseCount,this.maxPulses)}},{key:"Pulse",value:function(){(0,a.consoleLog)("START | Electron pulse!"),(0,a.consoleLog)(this),this.pulseCount=this.pulseCount-1,this.pulseCount<0&&(this.pulseCount=0);var t=(0,a.getGameSpeed)(),e={x:(this.tilePos.x+(this.spriteInfo.flipX?0:1.5))*a.PIXEL_SCALE,y:(this.tilePos.y+.5)*a.PIXEL_SCALE};(0,a.consoleLog)("Spawn Electron at:"),(0,a.consoleLog)(e),new n.default({x:e.x,y:e.y},{index:18,unchargedSprite:19,flipX:!1,flipY:!1,flipR:!1},this.pulseSpeed*t.speed).SetVelocity({x:t.speed*this.pulseSpeed*(this.spriteInfo.flipX?-1:1),y:0}),(0,a.consoleLog)("END | Electron pulse!"),(0,a.consoleLog)(this)}},{key:"Update",value:function(t){h(d(s.prototype),"ChargeDecay",this).call(this,t),0<this.blinkTimer&&(this.blinkTimer-=t,this.blinkTimer<=0&&(this.blinkTimer=0,this.spriteInfo.index=this.chargedSprite))}},{key:"HasPulses",value:function(){return this.pulseCount}},{key:"ShouldDecay",value:function(){return 0<this.chargeDecayTime&&0<this.pulseCount}},{key:"Draw",value:function(){h(d(s.prototype),"Draw",this).call(this),this.pulsesBar.Draw()}},{key:"ChargeWithPulse",value:function(t){(0,a.consoleLog)("START | Charge with pulse!"),(0,a.consoleLog)(this),this.pulseCount=this.pulseCount-1,this.pulseCount<0&&(this.pulseCount=0),t.Charge(),(this.blinkTimer=0)===this.pulseCount&&(this.currentCharges=0,this.chargeDecayTimer=0),this.spriteInfo.index=this.unchargedSprite,0<this.pulseCount&&(this.blinkTimer=this.blinkTime),this.ResetProgressBars(),(0,a.consoleLog)("END | Charge with pulse!"),(0,a.consoleLog)(this)}},{key:"Decay",value:function(){h(d(s.prototype),"Decay",this).call(this),this.Pulse(),this.UpdatePulseBar(),0<this.pulseCount&&(this.blinkTimer=this.blinkTime),this.spriteInfo.index=this.unchargedSprite}}])&&p(t.prototype,e),i&&p(t,i),s}();i.default=s},{"./Component":87,"./Electron.js":91,"./main":107}],100:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var o=t("./main.js");function s(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var r=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.spriteIndex=t,this.position={x:0,y:0},this.isActive=!1,this.z=100,o.em.AddRender(this)}var t,i,r;return t=e,(i=[{key:"Draw",value:function(){this.isActive&&sprite(this.spriteIndex,this.position.x,this.position.y)}}])&&s(t.prototype,i),r&&s(t,r),e}();i.default=r},{"./main.js":107}],101:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r,o=(r=t("./Component"))&&r.__esModule?r:{default:r},a=t("./main");function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(s){return function(){var t,e,i,r=u(s);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return;if(Reflect.construct.sham)return;if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}()){var o=u(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return e=this,!(i=t)||"object"!==n(i)&&"function"!=typeof i?c(e):i}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var s=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(n,o["default"]);var t,e,i,s=h(n);function n(t,e,i){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(r=s.call(this,t,e)).shifterBoundaryTiles=[108,109,124],r.logName="SHIFTER",r.logging=!0,(0,a.consoleLog)(i),r.connections=i.connections,r.chargesRequired=i.chargesRequired,r.resetOnFullyCharged=!0,r.shiftDir=i.direction[0],r.shiftAmount=0,"+"===i.direction[1]?r.shiftAmount=1:"-"===i.direction[1]&&(r.shiftAmount=-1),console.log("constructed shfiter"),console.log(c(r));for(var o=0;o<i.connections.length;o++)(0,a.consoleLog)("Try to hide..."),(0,a.consoleLog)(i.connections[o]),a.em.map.remove(i.connections[o].tilePos.x,i.connections[o].tilePos.y);return r}return t=n,(e=[{key:"Charged",value:function(){(0,a.consoleLog)("========== SHIFTER FULLY CHARGED! ==========");for(var t=!0,e=[],i=0;i<this.connections.length;i++){var r=this.connections[i].tilePos,o={x:0,y:0};if("V"===this.shiftDir?(o.x=r.x,o.y=r.y+this.shiftAmount):"H"===this.shiftDir&&(o.x=r.x+this.shiftAmount,o.y=r.y),this.tilePos.x===o.x&&this.tilePos.y===o.y){t=!1;break}if(t){var s=a.em.map.get(o.x,o.y);if((0,a.consoleLog)(s),null!=s)for(var n=0;n<this.shifterBoundaryTiles.length;n++)if(s.sprite===this.shifterBoundaryTiles[n]){t=!1;break}}e.push(o)}if(t){(0,a.consoleLog)("Moving components..."),(0,a.consoleLog)(e);for(i=0;i<this.connections.length;i++)this.connections[i].MoveToTile(e[i])}}}])&&l(t.prototype,e),i&&l(t,i),n}();i.default=s},{"./Component":87,"./main":107}],102:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var o=t("./main");function s(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var r=function(){function i(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),this.spriteInfo=e,this.pos=t,this.soundOn=!0,audioManager.channels.sfx.volume=3,this.songElapsed=0,this.currentSong="",(this.isSongPlaying=!1,o.consoleLog)(assets.songs),this.titleSong=assets.songs.title,this.levelSongs=assets.songs.levels}var t,e,r;return t=i,(e=[{key:"PlayTitle",value:function(){this.PlaySong(this.titleSong)}},{key:"PlaySong",value:function(t){(this.currentSong!=t&&10<=this.songElapsed||!1===this.isSongPlaying)&&(this.songElapsed=0,this.soundOn&&patatracker.playSong(t),this.currentSong=t,this.isSongPlaying=!0)}},{key:"PlayRandomSong",value:function(){var t=random(this.levelSongs.length-1);this.PlaySong(this.levelSongs[t])}},{key:"SetOn",value:function(t){(0,o.consoleLog)("SWITCH SOUND: "+t),this.soundOn=t,(0,o.consoleLog)(audioManager),audioManager.muted=!t,t?this.PlaySong(this.titleSong):(patatracker.stop(),this.isSongPlaying=!1)}},{key:"Toggle",value:function(){this.SetOn(!this.soundOn)}},{key:"Update",value:function(t){this.soundOn&&(this.songElapsed+=t)}},{key:"Draw",value:function(){sprite(this.spriteInfo.speakerIndex,this.pos.tileX*o.PIXEL_SCALE,this.pos.tileY*o.PIXEL_SCALE),sprite(this.soundOn?this.spriteInfo.speakerOnIndex:this.spriteInfo.speakerOffIndex,(this.pos.tileX+1)*o.PIXEL_SCALE,this.pos.tileY*o.PIXEL_SCALE)}}])&&s(t.prototype,e),r&&s(t,r),i}();i.default=r},{"./main":107}],103:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r=t("./main"),n=o(t("./Component")),a=o(t("./TransistorEffect"));function o(t){return t&&t.__esModule?t:{default:t}}function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function p(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e,i){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(i):o.value}})(t,e,i||t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(s){return function(){var t,e,i,r=f(s);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return;if(Reflect.construct.sham)return;if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}()){var o=f(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return e=this,!(i=t)||"object"!==l(i)&&"function"!=typeof i?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):i}}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var s=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(s,n["default"]);var t,e,i,o=u(s);function s(t,e,i){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(r=o.call(this,t,e,"POWERED")).chargesRequired=i.chargesRequired,r.connections=i.connections,r.resetOnFullyCharged=!0,r.SetBarDirections(i),r.logging=!0,r.logName="TRANSISTOR",r.chargeProgress=r.AddProgressBar(r.chargeBarDir,{bg:4,fg:15}),r.ResetProgressBars(),r}return t=s,(e=[{key:"AddCharge",value:function(){var t=h(f(s.prototype),"AddCharge",this).call(this);return console.log("TRANSISTOR CHARGE:"+this.currentCharges+" / "+this.chargesRequired),t}},{key:"Charged",value:function(){(0,r.consoleLog)("Pulse to "+this.connections.length+" connections"),r.em.QueueSound(r.SFX.transistor),new a.default({x:this.tilePos.x,y:this.tilePos.y});for(var t=0;t<this.connections.length;t++)this.connections[t].AddCharge(),new a.default({x:this.connections[t].tilePos.x,y:this.connections[t].tilePos.y})}}])&&p(t.prototype,e),i&&p(t,i),s}();i.default=s},{"./Component":87,"./TransistorEffect":104,"./main":107}],104:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var o=t("./main");function s(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var r=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o.em.AddAnimateFunctions(this),this.centreTile=t,this.allSides=[],this.allCorners=[],this.coreAnim=(0,o.getAnimation)("TRANSISTOR_ANIM"),this.z=200,this.spriteInfo={corner:this.coreAnim.frames[0].corner,side:this.coreAnim.frames[0].side},this.tl=this.AddEffectTile(t.x-1,t.y-1,"TL"),this.tm=this.AddEffectTile(t.x,t.y-1,"TM"),this.tr=this.AddEffectTile(t.x+1,t.y-1,"TR"),this.ml=this.AddEffectTile(t.x-1,t.y,"ML"),this.mr=this.AddEffectTile(t.x+1,t.y,"MR"),this.bl=this.AddEffectTile(t.x-1,t.y+1,"BL"),this.bm=this.AddEffectTile(t.x,t.y+1,"BM"),this.br=this.AddEffectTile(t.x+1,t.y+1,"BR"),o.em.AddRender(this),o.em.AddUpdate(this),this.SetAnimation("TRANSISTOR_ANIM",!1)}var t,i,r;return t=e,(i=[{key:"UpdateFrame",value:function(){var t=this.currentAnimation.frames[this.currentFrame];this.spriteInfo.corner=t.corner,this.spriteInfo.side=t.side}},{key:"AnimationFinished",value:function(){o.em.RemoveRender(this),o.em.RemoveRender(this)}},{key:"AddEffectTile",value:function(t,e,i){var r={x:t,y:e,flipX:!1,flipY:!1,flipR:!1},o=!1;"TL"===i?o=r.flipX=!0:"TM"===i?(r.flipY=!0,r.flipR=!0):"TR"===i?o=!0:"ML"===i?r.flipX=!0:"MR"===i||("BL"===i?(o=!0,r.flipX=!0,r.flipY=!0):"BM"===i?r.flipR=!0:"BR"===i&&(o=!0,r.flipY=!0)),o?this.allCorners.push(r):this.allSides.push(r)}},{key:"Update",value:function(t){this.Animate(t)}},{key:"Draw",value:function(){for(var t=0;t<this.allSides.length;t++)sprite(this.spriteInfo.side,this.allSides[t].x*o.PIXEL_SCALE,this.allSides[t].y*o.PIXEL_SCALE,this.allSides[t].flipX,this.allSides[t].flipY,this.allSides[t].flipR);for(t=0;t<this.allCorners.length;t++)sprite(this.spriteInfo.corner,this.allCorners[t].x*o.PIXEL_SCALE,this.allCorners[t].y*o.PIXEL_SCALE,this.allCorners[t].flipX,this.allCorners[t].flipY,this.allCorners[t].flipR)}}])&&s(t.prototype,i),r&&s(t,r),e}();i.default=r},{"./main":107}],105:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r,s=(r=t("./Component"))&&r.__esModule?r:{default:r};t("./main");function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l(t,e,i){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=c(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(i):o.value}})(t,e,i||t)}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(s){return function(){var t,e,i,r=c(s);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return;if(Reflect.construct.sham)return;if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}()){var o=c(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return e=this,!(i=t)||"object"!==n(i)&&"function"!=typeof i?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):i}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var o=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(o,s["default"]);var t,e,i,r=h(o);function o(t,e){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(i=r.call(this,t,e)).logName="WIRE",i.logging=!0,i.railPoint=null,i}return t=o,(e=[{key:"SetRailPoint",value:function(t){this.railPoint=t}},{key:"MoveToTile",value:function(t){l(c(o.prototype),"MoveToTile",this).call(this,t),null!=this.railPoint&&(this.railPoint.tilePos.x=this.tilePos.x,this.railPoint.tilePos.y=this.tilePos.y,this.railPoint.phys.position=this.GetPhysPosition())}}])&&a(t.prototype,e),i&&a(t,i),o}();i.default=o},{"./Component":87,"./main":107}],106:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r,o=(r=t("./Component"))&&r.__esModule?r:{default:r},a=t("./main");function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(s){return function(){var t,e,i,r=c(s);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return;if(Reflect.construct.sham)return;if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}()){var o=c(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return e=this,!(i=t)||"object"!==n(i)&&"function"!=typeof i?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):i}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var s=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(n,o["default"]);var t,e,i,s=h(n);function n(t,e,i){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(r=s.call(this,t,e,"WIRE_SWITCH")).z=3,r.dirs=["H","V"],r.chargesRequired=i.chargesRequired,r.resetOnFullyCharged=!0;var o=(0,a.GetWireSwitchDirFromFlips)(e.flipX,e.flipY,e.flipR);return r.currentDirIndex=r.GetDirectionIndex(o.dir),r}return t=n,(e=[{key:"CurrentDirection",value:function(){return this.dirs[this.currentDirIndex]}},{key:"GetDirectionIndex",value:function(t){for(var e=-1,i=0;i<this.dirs.length;i++)if(this.dirs[i]===t){e=i;break}return e<0&&(0,a.consoleLog)("Something bad has happened in WireSwitch"),e}},{key:"AllowPassage",value:function(t){var e=!1;return"H"===this.CurrentDirection()?e=0<Math.abs(t.phys.velocity[0]):"V"===this.CurrentDirection()&&(e=0<Math.abs(t.phys.velocity[1])),e}},{key:"ChangeDirection",value:function(){this.currentDirIndex=(this.currentDirIndex+1)%this.dirs.length;var t=(0,a.GetWireSwitchDirFromDir)(this.CurrentDirection());this.spriteInfo.flipX=t.flipX,this.spriteInfo.flipY=t.flipY,this.spriteInfo.flipR=t.flipR}},{key:"Charged",value:function(){this.ChangeDirection()}}])&&l(t.prototype,e),i&&l(t,i),n}();i.default=s},{"./Component":87,"./main":107}],107:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.consoleLog=tt,i.GetArrowDirMapFromDir=function(t){for(var e=null,i=0;i<G.length;i++)if(G[i].dir===t){e=G[i];break}return e},i.GetArrowDirMapFromFlips=function(t,e,i){for(var r=null,o=0;o<G.length;o++)if(G[o].flipX===t&&G[o].flipY===e&&G[o].flipR===i){r=G[o];break}return console.log("Flips - X:"+t+", Y: "+e+", R: "+i),console.log(r),r},i.GetArrowDirMapFromName=function(t){for(var e=null,i=0;i<G.length;i++)if(G[i].name===t){e=G[i];break}return e},i.LoadLevel=at,i.GetAltSwitchDirMapFromDir=function(t){for(var e=null,i=0;i<j.length;i++)if(j[i].dir===t){e=j[i];break}return e},i.GetDirectionFromString=function(t){var e=0;"UP"===t?e=b:"DOWN"===t?e=Y:"RIGHT"===t?e=S:"LEFT"===t&&(e=H);return e},i.GetWireSwitchDirFromFlips=function(t,e,i){for(var r=null,o=0;o<U.length;o++)if(U[o].flipX===t&&U[o].flipY===e&&U[o].flipR===i){r=U[o];break}return r},i.GetWireSwitchDirFromDir=function(t){for(var e=null,i=0;i<U.length;i++)if(U[i].dir===t){e=U[i];break}return e},i.GetDiodeDirMapFromFlips=function(t,e,i){for(var r=null,o=0;o<N.length;o++)if(N[o].flipX===t&&N[o].flipY===e&&N[o].flipR===i){r=N[o];break}null===r&&(console.log("DIODE: Flips - X:"+t+", Y: "+e+", R: "+i),console.log(r));return r},i.GetTileSafePoints=function(t,e){for(var i="",r=0;r<Z.length;r++)if(Z[r].spriteIndex===t){for(var o=Z[r].map,s=0;s<o.length;s++)if(o[s].flipX===e.flipX&&o[s].flipY===e.flipY&&o[s].flipR===e.flipR){i=o[s].dir;break}break}return i},i.GetSpriteInfoFromTile=ot,i.ToggleGameSize=function(){(function(t){c=t;var e=document.getElementsByTagName("canvas")[0];e.style.width=d[t].windowDims,e.style.height=d[t].windowDims,p=d[t].mouseScale})((c+1)%d.length),at("title",!0)},i.ToggleGameSpeed=function(){f=(f+1)%u.length,at("title",!0)},i.getGameSpeed=function(){return u[f]},i.getGameSize=function(){return d[c]},i.getAnimation=function(t){for(var e=assets.animations.anims,i=null,r=0;r<e.length;r++)if(e[r].name===t){i=e[r];break}return i},i.GetNumberedLevelName=function(t){console.log("Find button: "+(O+t));for(var e=et(V),i="",r=0;r<e.components.length;r++)if("Button"===e.components[r].type){var o=e.components[r];if(o.text===O+t){tt("Point to level... "+(i=o.value));break}}return i},i.SOUND=i.VOL=i.SFX=i.COLOURS=i.LEFT=i.DOWN=i.RIGHT=i.UP=i.ALL_DIR_SAFE_TILES=i.SAFE_TILES=i.PIXEL_SCALE=i.TOTAL_SPRITES=i.CURRENT_LVL=i.HOVER_SPRITE=i.p2=i.em=void 0;var r=n(t("./EntityManager.js")),x=n(t("./Battery.js")),R=n(t("./Button.js")),A=n(t("./RailPoint.js")),D=n(t("./DirectionSwitcher.js")),o=n(t("./Selector.js")),B=n(t("./Bulb.js")),$=n(t("./Label.js")),w=n(t("./AltSwitch.js")),E=n(t("./Transistor.js")),C=n(t("./WireSwitch.js")),L=n(t("./Diode.js")),s=n(t("./SoundSettings.js")),T=n(t("./Menu.js")),P=n(t("./Shifter.js")),_=n(t("./Wire.js")),I=n(t("./DangerWire.js")),X=n(t("./RechargeableBattery.js"));function n(t){return t&&t.__esModule?t:{default:t}}var a=t("pixelbox/pointerEvents"),l=t("p2");i.p2=l;var p=1,V="title",O="Level ",h=0,c=2,u=[{name:"Slow",speed:.5},{name:"Normal",speed:1},{name:"Fast",speed:2}],f=1,d=[{name:"Small",windowDims:512,mouseScale:2},{name:"Medium",windowDims:768,mouseScale:4/3},{name:"Large",windowDims:1024,mouseScale:1}];i.ALL_DIR_SAFE_TILES=[5,6,16,17,23,32,39];var y,g;i.SAFE_TILES=[0,1,2,3,4,24,33,40,48,49,109],i.COLOURS=y,i.SFX=g;var v,m={tileX:.25,tileY:.25};i.SOUND=v;var b=i.VOL=0;i.UP=b;var S=1;i.RIGHT=S;var Y=2;i.DOWN=Y;var H=3;i.LEFT=H;var q=!(i.HOVER_SPRITE=36),k="";i.CURRENT_LVL=k;i.TOTAL_SPRITES=255;var M;i.PIXEL_SCALE=16,i.em=M;var F=!0,N=[{dir:b,flipX:!0,flipY:!1,flipR:!0},{dir:b,flipX:!1,flipY:!1,flipR:!0},{dir:S,flipX:!0,flipY:!1,flipR:!1},{dir:S,flipX:!0,flipY:!0,flipR:!1},{dir:Y,flipX:!0,flipY:!0,flipR:!0},{dir:Y,flipX:!1,flipY:!0,flipR:!0},{dir:H,flipX:!1,flipY:!1,flipR:!1},{dir:H,flipX:!1,flipY:!0,flipR:!1}],U=[{dir:"H",flipX:!1,flipY:!1,flipR:!1},{dir:"V",flipX:!1,flipY:!1,flipR:!0}],j=[{name:"LD",dir:"LD",setDir:H,flipX:!0,flipY:!1,flipR:!0},{name:"DL",dir:"DL",setDir:Y,flipX:!0,flipY:!0,flipR:!1},{name:"UR",dir:"UR",setDir:b,flipX:!1,flipY:!1,flipR:!1},{name:"UL",dir:"UL",setDir:b,flipX:!0,flipY:!1,flipR:!1},{name:"DR",dir:"DR",setDir:Y,flipX:!1,flipY:!0,flipR:!1},{name:"RD",dir:"RD",setDir:H,flipX:!1,flipY:!1,flipR:!0},{name:"RU",dir:"RU",setDir:H,flipX:!1,flipY:!0,flipR:!0},{name:"LU",dir:"LU",setDir:H,flipX:!0,flipY:!0,flipR:!0},{name:"RL",dir:"RL",setDir:S,flipX:!1,flipY:!1,flipR:!0},{name:"LR",dir:"LR",setDir:H,flipX:!0,flipY:!0,flipR:!0},{name:"UD",dir:"UD",setDir:b,flipX:!1,flipY:!1,flipR:!1},{name:"DU",dir:"DU",setDir:Y,flipX:!0,flipY:!0,flipR:!1}],G=[{name:"UP",dir:b,flipX:!1,flipY:!1,flipR:!1},{name:"RIGHT",dir:S,flipX:!1,flipY:!1,flipR:!0},{name:"DOWN",dir:Y,flipX:!1,flipY:!0,flipR:!1},{name:"LEFT",dir:H,flipX:!0,flipY:!1,flipR:!0}],W=[{dir:"LD",flipX:!1,flipY:!1,flipR:!1},{dir:"LU",flipX:!1,flipY:!1,flipR:!0},{dir:"LU",flipX:!1,flipY:!0,flipR:!1},{dir:"LD",flipX:!1,flipY:!0,flipR:!0},{dir:"DR",flipX:!0,flipY:!1,flipR:!1},{dir:"UR",flipX:!0,flipY:!1,flipR:!0},{dir:"UR",flipX:!0,flipY:!0,flipR:!1},{dir:"DR",flipX:!0,flipY:!0,flipR:!0}],z=[{dir:"LR",flipX:!1,flipY:!1,flipR:!1},{dir:"UD",flipX:!1,flipY:!1,flipR:!0},{dir:"LR",flipX:!1,flipY:!0,flipR:!1},{dir:"UD",flipX:!1,flipY:!0,flipR:!0},{dir:"LR",flipX:!0,flipY:!1,flipR:!1},{dir:"UD",flipX:!0,flipY:!1,flipR:!0},{dir:"LR",flipX:!0,flipY:!0,flipR:!1},{dir:"UD",flipX:!0,flipY:!0,flipR:!0}],Q=[{spriteId:0},{spriteId:1},{spriteId:2},{spriteId:3},{spriteId:4},{spriteId:5},{spriteId:9},{spriteId:16},{spriteId:23},{spriteId:24},{spriteId:32},{spriteId:33},{spriteId:109}],Z=[{spriteIndex:0,map:z},{spriteIndex:1,map:z},{spriteIndex:2,map:W},{spriteIndex:24,map:z},{spriteIndex:33,map:z},{spriteIndex:40,map:z},{spriteIndex:109,map:z}],K=[{type:"Battery",index:0},{type:"RechargeBattery",index:48},{type:"Direction",index:5,replaceSprite:6},{type:"AltSwitch",index:9},{type:"Corner",index:2},{type:"Bulb",index:16},{type:"Switch",index:23,replaceSprite:39},{type:"Diode",index:33},{type:"DangerWire",index:109},{type:"Shifter",index:93},{type:"Transistor",index:32}];function J(t,e,i){for(var r=null,o=0;o<W.length;o++){var s=W[o];if(s.flipX===t&&s.flipY===e&&s.flipR===i){r=s;break}}return null===r&&(tt("DIR MAP NOT FOUND!"),tt("GET DIR MAP: X: "+t+", Y:"+e+", R: "+i)),r}function tt(t){F&&console.log(t)}function et(t){for(var e=assets.mapDefs.mapDefs,i=null,r=0;r<e.length;r++)if(e[r].name===t){i=e[r];break}return i}function it(t){for(var e=!1,i=0;i<Q.length;i++)if(Q[i].spriteId===t.sprite){e=!0;break}return e}function rt(t,e){var i=[],r=[];tt(e),tt("GETTING ADJACENT TILES"),r.push({x:e.x,y:e.y-1,dir:b}),r.push({x:e.x+1,y:e.y,dir:S}),r.push({x:e.x,y:e.y+1,dir:Y}),r.push({x:e.x-1,y:e.y,dir:H});for(var o=0;o<r.length;o++){var s=t.get(r[o].x,r[o].y);null!==s&&(tt("Adjacent Tile:"),tt(s),it(s)&&i.push({dir:r[o].dir}))}return i}function ot(t,e){var i=null;return e&&(i={index:t,flipX:e.flipH,flipY:e.flipV,flipR:e.flipR}),i}function st(t){for(var e=getMap(t).copy(),i=[],r=[],o=function(){for(var t=0,e=0;e<K.length;e++)if("Corner"===K[e].type){t=K[e].index;break}return t}(),s=0;s<K.length;s++)for(var n=e.find(K[s].index),a=0;a<n.length;a++){var l=n[a];K[s].index===o?r.push(l):i.push({tileX:l.x,tileY:l.y,type:K[s].type,tileSprite:l.sprite,tileData:l})}M.map=e,tt("=== MAP DEFINITIONS ==="),tt(JSON.stringify(i)),tt("=======================");var p=et(t);M.lvlNumber=function(t){tt("==== GET LEVEL NUMBER FOR "+t+" ====");var e=0;if(t!==V)for(var i=et(V),r=0;r<i.components.length;r++)if(tt("Check component for being a level button..."),tt(i.components[r]),"Button"===i.components[r].type&&i.components[r].value===t){var o=i.components[r].text;tt("Found button for "+t+" Text: "+o);var s=o.substring(O.length,o.length);tt("NUM STRING: "+s),e=parseInt(s);break}return e}(t),M.maxLevel=function(){for(var t=0,e=et(V),i=0;i<e.components.length;i++){var r=!1;if("Button"===e.components[i].type){var o=e.components[i].text;if(o.length>O.length)o.substring(0,O.length)===O&&(r=!0);r&&t++}}return t}(),tt("LEVEL NUMBER: "+M.lvlNumber),tt("LEVEL COUNT: "+M.maxLevel),p.electronLossThreshold&&(M.electronLossThreshold=p.electronLossThreshold),tt("=== ADDITIONAL MAP DEF ==="),tt(p),tt("==========================");var h=[],c=[];for(s=0;s<r.length;s++)c.push(new A.default({x:r[s].x,y:r[s].y},J(r[s].flipH,r[s].flipV,r[s].flipR)));for(s=0;s<p.components.length;s++){var u=p.components[s];if(u.tileData){var f={x:u.tileX,y:u.tileY},d=ot(u.tileSprite,u.tileData),y=null;if("Direction"===u.type){tt("NEW DIRECTION SWITCHER");var g=rt(e,f);y=new D.default(f,d,u.direction,g)}else if("ShiftWire"===u.type){var v=e.get(f.x,f.y);tt("CONSTRUCT SHIFTWIRE");d=ot(v.sprite,v);y=new _.default(f,d),tt("New Comp"),tt(y),tt("Rail Points"),tt(c);for(var m=0;m<c.length;m++)if(c[m].tilePos.x===y.tilePos.x&&c[m].tilePos.y===y.tilePos.y){tt("ADDED RAIL POINT!"),y.SetRailPoint(c[m]);break}tt(v)}else if("DangerWire"===u.type)tt("CREATE A DANGER WIRE!"),y=new I.default(f,d);else if("Bulb"===u.type)y=new B.default(f,d,u.bulb);else if("Battery"===u.type)y=new x.default(f,d,u.battery.charges,u.battery.pulseTime,u.battery.pulseSpeed,u.battery.maxLostElectrons);else if("RechargeBattery"===u.type)y=new X.default(f,d,u.rechargeBattery);else if("AltSwitch"===u.type)y=new w.default(f,d,u.altSwitch);else if("Switch"===u.type)tt("Add wire Switch"),y=new C.default(f,d,u.wireSwitch);else if("Diode"===u.type)tt("Add diode"),y=new L.default(f,d);else if("Transistor"===u.type){tt("Add transistor"),tt("Added components:"),tt(h),u.transistor.connections=[];for(s=0;s<h.length;s++)h[s].src.transistorId===u.transistor.transistorId&&(tt("Adding transistor component: "),tt(h[s].obj),u.transistor.connections.push(h[s].obj));y=new E.default(f,d,u.transistor)}else if("Shifter"===u.type){tt("Add shifter"),u.shifter.connections=[];for(s=0;s<h.length;s++)h[s].src.shifterId===u.shifter.shifterId&&u.shifter.connections.push(h[s].obj);y=new P.default(f,d,u.shifter,e)}h.push({src:u,obj:y})}else if("Label"===u.type)new $.default(u.position,u.text,u.colour);else if("Button"===u.type){tt("ADD BUTTON");var b={};u.btn_type?b.type=u.btn_type:(b.value=u.value,b.type="LVL");var S=new R.default(u.tileRect,u.text,b,u.colours);null!==M.menu&&"LVL"===b.type&&(tt("ADD BUTTON TO MENU"),M.menu.AddButton(S))}else"Menu"===u.type&&(tt("ADD MENU"),M.menu=new T.default(u.position,u.pageLength,u.buttonOptions,u.pagesLabel,u.prevButton,u.nextButton))}}function nt(t,e){return{x:t*p,y:e*p}}function at(t,e){k===t&&!e||(M&&null!==M.menu&&(h=M.menu.currentPage),"title"===t?v.PlayTitle():v.PlayRandomSong(),i.CURRENT_LVL=k=t,tt("LOADING: "+t),i.em=M=new r.default,M.Initialise(),M.selector=new o.default(20),st(t),null!==M.menu&&M.menu.OpenPage(h))}a.onPress(function(t,e,i,r){var o=nt(t,e);M.MouseClick(o.x,o.y,r.button)}),a.onMove(function(t,e,i,r){var o=nt(t,e);M.MouseMove(o.x,o.y)}),i.update=function(){q||(paper(1),i.COLOURS=y=assets.colourMap,i.SFX=g=assets.soundMap,i.SOUND=v=new s.default(m,{speakerIndex:13,speakerOffIndex:14,speakerOnIndex:15}),v.soundOn=!1,at("title"),q=!0,v.PlaySong("bgm1")),M.Input(),M.Update(1/60),M.Render()}},{"./AltSwitch.js":83,"./Battery.js":84,"./Bulb.js":85,"./Button.js":86,"./DangerWire.js":88,"./Diode.js":89,"./DirectionSwitcher.js":90,"./EntityManager.js":93,"./Label.js":94,"./Menu.js":95,"./RailPoint.js":98,"./RechargeableBattery.js":99,"./Selector.js":100,"./Shifter.js":101,"./SoundSettings.js":102,"./Transistor.js":103,"./Wire.js":105,"./WireSwitch.js":106,p2:38,"pixelbox/pointerEvents":77}],108:[function(t,e,i){"function"==typeof Object.create?e.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(t,e){t.super_=e;function i(){}i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t}},{}],109:[function(t,e,i){e.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},{}],110:[function(t,e,f){var a=/%[sdj%]/g;f.format=function(t){if(!x(t)){for(var e=[],i=0;i<arguments.length;i++)e.push(l(arguments[i]));return e.join(" ")}i=1;for(var r=arguments,o=r.length,s=String(t).replace(a,function(t){if("%%"===t)return"%";if(o<=i)return t;switch(t){case"%s":return String(r[i++]);case"%d":return Number(r[i++]);case"%j":try{return JSON.stringify(r[i++])}catch(t){return"[Circular]"}default:return t}}),n=r[i];i<o;n=r[++i])b(n)||!p(n)?s+=" "+n:s+=" "+l(n);return s},f.deprecate=function(t,e){if(R(global.process))return function(){return f.deprecate(t,e).apply(this,arguments)};if(!0===process.noDeprecation)return t;var i=!1;return function(){if(!i){if(process.throwDeprecation)throw new Error(e);process.traceDeprecation?console.trace(e):console.error(e),i=!0}return t.apply(this,arguments)}};var r,o={};function l(t,e){var i={seen:[],stylize:n};return 3<=arguments.length&&(i.depth=arguments[2]),4<=arguments.length&&(i.colors=arguments[3]),m(e)?i.showHidden=e:e&&f._extend(i,e),R(i.showHidden)&&(i.showHidden=!1),R(i.depth)&&(i.depth=2),R(i.colors)&&(i.colors=!1),R(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=s),d(i,t,i.depth)}function s(t,e){var i=l.styles[e];return i?"["+l.colors[i][0]+"m"+t+"["+l.colors[i][1]+"m":t}function n(t,e){return t}function d(e,i,r){if(e.customInspect&&i&&$(i.inspect)&&i.inspect!==f.inspect&&(!i.constructor||i.constructor.prototype!==i)){var t=i.inspect(r,e);return x(t)||(t=d(e,t,r)),t}var o=function(t,e){if(R(e))return t.stylize("undefined","undefined");if(x(e)){var i="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(i,"string")}if(S(e))return t.stylize(""+e,"number");if(m(e))return t.stylize(""+e,"boolean");if(b(e))return t.stylize("null","null")}(e,i);if(o)return o;var s,n=Object.keys(i),a=(s={},n.forEach(function(t,e){s[t]=!0}),s);if(e.showHidden&&(n=Object.getOwnPropertyNames(i)),B(i)&&(0<=n.indexOf("message")||0<=n.indexOf("description")))return y(i);if(0===n.length){if($(i)){var l=i.name?": "+i.name:"";return e.stylize("[Function"+l+"]","special")}if(A(i))return e.stylize(RegExp.prototype.toString.call(i),"regexp");if(D(i))return e.stylize(Date.prototype.toString.call(i),"date");if(B(i))return y(i)}var p,h="",c=!1,u=["{","}"];v(i)&&(c=!0,u=["[","]"]),$(i)&&(h=" [Function"+(i.name?": "+i.name:"")+"]");return A(i)&&(h=" "+RegExp.prototype.toString.call(i)),D(i)&&(h=" "+Date.prototype.toUTCString.call(i)),B(i)&&(h=" "+y(i)),0!==n.length||c&&0!=i.length?r<0?A(i)?e.stylize(RegExp.prototype.toString.call(i),"regexp"):e.stylize("[Object]","special"):(e.seen.push(i),p=c?function(e,i,r,o,t){for(var s=[],n=0,a=i.length;n<a;++n)w(i,String(n))?s.push(g(e,i,r,o,String(n),!0)):s.push("");return t.forEach(function(t){t.match(/^\d+$/)||s.push(g(e,i,r,o,t,!0))}),s}(e,i,r,a,n):n.map(function(t){return g(e,i,r,a,t,c)}),e.seen.pop(),function(t,e,i){if(60<t.reduce(function(t,e){return 0<=e.indexOf("\n")&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0))return i[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+i[1];return i[0]+e+" "+t.join(", ")+" "+i[1]}(p,h,u)):u[0]+h+u[1]}function y(t){return"["+Error.prototype.toString.call(t)+"]"}function g(t,e,i,r,o,s){var n,a,l;if((l=Object.getOwnPropertyDescriptor(e,o)||{value:e[o]}).get?a=l.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):l.set&&(a=t.stylize("[Setter]","special")),w(r,o)||(n="["+o+"]"),a||(t.seen.indexOf(l.value)<0?-1<(a=b(i)?d(t,l.value,null):d(t,l.value,i-1)).indexOf("\n")&&(a=s?a.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+a.split("\n").map(function(t){return"   "+t}).join("\n")):a=t.stylize("[Circular]","special")),R(n)){if(s&&o.match(/^\d+$/))return a;n=(n=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(n=n.substr(1,n.length-2),t.stylize(n,"name")):(n=n.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),t.stylize(n,"string"))}return n+": "+a}function v(t){return Array.isArray(t)}function m(t){return"boolean"==typeof t}function b(t){return null===t}function S(t){return"number"==typeof t}function x(t){return"string"==typeof t}function R(t){return void 0===t}function A(t){return p(t)&&"[object RegExp]"===i(t)}function p(t){return"object"==typeof t&&null!==t}function D(t){return p(t)&&"[object Date]"===i(t)}function B(t){return p(t)&&("[object Error]"===i(t)||t instanceof Error)}function $(t){return"function"==typeof t}function i(t){return Object.prototype.toString.call(t)}function h(t){return t<10?"0"+t.toString(10):t.toString(10)}f.debuglog=function(e){if(R(r)&&(r=process.env.NODE_DEBUG||""),e=e.toUpperCase(),!o[e])if(new RegExp("\\b"+e+"\\b","i").test(r)){var i=process.pid;o[e]=function(){var t=f.format.apply(f,arguments);console.error("%s %d: %s",e,i,t)}}else o[e]=function(){};return o[e]},(f.inspect=l).colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},l.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},f.isArray=v,f.isBoolean=m,f.isNull=b,f.isNullOrUndefined=function(t){return null==t},f.isNumber=S,f.isString=x,f.isSymbol=function(t){return"symbol"==typeof t},f.isUndefined=R,f.isRegExp=A,f.isObject=p,f.isDate=D,f.isError=B,f.isFunction=$,f.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},f.isBuffer=t("./support/isBuffer");var c=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function w(t,e){return Object.prototype.hasOwnProperty.call(t,e)}f.log=function(){var t,e;console.log("%s - %s",(t=new Date,e=[h(t.getHours()),h(t.getMinutes()),h(t.getSeconds())].join(":"),[t.getDate(),c[t.getMonth()],e].join(" ")),f.format.apply(f,arguments))},f.inherits=t("inherits"),f._extend=function(t,e){if(!e||!p(e))return t;for(var i=Object.keys(e),r=i.length;r--;)t[i[r]]=e[i[r]];return t}},{"./support/isBuffer":109,inherits:108}],111:[function(d,t,e){"use strict";var i,r,c=d("."),o={dat:{palette:null,tilesheet:null,animations:{anims:[{name:"ELECTRON_TRAVEL_",frameTime:.08,frames:[{sprite:34,flipX:!1,flipY:!1,flipR:!1},{sprite:50,flipX:!1,flipY:!1,flipR:!1},{sprite:34,flipX:!1,flipY:!1,flipR:!0},{sprite:50,flipX:!1,flipY:!1,flipR:!0},{sprite:34,flipX:!1,flipY:!1,flipR:!1},{sprite:50,flipX:!0,flipY:!1,flipR:!0},{sprite:34,flipX:!1,flipY:!1,flipR:!0},{sprite:50,flipX:!0,flipY:!1,flipR:!1}]},{name:"ELECTRON_TRAVEL",frameTime:.12,frames:[{sprite:18,flipX:!1,flipY:!1,flipR:!1},{sprite:34,flipX:!1,flipY:!1,flipR:!1},{sprite:18,flipX:!1,flipY:!1,flipR:!1},{sprite:34,flipX:!1,flipY:!1,flipR:!0}]},{name:"CHARGED_ELECTRON_DESTROY_H",frameTime:.08,frames:[{sprite:18,flipX:!1,flipY:!1,flipR:!1},{sprite:34,flipX:!1,flipY:!1,flipR:!1},{sprite:66,flipX:!1,flipY:!1,flipR:!1},{sprite:66,flipX:!1,flipY:!1,flipR:!1},{sprite:18,flipX:!1,flipY:!1,flipR:!1},{sprite:34,flipX:!1,flipY:!1,flipR:!1},{sprite:82,flipX:!1,flipY:!1,flipR:!1},{sprite:98,flipX:!1,flipY:!1,flipR:!1},{sprite:114,flipX:!1,flipY:!1,flipR:!1}]},{name:"UNCHARGED_ELECTRON_DESTROY_H",frameTime:.12,frames:[{sprite:19,flipX:!1,flipY:!1,flipR:!1},{sprite:35,flipX:!1,flipY:!1,flipR:!1},{sprite:51,flipX:!1,flipY:!1,flipR:!1},{sprite:67,flipX:!1,flipY:!1,flipR:!1},{sprite:83,flipX:!1,flipY:!1,flipR:!1}]},{name:"CHARGED_ELECTRON_DESTROY_V",frameTime:.08,frames:[{sprite:18,flipX:!1,flipY:!1,flipR:!0},{sprite:34,flipX:!1,flipY:!1,flipR:!0},{sprite:66,flipX:!1,flipY:!1,flipR:!0},{sprite:66,flipX:!1,flipY:!1,flipR:!0},{sprite:18,flipX:!1,flipY:!1,flipR:!0},{sprite:34,flipX:!1,flipY:!1,flipR:!0},{sprite:82,flipX:!1,flipY:!1,flipR:!0},{sprite:98,flipX:!1,flipY:!1,flipR:!0},{sprite:114,flipX:!1,flipY:!1,flipR:!0}]},{name:"UNCHARGED_ELECTRON_DESTROY_V",frameTime:.12,frames:[{sprite:19,flipX:!1,flipY:!1,flipR:!0},{sprite:35,flipX:!1,flipY:!1,flipR:!0},{sprite:51,flipX:!1,flipY:!1,flipR:!0},{sprite:83,flipX:!1,flipY:!1,flipR:!0}]},{name:"TRANSISTOR_ANIM",frameTime:.16,frames:[{corner:56,side:72},{corner:57,side:73},{corner:58,side:74},{corner:59,side:75},{corner:56,side:72},{corner:57,side:73}]}]},bleeper:{_type:"Bleeper program",v:1,s:[{n:"changeArDir",i:[26,0,127,0],s:")W*)[*)`*)`()`&"},{n:"invArrDir",i:[26,0,127,0],s:")G()A()=%);$):$"},{n:"bulbOn_A",i:[26,0,127,0],s:"'L('Y('`('e('h&'h&'h%"},{n:"bulbOff_A",i:[26,0,127,0],s:"'h('e('`('Z('K&'K&'K%"},{n:"selectArr",i:[20,0,127,0],s:")Z()Z()U')U'"},{n:"hoverArr",i:[20,0,127,0],s:")[()[("},{n:"bulbOn_B",i:[29,0,127,0],s:"&X)&X)&X)&l)&l)&l&&l%"},{n:"bulbOff_B",i:[30,0,127,0],s:"&l)&l)&l)&X)&X)&X&&X&"},{n:"Victory",i:[53,0,127,0],s:"(a*(a*(a*(a*(Y*(Y*(a*(a*(a*(a*(f*(f*(f*(f*(j*(j*(j*(j'(j&"},{n:"Defeat",i:[53,0,127,0],s:"(I)(I)(I)(I)(H)(H)(H)(H)(G)(G)(G)(G)(F)(F)(F)(F)(F)(F)(F((F&"},{n:"electColl",i:[20,0,127,0],s:"*@)*>)*<)*:(*7(*5(*0'*-%"},{n:"chargeSpent",i:[20,0,127,0],s:"(b'(Y'(T'(L'(B'(=&(8&(5&(4&"},{n:"transistor",i:[44,0,127,0],s:"&H'&H'&P'&P'&^'&^'&P'&P'"},{n:"electLost",i:[37,0,127,0],s:"(B*(B*(B*(B*(;*(;*(;)(;&"},{n:"chargedUp",i:[20,0,127,0],s:"(F'(G'(J'(Q'(V&([&(a&(d&(f&(j&(k&"},{n:"transistorB",i:[20,0,127,0],s:")H&)H&)H#)H#)H#)H#)H%)H%)H#)H#)H$)H$)H#)H#)H#)H#)H$)H$)H#)H#)H$)H$)H#)H#)H#)H#)H$)H$)H#)H#)H$)H$"}]},colourMap:{barBg:4,chargeBarFg:15,decayBarFg:9,font:4},mapDefs:{mapDefs:[{name:"loopStorage",electronLossThreshold:1,components:[{tileX:5,tileY:2,type:"Battery",tileSprite:0,tileData:{x:5,y:2,sprite:0,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:4,pulseTime:5,pulseSpeed:50}},{tileX:5,tileY:8,type:"Direction",tileSprite:6,tileData:{x:5,y:8,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:5,tileY:10,type:"Direction",tileSprite:6,tileData:{x:5,y:10,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:7,tileY:10,type:"Direction",tileSprite:6,tileData:{x:7,y:10,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:7,tileY:12,type:"Direction",tileSprite:6,tileData:{x:7,y:12,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"UP"}},{tileX:9,tileY:8,type:"Direction",tileSprite:6,tileData:{x:9,y:8,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:9,tileY:10,type:"Direction",tileSprite:6,tileData:{x:9,y:10,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:11,tileY:10,type:"Direction",tileSprite:6,tileData:{x:11,y:10,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:11,tileY:12,type:"Direction",tileSprite:6,tileData:{x:11,y:12,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"UP"}},{tileX:3,tileY:10,type:"Bulb",tileSprite:16,tileData:{x:3,y:10,sprite:16,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},bulb:{chargesRequired:4,chargedSprite:17,chargeDecayTime:3,decayToZero:!0}}]},{name:"map",components:[{tileX:7,tileY:0,type:"Battery",tileSprite:0,tileData:{x:7,y:0,sprite:0,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:4,pulseTime:2,pulseSpeed:60}},{tileX:2,tileY:4,type:"Direction",tileSprite:6,tileData:{x:2,y:4,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"UP"}},{tileX:13,tileY:4,type:"Direction",tileSprite:6,tileData:{x:13,y:4,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:7,tileY:4,type:"Bulb",tileSprite:16,tileData:{x:7,y:4,sprite:16,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},bulb:{chargesRequired:5,chargedSprite:17}}]},{name:"title",components:[{type:"Menu",pageLength:5,position:{tileX:2,tileY:7.5},buttonOptions:{ySpacing:1.5,w:3,h:1},pagesLabel:{tileX:2.75,tileY:6.5,colour:4},prevButton:{text:"<",tileRect:{x:1,y:6,w:1,h:1},colours:{shadow:13,top:14,hover:15},colour:4},nextButton:{text:">",tileRect:{x:5,y:6,w:1,h:1},colours:{shadow:13,top:14,hover:15},colour:4}},{type:"Button",text:"Toggle Sound",btn_type:"SFX_TOGGLE",tileRect:{x:.25,y:1.375,w:3.5,h:.75},colours:{shadow:13,top:14,hover:15},colour:4},{type:"Label",text:"Game Speed:",position:{tileX:.25,tileY:2.5},colour:4},{type:"Button",text:"Normal",btn_type:"SPEED_TOGGLE",tileRect:{x:.25,y:3,w:3.5,h:.75},colours:{shadow:13,top:14,hover:15},colour:4},{type:"Label",text:"Game Size:",position:{tileX:.25,tileY:4.125},colour:4},{type:"Button",text:"Large",btn_type:"SIZE_TOGGLE",tileRect:{x:.25,y:4.625,w:3.5,h:.75},colours:{shadow:13,top:14,hover:15},colour:4},{type:"Button",text:"Level 1",value:"map",tileRect:{x:1.25,y:6,w:3,h:1},colours:{shadow:13,top:14,hover:15}},{type:"Button",text:"Level 2",value:"diode1",tileRect:{x:1.25,y:7.5,w:3,h:1},colours:{shadow:13,top:14,hover:15}},{type:"Button",text:"Level 3",value:"diode2",tileRect:{x:1.25,y:9,w:3,h:1},colours:{shadow:13,top:14,hover:15}},{type:"Button",text:"Level 4",value:"rechargeTest",tileRect:{x:1.25,y:10.5,w:3,h:1},colours:{shadow:13,top:14,hover:15}},{type:"Button",text:"Level 5",value:"switchTest",tileRect:{x:1.25,y:12,w:3,h:1},colours:{shadow:13,top:14,hover:15}},{type:"Button",text:"Level 6",value:"doubleSwitch",tileRect:{x:1.25,y:13.5,w:3,h:1},colours:{shadow:13,top:14,hover:15}},{type:"Button",text:"Level 7",value:"parallel",tileRect:{x:5,y:6,w:3,h:1},colours:{shadow:13,top:14,hover:15}},{type:"Button",text:"Level 8",value:"synchronise",tileRect:{x:5,y:7.5,w:3,h:1},colours:{shadow:13,top:14,hover:15}},{type:"Button",text:"Level 9",value:"decayTest",tileRect:{x:5,y:9,w:3,h:1},colours:{shadow:13,top:14,hover:15}},{type:"Button",text:"Level 10",value:"transistorTest",tileRect:{x:5,y:10.5,w:3,h:1},colours:{shadow:13,top:14,hover:15}},{type:"Button",text:"Level 11",value:"loopStorage",tileRect:{x:5,y:12,w:3,h:1},colours:{shadow:13,top:14,hover:15}},{type:"Button",text:"Level 12",value:"oppositeSwitch",tileRect:{x:5,y:13.5,w:3,h:1},colours:{shadow:13,top:14,hover:15}},{type:"Button",text:"Level 13",value:"alternatorLevel",tileRect:{x:5,y:13.5,w:3,h:1},colours:{shadow:13,top:14,hover:15}},{type:"Button",text:"Level 14",value:"transistorSwitchedAlt",tileRect:{x:5,y:13.5,w:3,h:1},colours:{shadow:13,top:14,hover:15}},{type:"Button",text:"Level 15",value:"splitterAlternatorTest",tileRect:{x:5,y:13.5,w:3,h:1},colours:{shadow:13,top:14,hover:15}},{type:"Button",text:"Level 16",value:"oneLifeSwitch",tileRect:{x:5,y:6,w:3,h:1},colours:{shadow:13,top:14,hover:15}},{type:"Button",text:"Level 17",value:"crossing",tileRect:{x:5,y:6,w:3,h:1},colours:{shadow:13,top:14,hover:15}},{type:"Button",text:"Level 18",value:"shifterTest",tileRect:{x:5,y:6,w:3,h:1},colours:{shadow:13,top:14,hover:15}},{type:"Button",text:"Level 19",value:"shifterPlay",tileRect:{x:5,y:6,w:3,h:1},colours:{shadow:13,top:14,hover:15}},{type:"Button",text:"Level 20",value:"shifterPlay2",tileRect:{x:5,y:6,w:3,h:1},colours:{shadow:13,top:14,hover:15}},{type:"Button",text:"Level 21",value:"chargedBattery",tileRect:{x:5,y:6,w:3,h:1},colours:{shadow:13,top:14,hover:15}},{type:"Button",text:"Level 22",value:"timeItOut",tileRect:{x:5,y:6,w:3,h:1},colours:{shadow:13,top:14,hover:15}},{type:"Button",text:"Level 23",value:"trickyShift",tileRect:{x:5,y:6,w:3,h:1},colours:{shadow:13,top:14,hover:15}},{type:"Button",text:"Level 24",value:"rechargeEasy",tileRect:{x:5,y:6,w:3,h:1},colours:{shadow:13,top:14,hover:15}},{type:"Button",text:"Level 25",value:"weirdWarps",tileRect:{x:5,y:6,w:3,h:1},colours:{shadow:13,top:14,hover:15}},{type:"Button",text:"Level 26",value:"overTheRainbow",tileRect:{x:5,y:6,w:3,h:1},colours:{shadow:13,top:14,hover:15}},{type:"Button",text:"Level 27",value:"Slide-A-Bulb",tileRect:{x:5,y:6,w:3,h:1},colours:{shadow:13,top:14,hover:15}},{type:"Label",text:"L-Click:",position:{tileX:9.25,tileY:6},colour:4},{type:"Label",text:"Select Arrow",position:{tileX:9.5,tileY:6.5},colour:4},{type:"Label",text:"Turn Arrow Clockwise",position:{tileX:9.5,tileY:7},colour:4},{type:"Label",text:"R-Click:",position:{tileX:9.25,tileY:8},colour:4},{type:"Label",text:"Turn Arrow Anti-Clockwise",position:{tileX:9.5,tileY:8.5},colour:4},{type:"Label",text:"Arrow Keys / WASD:",position:{tileX:9.25,tileY:9.5},colour:4},{type:"Label",text:"Change Arrow Direction",position:{tileX:9.5,tileY:10},colour:4},{type:"Label",text:"Goal:",position:{tileX:9.25,tileY:11},colour:4},{type:"Label",text:"- Point the electrons ",position:{tileX:9.5,tileY:11.5},colour:4},{type:"Label",text:"  in the right direction",position:{tileX:9.5,tileY:12},colour:4},{type:"Label",text:"- Light all the bulbs in ",position:{tileX:9.5,tileY:12.5},colour:4},{type:"Label",text:"  each level",position:{tileX:9.5,tileY:13},colour:4},{type:"Label",text:"Made with:",position:{tileX:10.75,tileY:14},colour:4},{type:"Label",text:"Cstoquer's PixelBox",position:{tileX:11.25,tileY:14.5},colour:4},{type:"Label",text:"schteppe's p2.js",position:{tileX:11.25,tileY:15},colour:4},{type:"Label",text:"Game by:",position:{tileX:10.75,tileY:.25},colour:4},{type:"Label",text:"Josh Haxell +",position:{tileX:11.25,tileY:.75},colour:4},{type:"Label",text:"Sammy El-Bahrawy",position:{tileX:11.25,tileY:1.25},colour:4},{tileX:7,tileY:4,type:"Battery",tileSprite:0,tileData:{x:6,y:4,sprite:0,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:4,pulseTime:2,pulseSpeed:60}},{tileX:7,tileY:1,type:"Bulb",tileSprite:16,tileData:{x:7,y:1,sprite:16,flipH:!0,flipV:!1,flipR:!0,flagA:!1,flagB:!1},bulb:{chargesRequired:5,chargedSprite:17}}]},{name:"alternatorLevel",components:[{tileX:2,tileY:1,type:"Battery",tileSprite:0,tileData:{x:2,y:1,sprite:0,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:4,pulseTime:2,pulseSpeed:60}},{tileX:0,tileY:4,type:"Direction",tileSprite:6,tileData:{x:0,y:4,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"UP"}},{tileX:6,tileY:1,type:"Direction",tileSprite:6,tileData:{x:6,y:1,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:6,tileY:4,type:"Direction",tileSprite:6,tileData:{x:6,y:4,sprite:5,flipH:!1,flipV:!0,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:10,tileY:4,type:"AltSwitch",tileSprite:7,tileData:{x:10,y:4,sprite:5,flipH:!1,flipV:!0,flipR:!1,flagA:!1,flagB:!1},altSwitch:{dir:"LD",alt:"DL",chargesRequired:3,chargeDecayTime:8,decayWhenFull:!0,chargeBarDir:"RIGHT",decayBarDir:"RIGHT",chargeResetsDecay:!1,decayToZero:!0,overrideDecayColour:7}},{tileX:3,tileY:6,type:"Bulb",tileSprite:16,tileData:{x:3,y:6,sprite:16,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},bulb:{chargesRequired:3,chargedSprite:17}},{tileX:1,tileY:6,type:"Diode",tileSprite:33,tileData:{x:1,y:6,sprite:33,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1}},{tileX:4,tileY:1,type:"Diode",tileSprite:33,tileData:{x:4,y:1,sprite:33,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1}}]},{name:"decayTest",components:[{tileX:5,tileY:1,type:"Battery",tileSprite:0,tileData:{x:5,y:1,sprite:0,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:1,pulseTime:2,pulseSpeed:60}},{tileX:6,tileY:3,type:"Direction",tileSprite:6,tileData:{x:6,y:3,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:9,tileY:1,type:"Direction",tileSprite:6,tileData:{x:9,y:1,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"RIGHT"}},{tileX:7,tileY:1,type:"Bulb",tileSprite:16,tileData:{x:7,y:1,sprite:16,flipH:!0,flipV:!0,flipR:!1,flagA:!1,flagB:!1},bulb:{chargesRequired:3,chargedSprite:17,chargeDecayTime:5}}]},{name:"transistorTest",electronLossThreshold:1,components:[{tileX:3,tileY:1,type:"Battery",tileSprite:0,tileData:{x:3,y:1,sprite:0,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:3,pulseTime:3,pulseSpeed:50}},{tileX:5,tileY:1,type:"Direction",tileSprite:6,tileData:{x:5,y:1,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"RIGHT"}},{tileX:5,tileY:5,type:"Direction",tileSprite:6,tileData:{x:5,y:5,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:7,tileY:1,type:"Direction",tileSprite:6,tileData:{x:7,y:1,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:7,tileY:5,type:"Direction",tileSprite:6,tileData:{x:7,y:5,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:5,tileY:3,type:"Bulb",tileSprite:16,tileData:{x:5,y:3,sprite:16,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},bulb:{chargesRequired:3,chargedSprite:17,chargeDecayTime:5,chargeBarDir:"LEFT",decayBarDir:"LEFT"}},{tileX:9,tileY:1,type:"Bulb",tileSprite:16,tileData:{x:9,y:1,sprite:16,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},bulb:{chargesRequired:1,chargedSprite:17,chargeDecayTime:5},transistorId:0},{tileX:7,tileY:3,type:"Transistor",tileSprite:32,tileData:{x:7,y:3,sprite:32,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:0,chargesRequired:3,chargeBarDir:"LEFT"}}]},{name:"switchTest",components:[{tileX:4,tileY:1,type:"Battery",tileSprite:0,tileData:{x:4,y:1,sprite:0,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:3,pulseTime:3,pulseSpeed:50}},{tileX:1,tileY:3,type:"Direction",tileSprite:6,tileData:{x:1,y:3,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"UP"}},{tileX:1,tileY:6,type:"Direction",tileSprite:6,tileData:{x:1,y:6,sprite:5,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"UP"}},{tileX:8,tileY:3,type:"Direction",tileSprite:6,tileData:{x:8,y:3,sprite:5,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:8,tileY:6,type:"Direction",tileSprite:6,tileData:{x:8,y:6,sprite:5,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:5,tileY:3,type:"Switch",tileSprite:39,tileData:{x:5,y:3,sprite:23,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},transistorId:0,wireSwitch:{chargesRequired:1}},{tileX:3,tileY:3,type:"Bulb",tileSprite:16,tileData:{x:3,y:3,sprite:16,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},bulb:{chargesRequired:3,chargedSprite:17,chargeBarDir:"UP"}},{tileX:5,tileY:9,type:"Transistor",tileSprite:32,tileData:{x:5,y:9,sprite:32,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:0,chargesRequired:3,chargeBarDir:"DOWN"}}]},{name:"doubleSwitch",components:[{tileX:7,tileY:1,type:"Battery",tileSprite:0,tileData:{x:7,y:1,sprite:0,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:5,pulseTime:1.2,pulseSpeed:60}},{tileX:2,tileY:2,type:"Direction",tileSprite:6,tileData:{x:2,y:2,sprite:5,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"UP"}},{tileX:2,tileY:4,type:"Direction",tileSprite:6,tileData:{x:2,y:4,sprite:5,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"UP"}},{tileX:2,tileY:6,type:"Direction",tileSprite:6,tileData:{x:2,y:6,sprite:5,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"UP"}},{tileX:12,tileY:2,type:"Direction",tileSprite:6,tileData:{x:12,y:2,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:12,tileY:4,type:"Direction",tileSprite:6,tileData:{x:12,y:4,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:12,tileY:6,type:"Direction",tileSprite:6,tileData:{x:12,y:6,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:6,tileY:4,type:"Bulb",tileSprite:16,tileData:{x:6,y:4,sprite:16,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},bulb:{chargesRequired:2,chargedSprite:17,chargeBarDir:"UP"}},{tileX:8,tileY:4,type:"Bulb",tileSprite:16,tileData:{x:8,y:4,sprite:16,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},bulb:{chargesRequired:2,chargedSprite:17,chargeBarDir:"UP"}},{tileX:4,tileY:4,type:"Switch",tileSprite:39,tileData:{x:4,y:4,sprite:23,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},transistorId:0,wireSwitch:{chargesRequired:1}},{tileX:10,tileY:4,type:"Switch",tileSprite:39,tileData:{x:10,y:4,sprite:23,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},transistorId:1,wireSwitch:{chargesRequired:1}},{tileX:0,tileY:4,type:"Transistor",tileSprite:32,tileData:{x:0,y:4,sprite:32,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:0,chargesRequired:3,chargeBarDir:"UP"}},{tileX:14,tileY:4,type:"Transistor",tileSprite:32,tileData:{x:14,y:4,sprite:32,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:1,chargesRequired:3,chargeBarDir:"DOWN"}}]},{name:"parallel",components:[{tileX:2,tileY:1,type:"Battery",tileSprite:0,tileData:{x:2,y:1,sprite:0,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:3,pulseTime:3,pulseSpeed:50}},{tileX:7,tileY:1,type:"Battery",tileSprite:0,tileData:{x:7,y:1,sprite:0,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:3,pulseTime:3,pulseSpeed:50}},{tileX:12,tileY:1,type:"Battery",tileSprite:0,tileData:{x:12,y:1,sprite:0,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:3,pulseTime:3,pulseSpeed:50}},{tileX:1,tileY:4,type:"Direction",tileSprite:6,tileData:{x:1,y:4,sprite:5,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"UP"}},{tileX:3,tileY:4,type:"Direction",tileSprite:6,tileData:{x:3,y:4,sprite:5,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:5,tileY:7,type:"Direction",tileSprite:6,tileData:{x:5,y:7,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"UP"}},{tileX:9,tileY:7,type:"Direction",tileSprite:6,tileData:{x:9,y:7,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:11,tileY:4,type:"Direction",tileSprite:6,tileData:{x:11,y:4,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"UP"}},{tileX:13,tileY:4,type:"Direction",tileSprite:6,tileData:{x:13,y:4,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:7,tileY:13,type:"Bulb",tileSprite:16,tileData:{x:7,y:13,sprite:16,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},bulb:{chargesRequired:5,chargedSprite:17,chargeBarDir:"UP"}},{tileX:5,tileY:10,type:"Switch",tileSprite:39,tileData:{x:5,y:10,sprite:23,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistorId:0,wireSwitch:{chargesRequired:1}},{tileX:9,tileY:10,type:"Switch",tileSprite:39,tileData:{x:9,y:10,sprite:23,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistorId:1,wireSwitch:{chargesRequired:1}},{tileX:2,tileY:7,type:"Transistor",tileSprite:32,tileData:{x:2,y:7,sprite:32,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:0,chargesRequired:3,chargeBarDir:"DOWN"}},{tileX:12,tileY:7,type:"Transistor",tileSprite:32,tileData:{x:12,y:7,sprite:32,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:1,chargesRequired:3,chargeBarDir:"DOWN"}}]},{name:"transistorSwitchedAlt",components:[{tileX:3,tileY:6,type:"Battery",tileSprite:0,tileData:{x:3,y:6,sprite:0,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:6,pulseTime:1,pulseSpeed:60}},{tileX:7,tileY:12,type:"Battery",tileSprite:0,tileData:{x:7,y:12,sprite:0,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:0,pulseTime:3,pulseSpeed:50}},{tileX:1,tileY:6,type:"Direction",tileSprite:6,tileData:{x:1,y:6,sprite:5,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"RIGHT"}},{tileX:1,tileY:10,type:"Direction",tileSprite:6,tileData:{x:1,y:10,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"UP"}},{tileX:5,tileY:6,type:"Direction",tileSprite:6,tileData:{x:5,y:6,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"RIGHT"}},{tileX:7,tileY:6,type:"Direction",tileSprite:6,tileData:{x:7,y:6,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"RIGHT"}},{tileX:9,tileY:6,type:"Direction",tileSprite:6,tileData:{x:9,y:6,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:9,tileY:10,type:"AltSwitch",tileSprite:7,tileData:{x:9,y:10,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},altSwitch:{dir:"LD",alt:"DL",chargesRequired:2,chargeDecayTime:8,decayWhenFull:!0,chargeBarDir:"RIGHT",decayBarDir:"RIGHT",chargeResetsDecay:!1,decayToZero:!0,overrideDecayColour:7},transistorId:1},{tileX:4,tileY:12,type:"Bulb",tileSprite:16,tileData:{x:4,y:12,sprite:16,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},bulb:{chargesRequired:5,chargedSprite:17,chargeBarDir:"UP"}},{tileX:11,tileY:6,type:"Switch",tileSprite:39,tileData:{x:11,y:6,sprite:23,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},transistorId:0,wireSwitch:{chargesRequired:1}},{tileX:2,tileY:12,type:"Diode",tileSprite:33,tileData:{x:2,y:12,sprite:33,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1}},{tileX:9,tileY:8,type:"Diode",tileSprite:33,tileData:{x:9,y:8,sprite:33,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1}},{tileX:6,tileY:4,type:"Transistor",tileSprite:32,tileData:{x:6,y:4,sprite:32,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:0,chargesRequired:3,chargeBarDir:"DOWN"}},{tileX:13,tileY:6,type:"Transistor",tileSprite:32,tileData:{x:13,y:6,sprite:32,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:1,chargesRequired:3,chargeBarDir:"DOWN"}}]},{name:"diode2",components:[{tileX:3,tileY:0,type:"Battery",tileSprite:0,tileData:{x:3,y:0,sprite:0,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:5,pulseTime:1,pulseSpeed:50}},{tileX:6,tileY:0,type:"Direction",tileSprite:6,tileData:{x:6,y:0,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:6,tileY:4,type:"Direction",tileSprite:6,tileData:{x:6,y:4,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:6,tileY:8,type:"Direction",tileSprite:6,tileData:{x:6,y:8,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:10,tileY:0,type:"Direction",tileSprite:6,tileData:{x:10,y:0,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"RIGHT"}},{tileX:10,tileY:8,type:"Direction",tileSprite:6,tileData:{x:10,y:8,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:14,tileY:0,type:"Direction",tileSprite:6,tileData:{x:14,y:0,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:14,tileY:4,type:"Direction",tileSprite:6,tileData:{x:14,y:4,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:14,tileY:8,type:"Direction",tileSprite:6,tileData:{x:14,y:8,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:10,tileY:4,type:"Bulb",tileSprite:16,tileData:{x:10,y:4,sprite:16,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},bulb:{chargesRequired:5,chargedSprite:17,chargeBarDir:"UP"}},{tileX:8,tileY:4,type:"Diode",tileSprite:33,tileData:{x:8,y:4,sprite:33,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1}},{tileX:10,tileY:2,type:"Diode",tileSprite:33,tileData:{x:10,y:2,sprite:33,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1}},{tileX:10,tileY:6,type:"Diode",tileSprite:33,tileData:{x:10,y:6,sprite:33,flipH:!1,flipV:!0,flipR:!0,flagA:!1,flagB:!1}},{tileX:12,tileY:4,type:"Diode",tileSprite:33,tileData:{x:12,y:4,sprite:33,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1}}]},{name:"diode1",components:[{tileX:3,tileY:0,type:"Battery",tileSprite:0,tileData:{x:3,y:0,sprite:0,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:5,pulseTime:1,pulseSpeed:50}},{tileX:0,tileY:3,type:"Direction",tileSprite:6,tileData:{x:0,y:3,sprite:5,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!1,dir:"UP"}},{tileX:5,tileY:7,type:"Direction",tileSprite:6,tileData:{x:5,y:7,sprite:5,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!1,dir:"LEFT"}},{tileX:7,tileY:0,type:"Direction",tileSprite:6,tileData:{x:7,y:0,sprite:5,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:9,tileY:5,type:"Direction",tileSprite:6,tileData:{x:9,y:5,sprite:5,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:2,tileY:7,type:"Bulb",tileSprite:16,tileData:{x:2,y:7,sprite:16,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},bulb:{chargesRequired:5,chargedSprite:17,chargeBarDir:"UP"}},{tileX:2,tileY:3,type:"Diode",tileSprite:33,tileData:{x:2,y:3,sprite:33,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1}},{tileX:5,tileY:3,type:"Diode",tileSprite:33,tileData:{x:5,y:3,sprite:33,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1}},{tileX:7,tileY:5,type:"Diode",tileSprite:33,tileData:{x:7,y:5,sprite:33,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1}},{tileX:11,tileY:5,type:"Diode",tileSprite:33,tileData:{x:11,y:5,sprite:33,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1}}]},{name:"synchronise",electronLossThreshold:1,components:[{tileX:2,tileY:0,type:"Battery",tileSprite:0,tileData:{x:2,y:0,sprite:0,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:6,pulseTime:.75,pulseSpeed:50}},{tileX:8,tileY:0,type:"Battery",tileSprite:0,tileData:{x:8,y:0,sprite:0,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:1,pulseTime:1,pulseSpeed:250}},{tileX:6,tileY:3,type:"Direction",tileSprite:6,tileData:{x:6,y:3,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"UP"}},{tileX:10,tileY:3,type:"Direction",tileSprite:6,tileData:{x:10,y:3,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:6,tileY:6,type:"Bulb",tileSprite:16,tileData:{x:6,y:6,sprite:16,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},bulb:{chargesRequired:1,chargedSprite:17,chargeBarDir:"RIGHT"}},{tileX:8,tileY:7,type:"Switch",tileSprite:39,tileData:{x:8,y:7,sprite:23,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},transistorId:0,wireSwitch:{chargesRequired:1}},{tileX:6,tileY:4,type:"Diode",tileSprite:33,tileData:{x:6,y:4,sprite:33,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1}},{tileX:4,tileY:12,type:"Transistor",tileSprite:32,tileData:{x:4,y:12,sprite:32,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:0,chargesRequired:3,chargeBarDir:"LEFT"}}]},{name:"splitterAlternatorTest",components:[{tileX:6,tileY:1,type:"Battery",tileSprite:0,tileData:{x:6,y:1,sprite:0,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:9,pulseTime:1.5,pulseSpeed:50}},{tileX:3,tileY:1,type:"Direction",tileSprite:6,tileData:{x:3,y:1,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"RIGHT"}},{tileX:3,tileY:10,type:"Direction",tileSprite:6,tileData:{x:3,y:10,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"UP"}},{tileX:3,tileY:12,type:"Direction",tileSprite:6,tileData:{x:3,y:12,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"UP"}},{tileX:6,tileY:7,type:"Direction",tileSprite:6,tileData:{x:6,y:7,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:6,tileY:10,type:"Direction",tileSprite:6,tileData:{x:6,y:10,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:6,tileY:12,type:"Direction",tileSprite:6,tileData:{x:6,y:12,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:6,tileY:14,type:"Direction",tileSprite:6,tileData:{x:6,y:14,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:10,tileY:1,type:"Direction",tileSprite:6,tileData:{x:10,y:1,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:10,tileY:4,type:"Direction",tileSprite:6,tileData:{x:10,y:4,sprite:5,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:10,tileY:10,type:"Direction",tileSprite:6,tileData:{x:10,y:10,sprite:5,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:10,tileY:12,type:"Direction",tileSprite:6,tileData:{x:10,y:12,sprite:5,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:10,tileY:14,type:"Direction",tileSprite:6,tileData:{x:10,y:14,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"UP"}},{tileX:13,tileY:1,type:"Direction",tileSprite:6,tileData:{x:13,y:1,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:13,tileY:4,type:"Direction",tileSprite:6,tileData:{x:13,y:4,sprite:5,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"RIGHT"}},{tileX:13,tileY:10,type:"Direction",tileSprite:6,tileData:{x:13,y:10,sprite:5,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:13,tileY:12,type:"Direction",tileSprite:6,tileData:{x:13,y:12,sprite:5,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:15,tileY:4,type:"Direction",tileSprite:6,tileData:{x:15,y:4,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"UP"}},{tileX:3,tileY:7,type:"AltSwitch",tileSprite:8,tileData:{x:3,y:7,sprite:9,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},altSwitch:{dir:"UD",alt:"DU",chargesRequired:1,chargeDecayTime:20,decayWhenFull:!0,chargeBarDir:"RIGHT",decayBarDir:"RIGHT",chargeResetsDecay:!1,decayToZero:!0,overrideDecayColour:7}},{tileX:10,tileY:7,type:"AltSwitch",tileSprite:8,tileData:{x:10,y:7,sprite:9,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},altSwitch:{dir:"RL",alt:"LR",chargesRequired:1,chargeDecayTime:20,decayWhenFull:!0,chargeBarDir:"RIGHT",decayBarDir:"RIGHT",chargeResetsDecay:!1,decayToZero:!0,overrideDecayColour:7}},{tileX:13,tileY:7,type:"AltSwitch",tileSprite:8,tileData:{x:13,y:7,sprite:9,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},altSwitch:{dir:"UD",alt:"DU",chargesRequired:1,chargeDecayTime:20,decayWhenFull:!0,chargeBarDir:"RIGHT",decayBarDir:"RIGHT",chargeResetsDecay:!1,decayToZero:!0,overrideDecayColour:7}},{tileX:8,tileY:14,type:"Bulb",tileSprite:16,tileData:{x:8,y:14,sprite:16,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},bulb:{chargesRequired:5,chargedSprite:17,chargeBarDir:"UP"}},{tileX:12,tileY:14,type:"Bulb",tileSprite:16,tileData:{x:12,y:14,sprite:16,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},bulb:{chargesRequired:5,chargedSprite:17,chargeBarDir:"UP"}},{tileX:12,tileY:1,type:"Diode",tileSprite:33,tileData:{x:12,y:1,sprite:33,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1}}]},{name:"oppositeSwitch",electronLossThreshold:3,components:[{tileX:6,tileY:6,type:"Battery",tileSprite:0,tileData:{x:6,y:6,sprite:0,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:4,pulseTime:2,pulseSpeed:40}},{tileX:8,tileY:4,type:"Battery",tileSprite:0,tileData:{x:8,y:4,sprite:0,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:0,pulseTime:2,pulseSpeed:60}},{tileX:8,tileY:8,type:"Battery",tileSprite:0,tileData:{x:8,y:8,sprite:0,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:0,pulseTime:2,pulseSpeed:60}},{tileX:1,tileY:6,type:"Direction",tileSprite:6,tileData:{x:1,y:6,sprite:5,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"RIGHT"}},{tileX:14,tileY:6,type:"Direction",tileSprite:6,tileData:{x:14,y:6,sprite:5,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"UP"}},{tileX:4,tileY:4,type:"Bulb",tileSprite:16,tileData:{x:4,y:4,sprite:16,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1},bulb:{chargesRequired:3,chargedSprite:17,chargeBarDir:"UP"}},{tileX:4,tileY:8,type:"Bulb",tileSprite:16,tileData:{x:4,y:8,sprite:16,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1},bulb:{chargesRequired:3,chargedSprite:17,chargeBarDir:"UP"}},{tileX:10,tileY:4,type:"Switch",tileSprite:39,tileData:{x:10,y:4,sprite:23,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistorId:0,wireSwitch:{chargesRequired:1}},{tileX:10,tileY:8,type:"Switch",tileSprite:39,tileData:{x:10,y:8,sprite:23,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},transistorId:0,wireSwitch:{chargesRequired:1}},{tileX:4,tileY:6,type:"Diode",tileSprite:33,tileData:{x:4,y:6,sprite:33,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1}},{tileX:9,tileY:6,type:"Transistor",tileSprite:32,tileData:{x:9,y:6,sprite:32,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:0,chargesRequired:3,chargeBarDir:"LEFT"}}]},{name:"rechargeTest",components:[{tileX:3,tileY:7,type:"Battery",tileSprite:0,tileData:{x:3,y:7,sprite:0,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:4,pulseTime:.5,pulseSpeed:40}},{tileX:6,tileY:2,type:"Battery",tileSprite:0,tileData:{x:6,y:2,sprite:0,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:0,pulseTime:2,pulseSpeed:40}},{tileX:11,tileY:7,type:"Battery",tileSprite:0,tileData:{x:11,y:7,sprite:0,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:0,pulseTime:2,pulseSpeed:40}},{tileX:0,tileY:7,type:"Direction",tileSprite:6,tileData:{x:0,y:7,sprite:5,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"RIGHT"}},{tileX:15,tileY:7,type:"Direction",tileSprite:6,tileData:{x:15,y:7,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"UP"}},{tileX:10,tileY:2,type:"Bulb",tileSprite:16,tileData:{x:10,y:2,sprite:16,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},bulb:{chargesRequired:4,chargedSprite:17,chargeBarDir:"UP"}},{tileX:1,tileY:2,type:"Diode",tileSprite:33,tileData:{x:1,y:2,sprite:33,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1}},{tileX:1,tileY:7,type:"Diode",tileSprite:33,tileData:{x:1,y:7,sprite:33,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1}},{tileX:6,tileY:7,type:"Diode",tileSprite:33,tileData:{x:6,y:7,sprite:33,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1}},{tileX:8,tileY:7,type:"Diode",tileSprite:33,tileData:{x:8,y:7,sprite:33,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1}},{tileX:14,tileY:7,type:"Diode",tileSprite:33,tileData:{x:14,y:7,sprite:33,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1}}]},{name:"oneLifeSwitch",components:[{tileX:2,tileY:1,type:"Battery",tileSprite:0,tileData:{x:2,y:1,sprite:0,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:1,pulseTime:.5,pulseSpeed:40}},{tileX:2,tileY:5,type:"Battery",tileSprite:0,tileData:{x:2,y:5,sprite:0,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:1,pulseTime:.5,pulseSpeed:40}},{tileX:4,tileY:9,type:"Battery",tileSprite:0,tileData:{x:4,y:9,sprite:0,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:3,pulseTime:.5,pulseSpeed:40}},{tileX:8,tileY:13,type:"Battery",tileSprite:0,tileData:{x:8,y:13,sprite:0,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:0,pulseTime:.5,pulseSpeed:40}},{tileX:4,tileY:1,type:"Direction",tileSprite:6,tileData:{x:4,y:1,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:4,tileY:5,type:"Direction",tileSprite:6,tileData:{x:4,y:5,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:6,tileY:1,type:"Direction",tileSprite:6,tileData:{x:6,y:1,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"RIGHT"}},{tileX:6,tileY:5,type:"Direction",tileSprite:6,tileData:{x:6,y:5,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"RIGHT"}},{tileX:6,tileY:11,type:"Direction",tileSprite:6,tileData:{x:6,y:11,sprite:5,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"RIGHT"}},{tileX:9,tileY:1,type:"Direction",tileSprite:6,tileData:{x:9,y:1,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:9,tileY:5,type:"Direction",tileSprite:6,tileData:{x:9,y:5,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:11,tileY:1,type:"Direction",tileSprite:6,tileData:{x:11,y:1,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"RIGHT"}},{tileX:11,tileY:5,type:"Direction",tileSprite:6,tileData:{x:11,y:5,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"RIGHT"}},{tileX:14,tileY:2,type:"Bulb",tileSprite:16,tileData:{x:14,y:2,sprite:16,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},bulb:{chargesRequired:1,chargedSprite:17,chargeBarDir:"RIGHT"}},{tileX:14,tileY:6,type:"Bulb",tileSprite:16,tileData:{x:14,y:6,sprite:16,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},bulb:{chargesRequired:1,chargedSprite:17,chargeBarDir:"RIGHT"}},{tileX:5,tileY:1,type:"Switch",tileSprite:39,tileData:{x:5,y:1,sprite:23,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},transistorId:0,wireSwitch:{chargesRequired:1}},{tileX:5,tileY:5,type:"Switch",tileSprite:39,tileData:{x:5,y:5,sprite:23,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},transistorId:1,wireSwitch:{chargesRequired:1}},{tileX:10,tileY:1,type:"Switch",tileSprite:39,tileData:{x:10,y:1,sprite:23,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},transistorId:1,wireSwitch:{chargesRequired:1}},{tileX:10,tileY:5,type:"Switch",tileSprite:39,tileData:{x:10,y:5,sprite:23,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},transistorId:0,wireSwitch:{chargesRequired:1}},{tileX:4,tileY:11,type:"Transistor",tileSprite:32,tileData:{x:4,y:11,sprite:32,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:0,chargesRequired:3,chargeBarDir:"UP"}},{tileX:8,tileY:11,type:"Transistor",tileSprite:32,tileData:{x:8,y:11,sprite:32,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:1,chargesRequired:3,chargeBarDir:"DOWN"}}]},{name:"crossing",components:[{tileX:1,tileY:5,type:"Battery",tileSprite:0,tileData:{x:1,y:5,sprite:0,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:6,pulseTime:.75,pulseSpeed:40,maxLostElectrons:5}},{tileX:7,tileY:1,type:"Battery",tileSprite:0,tileData:{x:7,y:1,sprite:0,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:3,pulseTime:.75,pulseSpeed:40,maxLostElectrons:5}},{tileX:0,tileY:3,type:"Direction",tileSprite:6,tileData:{x:0,y:3,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:3,tileY:3,type:"Direction",tileSprite:6,tileData:{x:3,y:3,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"RIGHT"}},{tileX:0,tileY:5,type:"Direction",tileSprite:6,tileData:{x:0,y:5,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"RIGHT"}},{tileX:3,tileY:5,type:"Direction",tileSprite:6,tileData:{x:3,y:5,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"RIGHT"}},{tileX:5,tileY:6,type:"Direction",tileSprite:6,tileData:{x:5,y:6,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"RIGHT"}},{tileX:7,tileY:4,type:"Direction",tileSprite:6,tileData:{x:7,y:4,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:7,tileY:8,type:"Direction",tileSprite:6,tileData:{x:7,y:8,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"RIGHT"}},{tileX:9,tileY:6,type:"Direction",tileSprite:6,tileData:{x:9,y:6,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"UP"}},{tileX:7,tileY:11,type:"Bulb",tileSprite:16,tileData:{x:7,y:11,sprite:16,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},bulb:{chargesRequired:3,chargedSprite:17,chargeBarDir:"UP",chargeDecayTime:18,decayBarDir:"DOWN"}},{tileX:12,tileY:6,type:"Bulb",tileSprite:16,tileData:{x:12,y:6,sprite:16,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},bulb:{chargesRequired:3,chargedSprite:17,chargeBarDir:"UP",chargeDecayTime:6,decayBarDir:"DOWN"}},{tileX:7,tileY:6,type:"Switch",tileSprite:39,tileData:{x:7,y:6,sprite:23,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistorId:0,wireSwitch:{chargesRequired:1}},{tileX:4,tileY:1,type:"Transistor",tileSprite:32,tileData:{x:4,y:1,sprite:32,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:0,chargesRequired:3,chargeBarDir:"LEFT"}}]},{name:"shifterTest",components:[{tileX:4,tileY:4,type:"Battery",tileSprite:0,tileData:{x:4,y:4,sprite:0,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:2,pulseTime:.75,pulseSpeed:60}},{tileX:2,tileY:4,type:"Direction",tileSprite:6,tileData:{x:2,y:4,sprite:5,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"RIGHT"}},{tileX:7,tileY:4,type:"Direction",tileSprite:6,tileData:{x:7,y:4,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"UP"}},{tileX:12,tileY:3,type:"Bulb",tileSprite:16,tileData:{x:12,y:3,sprite:16,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},shifterId:0,bulb:{chargesRequired:2,chargedSprite:17,chargeBarDir:"LEFT"}},{tileX:12,tileY:1,type:"Shifter",tileSprite:93,tileData:{x:12,y:1,sprite:93,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1},shifter:{shifterId:0,direction:"V-",chargesRequired:1},transistorId:0},{tileX:12,tileY:7,type:"Shifter",tileSprite:93,tileData:{x:12,y:7,sprite:93,flipH:!1,flipV:!0,flipR:!1,flagA:!1,flagB:!1},shifter:{shifterId:0,direction:"V+",chargesRequired:1},transistorId:1},{tileX:7,tileY:2,type:"Transistor",tileSprite:32,tileData:{x:7,y:2,sprite:32,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:0,chargesRequired:2,chargeBarDir:"LEFT"}},{tileX:7,tileY:6,type:"Transistor",tileSprite:32,tileData:{x:7,y:6,sprite:32,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:1,chargesRequired:2,chargeBarDir:"LEFT"}}]},{name:"shifterPlay",components:[{tileX:3,tileY:4,type:"Battery",tileSprite:0,tileData:{x:3,y:4,sprite:0,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:5,pulseTime:.75,pulseSpeed:60}},{tileX:1,tileY:4,type:"Direction",tileSprite:6,tileData:{x:1,y:4,sprite:5,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"RIGHT"}},{tileX:1,tileY:8,type:"Direction",tileSprite:6,tileData:{x:1,y:8,sprite:5,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"UP"}},{tileX:5,tileY:4,type:"Direction",tileSprite:6,tileData:{x:5,y:4,sprite:5,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:5,tileY:8,type:"Direction",tileSprite:6,tileData:{x:5,y:8,sprite:5,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:10,tileY:8,type:"Direction",tileSprite:6,tileData:{x:10,y:8,sprite:5,flipH:!1,flipV:!0,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:10,tileY:10,type:"Direction",tileSprite:6,tileData:{x:10,y:10,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"RIGHT"}},{tileX:11,tileY:6,type:"Bulb",tileSprite:16,tileData:{x:11,y:6,sprite:16,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},bulb:{chargesRequired:6,chargedSprite:17,chargeBarDir:"LEFT"}},{tileX:7,tileY:4,type:"DangerWire",tileSprite:109,tileData:{x:7,y:4,sprite:109,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1}},{tileX:7,tileY:8,type:"DangerWire",tileSprite:109,tileData:{x:7,y:8,sprite:109,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1}},{tileX:9,tileY:4,type:"DangerWire",tileSprite:109,tileData:{x:9,y:4,sprite:109,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1}},{tileX:9,tileY:8,type:"DangerWire",tileSprite:109,tileData:{x:9,y:8,sprite:109,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1}},{tileX:8,tileY:3,type:"ShiftWire",tileData:{},shifterId:0},{tileX:8,tileY:9,type:"ShiftWire",tileData:{},shifterId:0},{tileX:8,tileY:1,type:"Shifter",tileSprite:93,tileData:{x:8,y:1,sprite:93,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},shifter:{shifterId:0,direction:"V-",chargesRequired:1},transistorId:0},{tileX:8,tileY:11,type:"Shifter",tileSprite:93,tileData:{x:8,y:11,sprite:93,flipH:!1,flipV:!0,flipR:!1,flagA:!1,flagB:!1},transistorId:1,shifter:{shifterId:0,direction:"V+",chargesRequired:1}},{tileX:4,tileY:1,type:"Transistor",tileSprite:32,tileData:{x:4,y:1,sprite:32,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:0,chargesRequired:2,chargeBarDir:"LEFT"}},{tileX:4,tileY:11,type:"Transistor",tileSprite:32,tileData:{x:4,y:11,sprite:32,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:1,chargesRequired:2,chargeBarDir:"LEFT"}}]},{name:"shifterPlay2",components:[{tileX:3,tileY:4,type:"Battery",tileSprite:0,tileData:{x:3,y:4,sprite:0,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:5,pulseTime:.75,pulseSpeed:60}},{tileX:1,tileY:4,type:"Direction",tileSprite:6,tileData:{x:1,y:4,sprite:5,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"RIGHT"}},{tileX:1,tileY:8,type:"Direction",tileSprite:6,tileData:{x:1,y:8,sprite:5,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"UP"}},{tileX:5,tileY:4,type:"Direction",tileSprite:6,tileData:{x:5,y:4,sprite:5,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:5,tileY:8,type:"Direction",tileSprite:6,tileData:{x:5,y:8,sprite:5,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:10,tileY:2,type:"Direction",tileSprite:6,tileData:{x:10,y:2,sprite:5,flipH:!1,flipV:!0,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"RIGHT"}},{tileX:10,tileY:4,type:"Direction",tileSprite:6,tileData:{x:10,y:4,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"UP"}},{tileX:11,tileY:6,type:"Bulb",tileSprite:16,tileData:{x:11,y:6,sprite:16,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},bulb:{chargesRequired:6,chargedSprite:17,chargeBarDir:"LEFT"}},{tileX:7,tileY:4,type:"DangerWire",tileSprite:109,tileData:{x:7,y:4,sprite:109,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1}},{tileX:7,tileY:8,type:"DangerWire",tileSprite:109,tileData:{x:7,y:8,sprite:109,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1}},{tileX:9,tileY:4,type:"DangerWire",tileSprite:109,tileData:{x:9,y:4,sprite:109,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1}},{tileX:9,tileY:8,type:"DangerWire",tileSprite:109,tileData:{x:9,y:8,sprite:109,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1}},{tileX:8,tileY:3,type:"ShiftWire",tileData:{},shifterId:0},{tileX:8,tileY:9,type:"ShiftWire",tileData:{},shifterId:0},{tileX:8,tileY:1,type:"Shifter",tileSprite:93,tileData:{x:8,y:1,sprite:93,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},shifter:{shifterId:0,direction:"V-",chargesRequired:1},transistorId:0},{tileX:8,tileY:11,type:"Shifter",tileSprite:93,tileData:{x:8,y:11,sprite:93,flipH:!1,flipV:!0,flipR:!1,flagA:!1,flagB:!1},transistorId:1,shifter:{shifterId:0,direction:"V+",chargesRequired:1}},{tileX:4,tileY:1,type:"Transistor",tileSprite:32,tileData:{x:4,y:1,sprite:32,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:0,chargesRequired:2,chargeBarDir:"LEFT"}},{tileX:4,tileY:11,type:"Transistor",tileSprite:32,tileData:{x:4,y:11,sprite:32,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:1,chargesRequired:2,chargeBarDir:"LEFT"}}]},{name:"chargedBattery",components:[{tileX:7,tileY:2,type:"Battery",tileSprite:0,tileData:{x:7,y:2,sprite:0,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:5,pulseTime:.75,pulseSpeed:65}},{tileX:7,tileY:6,type:"RechargeBattery",tileSprite:48,tileData:{x:7,y:6,sprite:48,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistorId:0,rechargeBattery:{chargesRequired:2,chargeBarDir:"UP",chargeDecayTime:5,decayBarDir:"UP",decayToZero:!0,pulseSpeed:60,maxPulses:3,blinkTime:.5}},{tileX:2,tileY:8,type:"Direction",tileSprite:6,tileData:{x:2,y:8,sprite:5,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"UP"}},{tileX:12,tileY:8,type:"Direction",tileSprite:6,tileData:{x:12,y:8,sprite:5,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:7,tileY:4,type:"Bulb",tileSprite:16,tileData:{x:7,y:4,sprite:16,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},bulb:{chargesRequired:3,chargedSprite:17,chargeBarDir:"LEFT"}},{tileX:7,tileY:10,type:"Transistor",tileSprite:32,tileData:{x:7,y:10,sprite:32,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:0,chargesRequired:2,chargeBarDir:"LEFT"}}]},{name:"timeItOut",components:[{tileX:7,tileY:1,type:"Battery",tileSprite:0,tileData:{x:7,y:1,sprite:0,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:4,pulseTime:.75,pulseSpeed:60}},{tileX:4,tileY:10,type:"RechargeBattery",tileSprite:48,tileData:{x:4,y:10,sprite:48,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistorId:0,rechargeBattery:{chargesRequired:2,chargeBarDir:"UP",chargeDecayTime:2,decayBarDir:"UP",decayToZero:!0,pulseSpeed:60,maxPulses:3,blinkTime:.5,pulseBarDir:"UP"}},{tileX:7,tileY:7,type:"RechargeBattery",tileSprite:48,tileData:{x:7,y:7,sprite:48,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistorId:0,rechargeBattery:{chargesRequired:2,chargeBarDir:"DOWN",chargeDecayTime:2,decayBarDir:"DOWN",decayToZero:!0,pulseSpeed:60,maxPulses:3,blinkTime:.5,pulseBarDir:"DOWN"}},{tileX:3,tileY:10,type:"Direction",tileSprite:6,tileData:{x:3,y:10,sprite:5,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"UP"}},{tileX:6,tileY:7,type:"Direction",tileSprite:6,tileData:{x:6,y:7,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"RIGHT"}},{tileX:6,tileY:10,type:"Direction",tileSprite:6,tileData:{x:6,y:10,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"RIGHT"}},{tileX:9,tileY:10,type:"Direction",tileSprite:6,tileData:{x:9,y:10,sprite:5,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:4,tileY:13,type:"Bulb",tileSprite:16,tileData:{x:4,y:13,sprite:16,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},bulb:{chargesRequired:1,chargedSprite:17,chargeBarDir:"UP"}},{tileX:6,tileY:13,type:"Bulb",tileSprite:16,tileData:{x:6,y:13,sprite:16,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},bulb:{chargesRequired:1,chargedSprite:17,chargeBarDir:"UP"}},{tileX:8,tileY:13,type:"Bulb",tileSprite:16,tileData:{x:8,y:13,sprite:16,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},bulb:{chargesRequired:1,chargedSprite:17,chargeBarDir:"UP"}},{tileX:11,tileY:3,type:"Transistor",tileSprite:32,tileData:{x:11,y:3,sprite:32,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:0,chargesRequired:2,chargeBarDir:"UP"}}]},{name:"trickyShift",components:[{tileX:1,tileY:6,type:"Battery",tileSprite:0,tileData:{x:1,y:6,sprite:0,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:3,pulseTime:.75,pulseSpeed:60,maxLostElectrons:3}},{tileX:7,tileY:2,type:"Battery",tileSprite:0,tileData:{x:7,y:2,sprite:0,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:4,pulseTime:.3,pulseSpeed:60,maxLostElectrons:4}},{tileX:14,tileY:6,type:"Battery",tileSprite:0,tileData:{x:14,y:6,sprite:0,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:3,pulseTime:.75,pulseSpeed:60,maxLostElectrons:3}},{tileX:0,tileY:6,type:"Direction",tileSprite:6,tileData:{x:0,y:6,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"RIGHT"}},{tileX:0,tileY:10,type:"Direction",tileSprite:6,tileData:{x:0,y:10,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"UP"}},{tileX:2,tileY:6,type:"Direction",tileSprite:6,tileData:{x:2,y:6,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:2,tileY:10,type:"Direction",tileSprite:6,tileData:{x:2,y:10,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:6,tileY:2,type:"Direction",tileSprite:6,tileData:{x:6,y:2,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"RIGHT"}},{tileX:6,tileY:4,type:"Direction",tileSprite:6,tileData:{x:6,y:4,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"UP"}},{tileX:6,tileY:13,type:"Direction",tileSprite:6,tileData:{x:6,y:13,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:7,tileY:10,type:"Direction",tileSprite:6,tileData:{x:7,y:10,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"RIGHT"}},{tileX:8,tileY:10,type:"Direction",tileSprite:6,tileData:{x:8,y:10,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"RIGHT"}},{tileX:9,tileY:2,type:"Direction",tileSprite:6,tileData:{x:9,y:2,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:9,tileY:4,type:"Direction",tileSprite:6,tileData:{x:9,y:4,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:13,tileY:6,type:"Direction",tileSprite:6,tileData:{x:13,y:6,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"RIGHT"}},{tileX:13,tileY:10,type:"Direction",tileSprite:6,tileData:{x:13,y:10,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"UP"}},{tileX:15,tileY:6,type:"Direction",tileSprite:6,tileData:{x:15,y:6,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:15,tileY:10,type:"Direction",tileSprite:6,tileData:{x:15,y:10,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:7,tileY:7,type:"Bulb",tileSprite:16,tileData:{x:7,y:7,sprite:16,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},bulb:{chargesRequired:1,chargedSprite:17,chargeBarDir:"UP"}},{tileX:8,tileY:7,type:"Bulb",tileSprite:16,tileData:{x:8,y:7,sprite:16,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},bulb:{chargesRequired:1,chargedSprite:17,chargeBarDir:"UP"}},{tileX:7,tileY:14,type:"Bulb",tileSprite:16,tileData:{x:7,y:13,sprite:16,flipH:!1,flipV:!0,flipR:!1,flagA:!1,flagB:!1},bulb:{chargesRequired:1,chargedSprite:17,chargeBarDir:"DOWN"}},{tileX:8,tileY:14,type:"Bulb",tileSprite:16,tileData:{x:8,y:13,sprite:16,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},bulb:{chargesRequired:1,chargedSprite:17,chargeBarDir:"DOWN"}},{tileX:5,tileY:4,type:"DangerWire",tileSprite:109,tileData:{x:5,y:4,sprite:109,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1}},{tileX:5,tileY:6,type:"DangerWire",tileSprite:109,tileData:{x:5,y:6,sprite:109,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1}},{tileX:5,tileY:9,type:"DangerWire",tileSprite:109,tileData:{x:5,y:9,sprite:109,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1}},{tileX:5,tileY:10,type:"DangerWire",tileSprite:109,tileData:{x:5,y:10,sprite:109,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1}},{tileX:5,tileY:13,type:"DangerWire",tileSprite:109,tileData:{x:5,y:13,sprite:109,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1}},{tileX:10,tileY:4,type:"DangerWire",tileSprite:109,tileData:{x:10,y:4,sprite:109,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1}},{tileX:10,tileY:6,type:"DangerWire",tileSprite:109,tileData:{x:10,y:6,sprite:109,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1}},{tileX:10,tileY:9,type:"DangerWire",tileSprite:109,tileData:{x:10,y:9,sprite:109,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1}},{tileX:10,tileY:10,type:"DangerWire",tileSprite:109,tileData:{x:10,y:10,sprite:109,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1}},{tileX:4,tileY:5,type:"ShiftWire",tileData:{},shifterId:0},{tileX:4,tileY:6,type:"ShiftWire",tileData:{},shifterId:0},{tileX:4,tileY:7,type:"ShiftWire",tileData:{},shifterId:0},{tileX:4,tileY:8,type:"ShiftWire",tileData:{},shifterId:0},{tileX:4,tileY:9,type:"ShiftWire",tileData:{},shifterId:0},{tileX:11,tileY:7,type:"ShiftWire",tileData:{},shifterId:1},{tileX:11,tileY:8,type:"ShiftWire",tileData:{},shifterId:1},{tileX:11,tileY:9,type:"ShiftWire",tileData:{},shifterId:1},{tileX:11,tileY:10,type:"ShiftWire",tileData:{},shifterId:1},{tileX:11,tileY:11,type:"ShiftWire",tileData:{},shifterId:1},{tileX:4,tileY:1,type:"Shifter",tileSprite:93,tileData:{x:4,y:1,sprite:93,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},shifter:{shifterId:0,direction:"V-",chargesRequired:1},transistorId:0},{tileX:4,tileY:14,type:"Shifter",tileSprite:93,tileData:{x:4,y:14,sprite:93,flipH:!1,flipV:!0,flipR:!1,flagA:!1,flagB:!1},shifter:{shifterId:0,direction:"V+",chargesRequired:1},transistorId:1},{tileX:11,tileY:1,type:"Shifter",tileSprite:93,tileData:{x:11,y:1,sprite:93,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},shifter:{shifterId:1,direction:"V-",chargesRequired:1},transistorId:2},{tileX:11,tileY:14,type:"Shifter",tileSprite:93,tileData:{x:11,y:14,sprite:93,flipH:!1,flipV:!0,flipR:!1,flagA:!1,flagB:!1},shifter:{shifterId:1,direction:"V+",chargesRequired:1},transistorId:3},{tileX:1,tileY:1,type:"Transistor",tileSprite:32,tileData:{x:1,y:1,sprite:32,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:0,chargesRequired:3,chargeBarDir:"UP"}},{tileX:1,tileY:14,type:"Transistor",tileSprite:32,tileData:{x:1,y:14,sprite:32,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:1,chargesRequired:3,chargeBarDir:"UP"}},{tileX:14,tileY:1,type:"Transistor",tileSprite:32,tileData:{x:14,y:1,sprite:32,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:2,chargesRequired:3,chargeBarDir:"UP"}},{tileX:14,tileY:14,type:"Transistor",tileSprite:32,tileData:{x:14,y:14,sprite:32,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:3,chargesRequired:3,chargeBarDir:"UP"}}]},{name:"Slide-A-Bulb",components:[{tileX:3,tileY:2,type:"Battery",tileSprite:0,tileData:{x:3,y:2,sprite:0,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:0,pulseTime:1,pulseSpeed:60,maxLostElectrons:0}},{tileX:3,tileY:4,type:"Battery",tileSprite:0,tileData:{x:3,y:4,sprite:0,flipH:!0,flipV:!0,flipR:!1,flagA:!1,flagB:!1},battery:{charges:1,pulseTime:1,pulseSpeed:60,maxLostElectrons:0}},{tileX:3,tileY:10,type:"Battery",tileSprite:0,tileData:{x:3,y:10,sprite:0,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:1,pulseTime:1,pulseSpeed:60,maxLostElectrons:0}},{tileX:3,tileY:12,type:"Battery",tileSprite:0,tileData:{x:11,y:12,sprite:0,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:1,pulseTime:1,pulseSpeed:60,maxLostElectrons:0}},{tileX:11,tileY:2,type:"Battery",tileSprite:0,tileData:{x:3,y:2,sprite:0,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:1,pulseTime:1,pulseSpeed:60,maxLostElectrons:0}},{tileX:11,tileY:4,type:"Battery",tileSprite:0,tileData:{x:11,y:4,sprite:0,flipH:!1,flipV:!0,flipR:!1,flagA:!1,flagB:!1},battery:{charges:1,pulseTime:1,pulseSpeed:60,maxLostElectrons:0}},{tileX:11,tileY:10,type:"Battery",tileSprite:0,tileData:{x:11,y:10,sprite:0,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:1,pulseTime:1,pulseSpeed:60,maxLostElectrons:0}},{tileX:11,tileY:12,type:"Battery",tileSprite:0,tileData:{x:11,y:12,sprite:0,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:0,pulseTime:1,pulseSpeed:60,maxLostElectrons:0}},{tileX:0,tileY:6,type:"Direction",tileSprite:6,tileData:{x:0,y:6,sprite:5,flipH:!1,flipV:!0,flipR:!0,flagA:!1,flagB:!1},direction:{isControllable:!1,dir:"UP"}},{tileX:0,tileY:8,type:"Direction",tileSprite:6,tileData:{x:0,y:8,sprite:5,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"UP"}},{tileX:4,tileY:6,type:"Direction",tileSprite:6,tileData:{x:4,y:6,sprite:5,flipH:!0,flipV:!0,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"UP"}},{tileX:4,tileY:8,type:"Direction",tileSprite:6,tileData:{x:4,y:8,sprite:5,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:6,tileY:2,type:"Direction",tileSprite:6,tileData:{x:6,y:2,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"RIGHT"}},{tileX:6,tileY:12,type:"Direction",tileSprite:6,tileData:{x:6,y:12,sprite:5,flipH:!1,flipV:!0,flipR:!0,flagA:!1,flagB:!1},direction:{isControllable:!1,dir:"LEFT"}},{tileX:8,tileY:2,type:"Direction",tileSprite:6,tileData:{x:8,y:2,sprite:5,flipH:!1,flipV:!0,flipR:!0,flagA:!1,flagB:!1},direction:{isControllable:!1,dir:"RIGHT"}},{tileX:8,tileY:12,type:"Direction",tileSprite:6,tileData:{x:8,y:12,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:10,tileY:6,type:"Direction",tileSprite:6,tileData:{x:10,y:6,sprite:5,flipH:!1,flipV:!0,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"UP"}},{tileX:10,tileY:8,type:"Direction",tileSprite:6,tileData:{x:10,y:8,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:14,tileY:6,type:"Direction",tileSprite:6,tileData:{x:14,y:6,sprite:5,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:14,tileY:8,type:"Direction",tileSprite:6,tileData:{x:14,y:8,sprite:5,flipH:!1,flipV:!0,flipR:!0,flagA:!1,flagB:!1},direction:{isControllable:!1,dir:"DOWN"}},{tileX:8,tileY:8,type:"Bulb",tileSprite:16,tileData:{x:8,y:8,sprite:16,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1},bulb:{chargesRequired:4,chargedSprite:17,chargeBarDir:"UP"},shifterId:0},{tileX:5,tileY:6,type:"DangerWire",tileSprite:109,tileData:{x:5,y:6,sprite:109,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1}},{tileX:5,tileY:8,type:"DangerWire",tileSprite:109,tileData:{x:5,y:8,sprite:109,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1}},{tileX:9,tileY:6,type:"DangerWire",tileSprite:109,tileData:{x:9,y:6,sprite:109,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1}},{tileX:9,tileY:8,type:"DangerWire",tileSprite:109,tileData:{x:9,y:8,sprite:109,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1}},{tileX:5,tileY:7,type:"Shifter",tileSprite:93,tileData:{x:5,y:7,sprite:93,flipH:!0,flipV:!1,flipR:!0,flagA:!1,flagB:!1},shifter:{shifterId:0,direction:"H-",chargesRequired:1},transistorId:0},{tileX:7,tileY:5,type:"Shifter",tileSprite:93,tileData:{x:7,y:5,sprite:93,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},shifter:{shifterId:0,direction:"V-",chargesRequired:1},transistorId:1},{tileX:7,tileY:9,type:"Shifter",tileSprite:93,tileData:{x:7,y:9,sprite:93,flipH:!1,flipV:!0,flipR:!1,flagA:!1,flagB:!1},shifter:{shifterId:0,direction:"V+",chargesRequired:1},transistorId:2},{tileX:9,tileY:7,type:"Shifter",tileSprite:93,tileData:{x:9,y:7,sprite:93,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},shifter:{shifterId:0,direction:"H+",chargesRequired:1},transistorId:3},{tileX:1,tileY:7,type:"Transistor",tileSprite:32,tileData:{x:1,y:7,sprite:32,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:0,chargesRequired:1,chargeBarDir:"RIGHT"}},{tileX:7,tileY:3,type:"Transistor",tileSprite:32,tileData:{x:7,y:3,sprite:32,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:1,chargesRequired:1,chargeBarDir:"DOWN"}},{tileX:7,tileY:11,type:"Transistor",tileSprite:32,tileData:{x:7,y:11,sprite:32,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:2,chargesRequired:1,chargeBarDir:"UP"}},{tileX:13,tileY:7,type:"Transistor",tileSprite:32,tileData:{x:13,y:7,sprite:32,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:3,chargesRequired:1,chargeBarDir:"LEFT"}}]},{name:"overTheRainbow",components:[{tileX:1,tileY:4,type:"Battery",tileSprite:0,tileData:{x:1,y:4,sprite:0,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:3,pulseTime:1,pulseSpeed:60,maxLostElectrons:0}},{tileX:7,tileY:10,type:"Battery",tileSprite:0,tileData:{x:7,y:10,sprite:0,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:3,pulseTime:1,pulseSpeed:60,maxLostElectrons:0}},{tileX:10,tileY:0,type:"Battery",tileSprite:0,tileData:{x:10,y:0,sprite:0,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:3,pulseTime:1,pulseSpeed:60,maxLostElectrons:0}},{tileX:13,tileY:15,type:"Battery",tileSprite:0,tileData:{x:13,y:15,sprite:0,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:1,pulseTime:1,pulseSpeed:60,maxLostElectrons:1}},{tileX:1,tileY:1,type:"Direction",tileSprite:6,tileData:{x:1,y:1,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"RIGHT"}},{tileX:2,tileY:1,type:"Direction",tileSprite:6,tileData:{x:2,y:1,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:2,tileY:2,type:"Direction",tileSprite:6,tileData:{x:2,y:2,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:2,tileY:3,type:"Direction",tileSprite:6,tileData:{x:2,y:3,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:3,tileY:1,type:"Direction",tileSprite:6,tileData:{x:3,y:1,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"UP"}},{tileX:3,tileY:3,type:"Direction",tileSprite:6,tileData:{x:3,y:3,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"RIGHT"}},{tileX:6,tileY:11,type:"Direction",tileSprite:6,tileData:{x:6,y:11,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"UP"}},{tileX:6,tileY:12,type:"Direction",tileSprite:6,tileData:{x:6,y:12,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:6,tileY:13,type:"Direction",tileSprite:6,tileData:{x:6,y:13,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"RIGHT"}},{tileX:7,tileY:11,type:"Direction",tileSprite:6,tileData:{x:7,y:11,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:7,tileY:13,type:"Direction",tileSprite:6,tileData:{x:7,y:13,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"UP"}},{tileX:7,tileY:14,type:"Direction",tileSprite:6,tileData:{x:7,y:14,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:8,tileY:11,type:"Direction",tileSprite:6,tileData:{x:8,y:11,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:8,tileY:12,type:"Direction",tileSprite:6,tileData:{x:8,y:12,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"RIGHT"}},{tileX:8,tileY:13,type:"Direction",tileSprite:6,tileData:{x:8,y:13,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:9,tileY:11,type:"Direction",tileSprite:6,tileData:{x:9,y:11,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:9,tileY:13,type:"Direction",tileSprite:6,tileData:{x:9,y:13,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"RIGHT"}},{tileX:9,tileY:14,type:"Direction",tileSprite:6,tileData:{x:9,y:14,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:12,tileY:0,type:"Direction",tileSprite:6,tileData:{x:12,y:0,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:12,tileY:1,type:"Direction",tileSprite:6,tileData:{x:12,y:1,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:12,tileY:2,type:"Direction",tileSprite:6,tileData:{x:12,y:2,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:12,tileY:3,type:"Direction",tileSprite:6,tileData:{x:12,y:3,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:13,tileY:0,type:"Direction",tileSprite:6,tileData:{x:13,y:0,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:13,tileY:1,type:"Direction",tileSprite:6,tileData:{x:13,y:1,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"UP"}},{tileX:13,tileY:2,type:"Direction",tileSprite:6,tileData:{x:13,y:2,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"RIGHT"}},{tileX:14,tileY:0,type:"Direction",tileSprite:6,tileData:{x:14,y:0,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"UP"}},{tileX:14,tileY:1,type:"Direction",tileSprite:6,tileData:{x:14,y:1,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:15,tileY:1,type:"Direction",tileSprite:6,tileData:{x:15,y:1,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:15,tileY:2,type:"Direction",tileSprite:6,tileData:{x:15,y:2,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"RIGHT"}},{tileX:15,tileY:13,type:"Direction",tileSprite:6,tileData:{x:15,y:13,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:4,tileY:11,type:"Bulb",tileSprite:16,tileData:{x:4,y:11,sprite:16,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},bulb:{chargesRequired:1,chargedSprite:17,chargeBarDir:"UP"},shifterId:0},{tileX:12,tileY:11,type:"DangerWire",tileSprite:109,tileData:{x:12,y:11,sprite:109,flipH:!0,flipV:!1,flipR:!1,flagA:!1,flagB:!1}},{tileX:4,tileY:4,type:"Shifter",tileSprite:93,tileData:{x:4,y:4,sprite:93,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},shifter:{shifterId:0,direction:"V-",chargesRequired:1},transistorId:0},{tileX:11,tileY:12,type:"Shifter",tileSprite:93,tileData:{x:11,y:12,sprite:93,flipH:!1,flipV:!0,flipR:!1,flagA:!1,flagB:!1},shifter:{shifterId:0,direction:"V+",chargesRequired:1},transistorId:1},{tileX:12,tileY:5,type:"Shifter",tileSprite:93,tileData:{x:12,y:5,sprite:93,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},shifter:{shifterId:0,direction:"H+",chargesRequired:1},transistorId:2},{tileX:3,tileY:2,type:"Transistor",tileSprite:32,tileData:{x:3,y:2,sprite:32,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:0,chargesRequired:1,chargeBarDir:"RIGHT"}},{tileX:8,tileY:14,type:"Transistor",tileSprite:32,tileData:{x:8,y:14,sprite:32,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:1,chargesRequired:1,chargeBarDir:"DOWN"}},{tileX:14,tileY:2,type:"Transistor",tileSprite:32,tileData:{x:14,y:2,sprite:32,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:2,chargesRequired:1,chargeBarDir:"DOWN"}}]},{name:"rechargeEasy",components:[{tileX:6,tileY:5,type:"Battery",tileSprite:0,tileData:{x:6,y:5,sprite:0,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:1,pulseTime:1,pulseSpeed:60,maxLostElectrons:0}},{tileX:13,tileY:5,type:"Battery",tileSprite:0,tileData:{x:13,y:5,sprite:0,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:0,pulseTime:1,pulseSpeed:60}},{tileX:4,tileY:7,type:"RechargeBattery",tileSprite:48,tileData:{x:8,y:7,sprite:48,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistorId:0,rechargeBattery:{chargesRequired:1,chargeBarDir:"UP",chargeDecayTime:4,decayBarDir:"UP",decayToZero:!0,pulseSpeed:50,maxPulses:3,blinkTime:.3}},{tileX:7,tileY:7,type:"Direction",tileSprite:6,tileData:{x:7,y:7,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"RIGHT"}},{tileX:10,tileY:3,type:"Direction",tileSprite:6,tileData:{x:10,y:3,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:10,tileY:5,type:"Direction",tileSprite:6,tileData:{x:10,y:5,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"UP"}},{tileX:10,tileY:10,type:"Direction",tileSprite:6,tileData:{x:10,y:10,sprite:5,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:6,tileY:13,type:"Bulb",tileSprite:16,tileData:{x:6,y:11,sprite:16,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},bulb:{chargesRequired:2,chargedSprite:17,chargeDecayTime:4.75,decayToZero:!0}},{tileX:10,tileY:11,type:"Switch",tileSprite:39,tileData:{x:10,y:10,sprite:23,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistorId:2,wireSwitch:{chargesRequired:1}},{tileX:11,tileY:5,type:"Switch",tileSprite:39,tileData:{x:11,y:5,sprite:23,flipH:!1,flipV:!1,flipR:!0,flagA:!1,flagB:!1},transistorId:1,wireSwitch:{chargesRequired:1}},{tileX:8,tileY:5,type:"Transistor",tileSprite:32,tileData:{x:8,y:5,sprite:32,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:0,chargesRequired:1,chargeBarDir:"UP"}},{tileX:10,tileY:8,type:"Transistor",tileSprite:32,tileData:{x:10,y:8,sprite:32,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:1,chargesRequired:1,chargeBarDir:"UP"}},{tileX:14,tileY:5,type:"Transistor",tileSprite:32,tileData:{x:13,y:5,sprite:32,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:2,chargesRequired:1,chargeBarDir:"UP"}}]},{name:"weirdWarps",components:[{tileX:3,tileY:0,type:"Battery",tileSprite:0,tileData:{x:3,y:0,sprite:0,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},battery:{charges:1,pulseTime:1,pulseSpeed:60,maxLostElectrons:0}},{tileX:1,tileY:11,type:"RechargeBattery",tileSprite:48,tileData:{x:1,y:11,sprite:48,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistorId:2,rechargeBattery:{chargesRequired:1,chargeBarDir:"UP",chargeDecayTime:.01,decayBarDir:"UP",decayToZero:!0,pulseSpeed:60,maxPulses:1,blinkTime:.5}},{tileX:1,tileY:11,type:"RechargeBattery",tileSprite:48,tileData:{x:1,y:11,sprite:48,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistorId:21,rechargeBattery:{chargesRequired:1,chargeBarDir:"UP",chargeDecayTime:.01,decayBarDir:"UP",decayToZero:!0,pulseSpeed:60,maxPulses:1,blinkTime:.5}},{tileX:2,tileY:7,type:"RechargeBattery",tileSprite:48,tileData:{x:2,y:7,sprite:48,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistorId:5,rechargeBattery:{chargesRequired:1,chargeBarDir:"UP",chargeDecayTime:.01,decayBarDir:"UP",decayToZero:!0,pulseSpeed:60,maxPulses:1,blinkTime:.5}},{tileX:2,tileY:7,type:"RechargeBattery",tileSprite:48,tileData:{x:2,y:7,sprite:48,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistorId:51,rechargeBattery:{chargesRequired:1,chargeBarDir:"UP",chargeDecayTime:.01,decayBarDir:"UP",decayToZero:!0,pulseSpeed:60,maxPulses:1,blinkTime:.5}},{tileX:2,tileY:7,type:"RechargeBattery",tileSprite:48,tileData:{x:2,y:7,sprite:48,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistorId:52,rechargeBattery:{chargesRequired:1,chargeBarDir:"UP",chargeDecayTime:.01,decayBarDir:"UP",decayToZero:!0,pulseSpeed:60,maxPulses:1,blinkTime:.5}},{tileX:4,tileY:3,type:"RechargeBattery",tileSprite:48,tileData:{x:4,y:3,sprite:48,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistorId:7,rechargeBattery:{chargesRequired:1,chargeBarDir:"UP",chargeDecayTime:.01,decayBarDir:"UP",decayToZero:!0,pulseSpeed:60,maxPulses:1,blinkTime:.5}},{tileX:4,tileY:15,type:"RechargeBattery",tileSprite:48,tileData:{x:4,y:15,sprite:48,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistorId:6,rechargeBattery:{chargesRequired:1,chargeBarDir:"UP",chargeDecayTime:.01,decayBarDir:"UP",decayToZero:!0,pulseSpeed:60,maxPulses:1,blinkTime:.5}},{tileX:5,tileY:11,type:"RechargeBattery",tileSprite:48,tileData:{x:5,y:11,sprite:48,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistorId:8,rechargeBattery:{chargesRequired:1,chargeBarDir:"UP",chargeDecayTime:.01,decayBarDir:"UP",decayToZero:!0,pulseSpeed:60,maxPulses:1,blinkTime:.5}},{tileX:7,tileY:7,type:"RechargeBattery",tileSprite:48,tileData:{x:7,y:7,sprite:48,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistorId:3,rechargeBattery:{chargesRequired:1,chargeBarDir:"UP",chargeDecayTime:.01,decayBarDir:"UP",decayToZero:!0,pulseSpeed:60,maxPulses:1,blinkTime:.5}},{tileX:9,tileY:11,type:"RechargeBattery",tileSprite:48,tileData:{x:9,y:11,sprite:48,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistorId:9,rechargeBattery:{chargesRequired:1,chargeBarDir:"UP",chargeDecayTime:.01,decayBarDir:"UP",decayToZero:!0,pulseSpeed:60,maxPulses:1,blinkTime:.5}},{tileX:10,tileY:3,type:"RechargeBattery",tileSprite:48,tileData:{x:10,y:3,sprite:48,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistorId:1,rechargeBattery:{chargesRequired:1,chargeBarDir:"UP",chargeDecayTime:.01,decayBarDir:"UP",decayToZero:!0,pulseSpeed:60,maxPulses:1,blinkTime:.5}},{tileX:10,tileY:3,type:"RechargeBattery",tileSprite:48,tileData:{x:10,y:3,sprite:48,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistorId:11,rechargeBattery:{chargesRequired:1,chargeBarDir:"UP",chargeDecayTime:.01,decayBarDir:"UP",decayToZero:!0,pulseSpeed:60,maxPulses:1,blinkTime:.5}},{tileX:10,tileY:3,type:"RechargeBattery",tileSprite:48,tileData:{x:10,y:3,sprite:48,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistorId:12,rechargeBattery:{chargesRequired:1,chargeBarDir:"UP",chargeDecayTime:.01,decayBarDir:"UP",decayToZero:!0,pulseSpeed:60,maxPulses:1,blinkTime:.5}},{tileX:12,tileY:7,type:"RechargeBattery",tileSprite:48,tileData:{x:12,y:7,sprite:48,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistorId:10,rechargeBattery:{chargesRequired:1,chargeBarDir:"UP",chargeDecayTime:.01,decayBarDir:"UP",decayToZero:!0,pulseSpeed:60,maxPulses:1,blinkTime:.5}},{tileX:13,tileY:11,type:"RechargeBattery",tileSprite:48,tileData:{x:13,y:11,sprite:48,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistorId:4,rechargeBattery:{chargesRequired:1,chargeBarDir:"UP",chargeDecayTime:.01,decayBarDir:"UP",decayToZero:!0,pulseSpeed:60,maxPulses:1,blinkTime:.5}},{tileX:0,tileY:12,type:"Direction",tileSprite:6,tileData:{x:0,y:12,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:1,tileY:8,type:"Direction",tileSprite:6,tileData:{x:1,y:8,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:2,tileY:12,type:"Direction",tileSprite:6,tileData:{x:2,y:12,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:3,tileY:8,type:"Direction",tileSprite:6,tileData:{x:3,y:8,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:4,tileY:4,type:"Direction",tileSprite:6,tileData:{x:4,y:4,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:5,tileY:12,type:"Direction",tileSprite:6,tileData:{x:5,y:12,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:6,tileY:8,type:"Direction",tileSprite:6,tileData:{x:6,y:8,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:7,tileY:1,type:"Direction",tileSprite:6,tileData:{x:7,y:1,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"LEFT"}},{tileX:8,tileY:8,type:"Direction",tileSprite:6,tileData:{x:8,y:8,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:9,tileY:12,type:"Direction",tileSprite:6,tileData:{x:9,y:12,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:10,tileY:4,type:"Direction",tileSprite:6,tileData:{x:10,y:4,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:11,tileY:8,type:"Direction",tileSprite:6,tileData:{x:11,y:8,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:12,tileY:12,type:"Direction",tileSprite:6,tileData:{x:12,y:12,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:13,tileY:8,type:"Direction",tileSprite:6,tileData:{x:13,y:8,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:14,tileY:12,type:"Direction",tileSprite:6,tileData:{x:14,y:12,sprite:5,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},direction:{isControllable:!0,dir:"DOWN"}},{tileX:11,tileY:15,type:"Bulb",tileSprite:16,tileData:{x:11,y:15,sprite:16,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},bulb:{chargesRequired:1,chargedSprite:17}},{tileX:0,tileY:13,type:"Transistor",tileSprite:32,tileData:{x:0,y:13,sprite:32,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:11,chargesRequired:1,chargeBarDir:"DOWN"}},{tileX:1,tileY:9,type:"Transistor",tileSprite:32,tileData:{x:1,y:9,sprite:32,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:6,chargesRequired:1,chargeBarDir:"DOWN"}},{tileX:2,tileY:13,type:"Transistor",tileSprite:32,tileData:{x:2,y:13,sprite:32,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:3,chargesRequired:1,chargeBarDir:"DOWN"}},{tileX:3,tileY:9,type:"Transistor",tileSprite:32,tileData:{x:3,y:9,sprite:32,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:10,chargesRequired:1,chargeBarDir:"DOWN"}},{tileX:4,tileY:5,type:"Transistor",tileSprite:32,tileData:{x:4,y:5,sprite:32,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:21,chargesRequired:1,chargeBarDir:"DOWN"}},{tileX:5,tileY:13,type:"Transistor",tileSprite:32,tileData:{x:5,y:13,sprite:32,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:9,chargesRequired:1,chargeBarDir:"DOWN"}},{tileX:6,tileY:9,type:"Transistor",tileSprite:32,tileData:{x:6,y:9,sprite:32,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:4,chargesRequired:1,chargeBarDir:"DOWN"}},{tileX:8,tileY:9,type:"Transistor",tileSprite:32,tileData:{x:8,y:9,sprite:32,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:7,chargesRequired:1,chargeBarDir:"DOWN"}},{tileX:9,tileY:13,type:"Transistor",tileSprite:32,tileData:{x:9,y:13,sprite:32,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:12,chargesRequired:1,chargeBarDir:"DOWN"}},{tileX:10,tileY:1,type:"Transistor",tileSprite:32,tileData:{x:10,y:1,sprite:32,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:1,chargesRequired:1,chargeBarDir:"DOWN"}},{tileX:10,tileY:5,type:"Transistor",tileSprite:32,tileData:{x:10,y:5,sprite:32,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:2,chargesRequired:1,chargeBarDir:"DOWN"}},{tileX:11,tileY:9,type:"Transistor",tileSprite:32,tileData:{x:11,y:9,sprite:32,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:51,chargesRequired:1,chargeBarDir:"DOWN"}},{tileX:12,tileY:13,type:"Transistor",tileSprite:32,tileData:{x:12,y:13,sprite:32,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:5,chargesRequired:1,chargeBarDir:"DOWN"}},{tileX:13,tileY:9,type:"Transistor",tileSprite:32,tileData:{x:13,y:9,sprite:32,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:52,chargesRequired:1,chargeBarDir:"DOWN"}},{tileX:14,tileY:13,type:"Transistor",tileSprite:32,tileData:{x:14,y:13,sprite:32,flipH:!1,flipV:!1,flipR:!1,flagA:!1,flagB:!1},transistor:{transistorId:8,chargesRequired:1,chargeBarDir:"DOWN"}}]}]},maps:{_type:"maps",maps:[{w:16,h:16,name:"map",sheet:"tilesheet",data:"!!|,%l#$|~###$|/#%!!|~~%!!|40l!!|~~%!!|40l!!|~~%!!|40l!!|~#(#$|~#3#$|/#(!!|~~%!!|4~%!!|~~%!!|40l!!|~~%!!|4~%!!|~+=#$|4(T!!}?"},{w:16,h:16,name:"title",sheet:"tilesheet",data:"!!|>%l#$|,0{#$|,#%!!|3~%#=#>#?#@#A~%!!|3~%#M#N#O#P#Q~%!!|3+=#$|,%j#$|,~&!!|t$F$G|~'/!!|4)v)w|~,_!!}#"},{w:16,h:16,name:"alternatorLevel",sheet:"",data:"!!|:%l%k###$&-#$#(%k|-#%!!|/~%!!|/~%!!|-~%!!|/~%!!|/~%!!|-~%!!|/#(#$|/(W(S|-#,!!|/~%!!|3~%!!|/+=#D#$#3#$|~(S|,(T!!}c"},{w:16,h:16,name:"decayTest",sheet:"tilesheet",data:"!!|>%l##+<+K+<#(#%!!|3~%!!|~~%|,!!|3+=+<#(#$|,~&~%!!|5~%!!|-~%!!|5~%!!|-~%!!|5+=+<(S|,(T!!}c"},{w:16,h:16,name:"transistorTest",sheet:"",data:"!!|;6>#$###$#(#$#(!!~4!!|1~%!!|-~%!!~%!!~9!!|1~%!!|-#3!!#C#8(i!!|1~%!!|-~%!!~%!!|3+=#$|-#(#$#(!!}v"},{w:16,h:16,name:"switchTest",sheet:"tilesheet",data:"!!|;%l#$|,###$|-#%!!|2~%!!|0~%!!|2#(#$#3#$~;#$|,~)!!|2~%!!|-~9!!|,~%!!|2~%!!|-~9!!|,~%!!|2~)#$|-#;#$|,~)!!|2~%!!|-~9!!|,~%!!|2~%!!|-~9!!|,~%!!|2+=#$|-#C#$|,(T!!}4"},{w:16,h:16,name:"doubleSwitch",sheet:"",data:"!!|<%l#$|~###$|~#%!!|-%l#$~)!!|3#(#$#%!!~%%!1%#8#9!!|1~%!!~%!!&,~:~)#$~;#$~4#$~4#$~;#$#(%!&,!!~%!!~%!!|11##8~<~:~%!!+=#$~)!!|3#(#$~&!!|-+=#$|3(T!!}P"},{w:16,h:16,name:"parallel",sheet:"tilesheet",data:"!!|;%l###$#%%l#$###$#%!!%l###$#%!!|,~%!!|,~%|,!!|-~%!!~%!!|,~%!!|,~%!!|,~%|,!!|-~%!!~%!!|,~%!!|,~)#$~)~&~%!!|-~%!!#(#$#(~&!!|,~%!!~%!!~%!!|-~%!!~%!!~%!!|-~%!!~%!!~%!!|-~%!!~%!!~%!!|-0m#C~&!!#(#$|-#(!!0m#C~&!!|~~9!!|,~%!!|-~%!!|,~9!!|/~9!!|,~%!!|-~%!!|,~9!!|/1##8|,#:!!|-#:#8|,~:!!|2~%!!|-~%!!|5~%!!|-~%!!|50m#$#3#$~&!!|P"},{w:16,h:16,name:"transistorSwitchedAlt",sheet:"tilesheet",data:"!!|[%l#$|1#%!!|1~%!!|-%l&,#%!!0m#$|/#%!!~%!!|-~%+Q~<#8|-#9!!|-~%!!~)#$###$#(#$#(#$#(#$~;#$#C#$(T!!~%!!|1~%!!|-~9!!|-~%!!|1~E!!|-~9!!|-~%!!|1~%!!|-~9!!|-#(#$|1#,#8|-(i!!|-~%!!|1~%!!|1+=#D#$#3#$|,%j#$~&!!|a"},{w:16,h:16,name:"diode2",sheet:"",data:"%l#$|,###$|,#(#$|-#(#$|-#(!!~%!!|/~%!!|-~%!!|-~%!!~%!!|/~%!!|-~E!!|-~%!!~%!!|/~%!!|-~%!!|-~%!!~%!!|/#(#$#D#$#3#$#D#$#(!!~%!!|/~%!!|-~%!!|-~%!!~%!!|/~%!!|-3u!!|-~%!!~%!!|/~%!!|-~%!!|-~%!!+=#$|/#(#$|-#(#$|-#(!!}>"},{w:16,h:16,name:"diode1",sheet:"",data:"%l#$|,###$|-%o#$#%!!|0~%!!|0~%!!~%!!|0~%!!|0~%!!~%!!|0%o#$&-#$|,#D#$(T!!~%!!|0~%!!|2~%!!|0~%!!|~%l#$&-#$%o#$&-#$#%!!|,~%!!|~~%!!|1~%!!|,+=#$#3#$|,%o#$|1(T!!}O"},{w:16,h:16,name:"synchronise",sheet:"",data:"!!%l###$#%!!%l#$###$#%!!|0~%!!|,~%!!~%!!|-~%!!|0~%!!|,~%!!~%!!|-~%!!|0~%!!|,~%!!#(#$|-#(!!|0~%!!|,~%!!~E!!|-~%!!|0~%!!|,~%!!~%!!|-~%!!|0~%!!|,~%!!~4!!|-~%!!|0~%!!|,~%!!+=#$~;#$(T!!|0~%!!|,~%!!|-~9!!|2~%!!|,~%!!|-~9!!|2~%!!|,~%!!|-~9!!|2~%!!|,~%!!|-~9!!|2~%!!|,#C#8|-(i!!|2~%!!|,~%!!|6+=#$|,(T!!|E"},{w:16,h:16,name:"splitterAlternatorTest",sheet:"",data:"!!|;%l#$#(#$&-###$|-#(#$#D#(#$#%!!~%!!~%!!|0~%!!|,~%!!~%!!~%!!~%!!|0~%!!|,~%!!~%!!~%!!~%!!|,%l#$|-%o#$|,~)#$#(!!~%!!~%!!|,~%!!|-~%!!|,~%!!|-~%!!~%!!|,~%!!|-~%!!|,~%!!|-~%!!~-#$|,#(#$|-~-#$|,#,!!|-~%!!~%!!|3~%!!|-~%!!~%!!|3~%!!|-~%!!#(#$|,#(#$|-~)#$|,~)!!|-~%!!~%!!|,~%!!|-~%!!|,~%!!|-+=#$#(#$|,#(#$|-~)#$|,~)!!|/~%!!|,~%!!|-~%!!|,~%!!|/+=#$|,#(#$#3#$#(#$#3(T!!|<"},{w:16,h:16,name:"oppositeSwitch",sheet:"",data:"!!|l%l%k|,%z#$%k#$%j#$#:#$|,%k#%!!|,~%!!|1%!~:!!|-~%!!|,%o%k#$&-#$###$%k&,%k#$|,%k%o!!|,~%!!|11##9!!|-~%!!|,+=%k#$%z#$%k#$%j%k~;#$|-(T!!}>"},{w:16,h:16,name:"rechargeTest",sheet:"",data:"!!|J%l&-#$|~%j#$|-#3#$|~#%~%!!|8~%|,!!|8~%|,!!|8~%|,!!|8~%%o&-#$###$|,&-#$#D#$|,###$|,#D#(~%!!|8~%0m#$|8(T!!}-"},{w:16,h:16,name:"loopStorage",sheet:"",data:"!!|K%l#$|-###$|2#%!!|,~%!!|6~%!!|,~%!!|6~%!!|,~%!!|6~%!!|,~%!!|,%l#$#%!!%l#$#%!!|-~%!!|,~%!!|,~%!!~%!!~%!!~%!!|-~%!!|,~%!!|,+=#(~&!!+=#((T!!|-~%!!|,~%!!|-~%!!|-~%!!|~~%!!|,+=#$~4#$#(#$#(#$#(#$#(#$|,(T!!|2~%!!|-~%!!|4%l#(#%!!%l#(#%!!|3~%!!~%!!~%!!~%!!|3+=#$(T!!+=#$(T!!|="},{w:16,h:16,name:"oneLifeSwitch",sheet:"",data:"%!#8|~#9!!|~%!#8|~#9~9%l###$#(~;#(#$|,#(~;#(#$|,#%~9|,~%!!|,~%!!~%!!|,~%!!~%!!|,#3~9|,+=#$|,(T!!+=#$|,(T!!+=#$|,(T~9#I#8|3#9!!|~~9|,%l###$#(~;#(#$|,#(~;#(#$|,#%~9|,~%!!|,~%~9~%!!|,~%!!~%!!|,#3~9|,+=#$|,(T~9+=#$|,(T!!+=#$|,(T~9|,!!|~+Q#8|,~J#8|0(i~9!!%l#$###$#%!!~9!!|1~9!!~%!!|-~%!!~9!!|1~9!!+=#$#C#$~)#$#C#$#%!!|/~9!!|-~9!!~%!!|-3T!!|/~9!!|-~9!!+=#$###$~&!!|/+Q#8|-~:!!|E"},{w:16,h:16,name:"crossing",sheet:"tilesheet",data:"%l#$|-#%!!|5~%!!|-#C#9%l###$#%!!|0~%!!|-~%~9~%!!|,~%!!|0#(#$|,#(~&~9~%!!|,~%!!|0~%!!|,~%!!4++=#(#$~&!!|0#(###$#(#$#%#H~%!!%l#$|,#%!!|-~%!!|~#(#$~;#$#(!!|,#3!!|-+=#$|~(T!!~%!!+=#$|,~&!!|2%l#$#(#%!!|6~%!!|,~%!!|6~%!!|,~%!!|6+=#$#3(T!!|r"},{w:16,h:16,name:"shifterTest",sheet:"tilesheet",data:"!!|3%!#8|,#9!!|/%l#$|~#%!!~9!!#!&j&i!!|~~%!!|~&,#8(i!!$2!!&y!!|~~%!!|~~%!!|-$2#3&y!!|,%l#$%o#$###$|,#(#$|-$3!!&z#%!!~%!!~%!!|~~%!!|-$2!!&y~%!!~%!!~%!!|~&,% #9!!$2!!&y~%!!~%!!+=#$|~(T!!~9!!)Q)R,:~%!!~%!!|2+Q#8|,(i!!~%!!+=#$|7(T!!}~"},{w:16,h:16,name:"shifterPlay",sheet:"",data:"!!|~%!#8|-#9!!|2%l#$|,&,#%!!#!$#&i!!|1~%!!|-~%!!$2!!&y!!|1~%!!|-~%!!$2#$&y!!|1~)#$###$~)#$$3!!&z#$#%!!|/~%!!|-~%!!$2!!&y!!~%!!|/~%!!|-~%!!$2!!&y!!#3!!|/~%!!|-~%!!$2!!&y!!~%!!|/~)#$|-~)#$$3!!&z(W(T!!|/~%!!|-~%!!$2#$&y~%!!|0~%!!|-~%!!$2!!&y#(%k|-#%!!|,+=#$|,&,(T!!)Q)R,:~%!!|-~%!!|/+Q#8|-(i!!~%!!|-~%!!|5~%!!|-~%!!|5+=#$|-(T!!|;"},{w:16,h:16,name:"shifterPlay2",sheet:"",data:"!!|~%!#8|-#9!!|2%l#$|,&,#%!!#!$#&i%l#$|-#%!!|,~%!!|-~%!!$2!!&y#(#$|-(T!!|,~%!!|-~%!!$2#$&y~%!!|0~)#$###$~)#$$3!!&z#(#%!!|/~%!!|-~%!!$2!!&y!!~%!!|/~%!!|-~%!!$2!!&y!!#3!!|/~%!!|-~%!!$2!!&y!!~%!!|/~)#$|-~)#$$3!!&z#$(T!!|/~%!!|-~%!!$2#$&y!!|1~%!!|-~%!!$2!!&y!!|1+=#$|,&,(T!!)Q)R,:!!|4+Q#8|-(i!!|b"},{w:16,h:16,name:"chargedBattery",sheet:"tilesheet",data:"!!|L%l#$|~###$|~#%!!|/~%!!|3~%!!|/~%!!%l#$|,#3#$|,#%!!~%!!|/~%!!~%!!|/~%!!~%!!|/~%!!+=+<|,&<#$|,(T!!~%!!|/~%!!|~~9!!|~~%!!|/~)#$|~#;#$|~~)!!|/~%!!|~~9!!|~~%!!|/0m#$|~#C#$|~(T!!|."},{w:16,h:16,name:"timeItOut",sheet:"",data:"!!|=%l#$|-###$|-#%!!|1~%!!|1~%!!|1~%!!|-%!% |-#C% #9!!|/~%!!|-~9!!|-~%!!~9!!|/+=#$|-#;#$|-(T!!~9!!|3~9!!|/~9!!|/%l#$|,#(#S#$#%!!|-~9!!|/~%!!|,~%!!|,~%!!|-~9!!|/~%!!|,~%!!|,~%!!|-~9!!|/~)#S#$#(#$|,#(!!|-~9!!|/~%+Q#8|~~<#8|-(i!!|/~%!!|/~%!!|3+=~4#$~4#$#3~&!!|P"},{w:16,h:16,name:"trickyShift",sheet:"",data:"!!%!#8|,#9!!|0%!#8|,#9!!%l#C#%#!$#&i!!|~#!$#&i%l#C#%~%!!~%$2!!&y#(###$#($2!!&y~%!!~%|,!!~%$2!!&y~%!!|,~%$2!!&y~%!!~%|,!!~%$2!!&z#(#$|,#($3!!&y~%!!~%|,!!~%$2%l&y!!|~$2!!&y~%!!~%#(###($2~%&z#$|~$3!!&y#(###(~%!!~%$2~%&y%l#3|,#%$2#%&y~%!!~%|,!!~%$2~%&y~%%l#%~%$2~%&y~%!!~%|,!!~%$2+=&z(T~%|,+=$3~&&y~%!!~%#(#$#($2!!&z#$#(|,#$$3#%&y#(#$#(~%!!~%$2!!&y!!~%+=#%$2~&&y~%!!~%|,!!~%$2!!&y!!+=#$(T$2!!&y~%!!~%|,!!~%$2!!&z~)#$|,#%$2!!&y~%!!~%+=#C(T)Q)R,:+=(c|,(T)Q)R,:+=#C(T!!+Q#8|,(i!!|0+Q#8|,(i!!"},{w:16,h:16,name:"Slide-A-Bulb",sheet:"",data:"!!|J%l#$|,###$|,#(#$3X#$|,###$|,#%!!~%!!|/+=#C(T!!|/~%!!~%%l#$+;#%!!|,~9!!|,%l(R#$#%~%!!~%+=#%!!6=#!/3$#/3&i3T!!%l(T~%!!3X#%+=+<+@$3!!|-&z(W(S(T%l~)!!~%#C#8|-1k!!|-/$#8|-#C~%!!~)(T%l%k%o$3!!|,%z&z#(#$#%+=3X!!~%%l(T!!0l)Q4c)R4c,:~%!!+=#%~%!!~%+=#$%j(T!!|,~9!!|,+=###$(T~%!!~%!!|/%l#C#%!!|/~%!!+=#$|,%j#$|,3X#$#(#$|,%j#$|,(T!!|["},{w:16,h:16,name:"overTheRainbow",sheet:"tilesheet",data:"!!|3%l###$#(|-!!%l#(|-!!|/~%!!|,#(|~~%!!#(#C#9!!|~~%!!|,#(|,#C#(~%!!#(|,~9!!|~+=#$|,#(!!~9!!+=%j(T#!$#/3|1&i!!~9!!|~$2!!|2/$#8(i!!|~$2!!,Z4c|~)r!!&y!!|0$2!!&y!!|~$2!!&y!!|0$2!!&y!!|~$2!!&y!!|0$2!!&y!!|~$2!!&y!!|0$2!!&y%l###$#%$2!!&y!!|0$2#3&y#(|~$2!!&z#$|,#%!!|-)Q4c,:#(!!#(!!)Q)R,:!!|,~%!!|0#(|~!!~9%l#$|,#(!!|1#(#C#(!!~9~%!!|,~%!!|2+Q#8|,(i+=###$(T"},{w:16,h:16,name:"rechargeEasy",sheet:"",data:"!!|^%l#$|/#D#(#D#$|-#%!!|-~%!!|0~%!!|~~%!!|-+=#$|,###$#C#$#(#:#$###C~&!!|~%!#8|-(i!!|,~9!!|,~9!!|~%l#S#$|,#(#$|,#%~9!!|,~9!!|~~%!!|-~%!!|,#C~:!!|,~9!!|~~%!!|-~%!!|,~%!!|-~9!!|~~%!!|-+=#$|,~)!!|-~9!!|~~%!!|0#:#8|-(i!!|~~%!!|0~%!!|2+=#$|,#3#$|-~&!!|O"},{w:16,h:16,name:"weirdWarps",sheet:"tilesheet",data:"!!|,%l###$|-#%!!|4+=#$|~#(#$|,#C#Y!!|A%l#S#$#%!!|,%l#S#$#%!!|0+=#(#$(T!!|,+=#(#$(T!!|1#C#Y!!|~#C#Y!!|?%l#S#$#%!!%l#S#$#%!!%l#S#$#%!!|,#(#$#((T!!#(#$#((T!!#(#$#((T!!|,#C#Y#C#Y!!#C#Y#C#Y!!#C#Y#C#Y!!|;%l#S#$#%%l#S#$#%%l#S#$#%%l#S#$#%#(#$#((T+=#(#$(T+=#(#$(T#(#$#((T#C#Y#C#Y!!#C#Y!!|,#C#Y!!#C#Y#C#Y!!|>#S#$|0#3!!|~"}],emptyDir:[]},patatracker:{_type:"Patatracker album",t:8,v:0,a:[],i:{1:[{n:"desc",t:{t:[3,2,1,-1,-3,-4],l:0}}],2:[{n:"harm",a:{t:[5],l:0}},{n:"mel",a:{t:[8],l:0}}],3:[{n:""}],4:[{n:""}],5:[{n:"",w:{t:[0,1,2,3,4,5,6,7,8,7,6,5,4,3,2,1,0,-1,-2,-3,-4,-5,-6,-7,-8,-7,-6,-5,-4,-3,-2,-1]},a:{t:[1,1,1,1,1,1,1,2,2,2,3,4,4,5,6,7,8,9,10,10,11,11,11,12,12,12,12,12,12,12,12,12],l:0}}],6:[{n:"",a:0,s:0,e:0,l:0,p:0,v:[1,1,1,1,0]}],7:[{n:"",l:{},p:0,c:1,o:[{m:1,a:.25,d:.00225,s:.5,r:.00225,c:[0,0,0,0],v:0},{m:1,a:.25,d:.00225,s:.5,r:.00225,c:[0,0,0,0],v:0},{m:1,a:.25,d:.00225,s:.5,r:.00225,c:[0,0,0,0],v:0},{m:1,a:.25,d:.00225,s:.5,r:.00225,c:[0,0,0,0],v:1}]}]},s:[{n:"bgm1",a:"",i:"",b:89,l:64,s:4,g:[],h:16,o:0,e:[0,0,0,0],t:[{y:1,p:[{s:"50#610(10*10(010/010*010(010'10(10'10%10#10'10#010V0000x000000010#10(10*10(010/010*010(010'10(10'10%10#10*0000000x0000000"},{s:"42000000000000000010/10>10@10>10=10;10=x10/10>10@10>10=10;10=90>oE0000x00000000000000000000000000"},{s:"x000000000000000000000000000000000000000000000000000000000000000"}],s:[-1,0,0,-1,1]},{y:1,p:[{s:"d0C6Q)10Cx10Cx10C10A10B90CQ)10Cx10Cx10C10A10B90CQ)10Cx10Cx10C10A10B90CQ)10C10H10J10H10G10E10A90CQ)10Cx10Cx10C10A10B90CQ)10Cx10Cx90CQ)10C10B90AQ)10Ax10Ax10A10H10J90AQ)10Ax10Ax10Ax10A"},{s:"50z610Lx10Lx10L10z10A10A10Mx10Mx10M10A10B10C10Cx10Cx10C10A10B10C10Cx10Cx10C10B10A10z10Lx10Lx10L10z10A10A10Mx10Mx10M10A10B10C10Cx10Cx10C10A10B10C10Cx10Cx10C10C10A"},{s:"x000000000000000000000000000000000000000000000000000000000000000"},{s:"x000000000000000000000000000000000000000000000000000000000000000"}],s:[0,0,0,1,1]},{y:2,p:[{s:"D0510'x10'x10'10%xx10'x10'x10'10%xx10'x10'x10'10%xx10'x10'10(10*10(10'x10'x10'x10'10%xx10'x10'x10'10%xx10%x10%x10%10'10(10*10,10*10(10'10%10#10%"},{s:"50(80x010(10*10,90,5_010,x10*x10(10'10%10'10#x10V0000x000000010(0x010(10*10,90,5_010/x10;x10/10;10>10=000x00000000000"},{s:"x000000000000000000000000000000000000000000000000000000000000000"}],s:[-1,-1,0,1,1]},{y:3,p:[{s:"50M6x10Rx10Mx10Rx10Mx10Rx10Mx10Rx10Mx10Rx10Mx10Rx10Mx10Rx10Mx10Rx10Mx10Rx10Mx10Rx10Mx10Rx10Mx10Rx10Mx10Rx10Mx10Rx10Mx10Rx10Mx10Rx"},{s:"x000000000000000000000000000000000000000000000000000000000000000"},{s:"x000000000000000000000000000000000000000000000000000000000000000"}],s:[0,0,0,0,0]},{y:2,p:[{s:"D0510*x10*x10*10(xx10*x10*x10*10(xx10*x10*x10*10(xx10*x10*10,10-10,10*x10*x10*x10*10(xx10*x10*x10*10(xx10(x10(x10(10*10,10-10/10-10,10*10(10'10("},{s:"50,80x010,10-10/90/6o010/x10-x10,10*10(10*10'x10#0000x000000010,0x010,10-10/90/6o010=x10>x10=10>10]10@000x00000000000"},{s:"x000000000000000000000000000000000000000000000000000000000000000"}],s:[-1,-1,0,1,1]},{y:0,p:[],s:[]},{y:0,p:[],s:[]},{y:0,p:[],s:[]}]},{n:"bgm2",a:"",i:"",b:69,l:24,s:3,g:[67,33],h:16,o:0,e:[0,0,0,0],t:[{y:2,p:[{s:"d0W5nH0000090YnH0000090WnH0000090YnH00000"},{s:"d0Y5oK0000090Yoe0000090WnH0000090YnH00000"}],s:[0,0,0,0,1]},{y:2,p:[{s:"d0R5n:0000090Tn:0000090Rn:0000090Tn:00000"},{s:"d0T5n:0000090Tn:0000090Rn:0000090Tn:00000"}],s:[0,0,0,0,1]},{y:1,p:[{s:"4610&10(90-hp00x090;g`0x10-90-Os00x00000000"},{s:"46010-10/10-10+10*090-b,x090YOs0000x0000000"},{s:"000000000000000000000000"},{s:"0010-10/10-10+10*090-b,x090YOs0000x0000000"}],s:[-1,-1,0,0,1]},{y:1,p:[{s:"000000000000000000000000"},{s:"46010*10+10*10(10'090(b,x00000000000000"}],s:[-1,-1,-1,-1,1]},{y:5,p:[{s:"70H050000010E0000010H0000010E00000"},{s:"70J050000010C0000010H0000010E00000"},{s:"000000000000000000000000"}],s:[0,0,0,0,1]},{y:5,p:[{s:"70O050000010M0000010O0000010M00000"},{s:"70P050000010J0000010O0000010M00000"}],s:[0,0,0,0,1]},{y:3,p:[{s:"d0M4gU10O10Rx10Nx90MgU10O10Rx10Nx90MrV10O10Rx10Nx90MrV10O10Rx10Nx"}],s:[0,0,0,0,0]},{y:0,p:[],s:[]}]}]},songs:{tile:"bgm1",levels:["bgm2"]},soundMap:{arrowChange:"changeArDir",arrowDirectionInvalid:"invArrDir",bulbOn:"bulbOn_A",bulbOff:"bulbOff_A",selectArrow:"selectArr",hoverArrow:"hoverArr",victory:"Victory",defeat:"Defeat",electronCollision:"electColl",electronLost:"electLost",electronCharged:"chargedUp",chargeSpent:"chargeSpent",transistor:"transistorB"}},root:"assets/",img:["palette.png","tilesheet.png"],snd:[],settings:{name:"LD47",version:"2.0.5",appid:"NcimdFsF2f2kAzBq",screen:{fullscreen:!1,resizable:!1,keepAspectRatio:!1,width:256,height:256,pixelSize:{width:4,height:4}},tileSize:{width:16,height:16},palette:{name:"db16",file:"palette",colors:["#140c1c","#deeed6","#d2aa99","#346524","#4e4a4e","#757161","#8595a1","#6daa2c","#854c30","#d04648","#d27d2c","#dad45e","#442434","#30346d","#597dce","#6dc2ca"]},controls:{up:38,down:40,left:37,right:39,up_alt:87,down_alt:83,left_alt:65,right_alt:68,esc:27,reset:82,space:32},touchEvent:{multiTouch:!1,disableContextMenu:!0,hideMousePointer:!1},gamepad:{analogToDpad:!0,deadZone:.5},loader:{colors:["#140C1C","#DEEED6"],custom:""}}},y=c.settings=o.settings,s=d("./assetLoader");function n(){i.resume(),document.body.removeEventListener("mousedown",n),document.body.removeEventListener("touchstart",n)}c.inherits=d("./inherits"),c.setFullScreen=function(){},i=null,r=window.AudioContext||window.webkitAudioContext,window.AudioContext=window.webkitAudioContext=function(){return i||(i=new r,document.body.addEventListener("mousedown",n),document.body.addEventListener("touchstart",n),i)};var a=d("audio-manager"),l=c.audioManager=new a(["sfx"]);l.settings.audioPath="audio/",l.settings.defaultFade=.3,l.init(),l.setVolume("sfx",1),c.sfx=function(t,e,i,r){l.playSound("sfx",t,e,i,r)},c.music=function(t,e,i,r){t?l.playLoopSound("sfx",t,e,0,0,i,r):l.stopLoopSound("sfx")};var p=c.btn={},h=c.btnp={},u=c.btnr={},f={},g=[],v=0;function m(){for(var t=0;t<v;t++)h[g[t]]=!1,u[g[t]]=!1}function b(t,e){var i=f[t];i&&(e&&!p[i]&&(h[i]=!0),!e&&p[i]&&(u[i]=!0),p[i]=e)}!function(){var t=y.controls||{up:38,down:40,left:37,right:39,A:32,B:88};for(var e in t)f[t[e]]=e,p[e]=!1,h[e]=!1,u[e]=!1,g.push(e);v=g.length}(),window.addEventListener("keydown",function(t){t.preventDefault(),t.repeat||b(t.keyCode,!0)}),window.addEventListener("keyup",function(t){t.preventDefault(),b(t.keyCode,!1)}),c.chr$=function(t){return String.fromCharCode(t)},c.clamp=function(t,e,i){return Math.max(e,Math.min(i,t))},c.random=function(t,e){return void 0===e?~~(t*Math.random()):~~(t+Math.random()*(e-t))};var S=d("./Texture"),x=d("./TileMap");d("./Texture/canvas2D"),d("./Texture/textCanvas2D");var R=y.tileSize.width,A=y.tileSize.height;S.setTileSize(R,A),x.setTileSize(R,A),c.texture=function(t){var e=new S(t.width,t.height);return e.clear().draw(t,0,0),e},c.tilesheet=function(t){return S.prototype.setGlobalTilesheet(t)};var D=function(){var t=y.screen,l=t.width,p=t.height,h=t.pixelSize,e=c.$screen=new S(l,p),i=e.canvas,r=i.style;if(document.body.appendChild(i),t.fullscreen)if(t.keepAspectRatio){var o=function(){var t=window.innerWidth,e=window.innerHeight,i=l*h.width,r=p*h.height,o=Math.min(t/i,e/r),s=i*o,n=r*o,a=c.$screen.canvas.style;a.width=s+"px",a.height=n+"px",a.left=(t-s)/2+"px",a.top=(e-n)/2+"px"};addEventListener("resize",o),o()}else r.width=r.height="100%";else r.width=l*h.width+"px",r.height=p*h.height+"px";return e}();c.cls=function(){return D.cls()},c.sprite=function(t,e,i,r,o,s){return D.sprite(t,e,i,r,o,s)},c.draw=function(t,e,i,r,o,s){return D.draw(t,e,i,r,o,s)},c.rect=function(t,e,i,r){return D.rect(t,e,i,r)},c.rectf=function(t,e,i,r){return D.rectf(t,e,i,r)},c.camera=function(t,e){return D.setCamera(t,e)},c.pen=function(t){return D.pen(t)},c.paper=function(t){return D.paper(t)},c.locate=function(t,e){return D.locate(t,e)},c.print=function(t,e,i){return D.print(t,e,i)},c.println=function(t){return D.println(t)},c.getMap=x.getMap,c.rectfill=c.rectf,D.canvas.addEventListener("contextmenu",function(t){return t.preventDefault(),!1});var B=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1/60)};window.frameId=0;var $=~~(y.screen.width/2),w=~~(y.screen.width/4),E=~~(y.screen.height/2);var C=["#000","#FFF"],L=y.loader&&y.loader.colors||y.loaderColors||C;Array.isArray(L)||(L=C);var T=d("./Color");D.setPalette([(new T).fromString(L[0]),(new T).fromString(L[1])]),D.paper(0).cls().paper(1).pen(1).rect($-w-2,E-4,2*w+4,8),s.preloadStaticAssets(o,function(t,f){if(D.paper(0).pen(1).cls(),t)return console.error(t),void print(t);for(var e in c.assets=f,c)window[e]=c[e];var i=c.bleeper=d("./bleeper");window.bleeper=i,f.bleeper&&i.loadProgram(f.bleeper);var r=c.patatracker=d("./pataTracker");window.patatracker=r,f.patatracker&&r.loadData(f.patatracker),function(){var t=d("./Color"),e=y.palette;if(e.file){for(var i=e.file.split("/"),r=f;r&&i.length;)r=r[i.shift()];if(!r)return;var o=r.width,s=r.height,n=r.x||0,a=r.y||0;r._isSprite&&(r=r.img);var l=d("./domUtils/createCanvas")(o,s).getContext("2d");l.drawImage(r,n,a,o,s,0,0,o,s);for(var p=l.getImageData(0,0,o,s).data,h=[],c=0;c<p.length;c+=4)p[c+3]<=1||h.push((new t).fromPixel(p,c));D.setPalette(h)}else{var u;for(u=e.colors?e.colors:e,h=[],c=0;c<u.length;c++)h.push((new t).fromString(u[c]));D.setPalette(h)}}(),f.tilesheet&&c.tilesheet(f.tilesheet),x.loadBank(f.maps);var o=d("./gamepad"),s=y.gamepad||{};s.analogToDpad&&o.mapAnalogStickToDpad(s.deadZone);var n=d("../../src/main.js");n.update&&(m(),function t(){window.frameId+=1,o.update(),n.update(),m(),B(t)}())},function(t,e,i,r){D.rect($-w-2,E-4,2*w+4,8).rectf($-w,E-2,~~(r*w*2),4)})},{".":74,"../../src/main.js":107,"./Color":64,"./Texture":66,"./Texture/canvas2D":65,"./Texture/textCanvas2D":68,"./TileMap":69,"./assetLoader":70,"./bleeper":71,"./domUtils/createCanvas":72,"./gamepad":73,"./inherits":75,"./pataTracker":76,"audio-manager":2}]},{},[111]);